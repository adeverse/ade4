<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysing changes in co-structures • ade4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysing changes in co-structures">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-24</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-new-to-ade-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">New to ade4?</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
<li><a class="dropdown-item" href="../articles/install.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/get_started.html">Getting started</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a></li>
    <li><a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a></li>
    <li><a class="dropdown-item" href="../articles/ChapKtables.html">Analysing Changes in Structures</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2Ktables.html">Analysing Changes in Co-structures</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/related.html">Related packages</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-ressources" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Ressources</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-ressources">
<li><a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/ade4shiny/">ade4shiny</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
    <li><a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a></li>
    <li><a class="dropdown-item" href="../articles/book.html">ade4 book</a></li>
    <li><a class="dropdown-item" href="../articles/papers.html">Papers</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en"><span class="fa fa-leaf"></span> LBBE</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adeverse/ade4"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Analysing changes in co-structures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adeverse/ade4/blob/master/vignettes/articles/Chap2Ktables.Rmd" class="external-link"><code>vignettes/articles/Chap2Ktables.Rmd</code></a></small>
      <div class="d-none name"><code>Chap2Ktables.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>This chapter is dedicated to the analysis of the changes in
species-environment relationships, through the analysis of a series of
pairs of tables. Each pair is made of one species table and one
environmental variables table. The rows of both tables are identical and
correspond to the samples where measures were made. The series of tables
comes from the repetition of these two tables at several occasions.
Three methods are compared in the chapter: Between-Class Coinertia
Analysis, STATICO and COSTATIS.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A series of pairs of ecological tables can be obtained when species
data and environmental data are collected several times in the same
locations. This data structure can also be seen as a couple of
<em>K</em>-tables: one <em>K</em>-table relates to species data and a
second one to environmental data. The study of changes in
species-environment relationships can be important, for example, from
the point of view of species conservation, or for global change
studies.</p>
<p>We have seen previously that one pair of ecological tables can be
analysed with many multivariate data analysis methods (also called
``Coupling methods’’, see Vignette “Description of species-environment
relationships”). We have also seen methods that allow to take into
account the existence of groups of samples in a data table
(Between-Class and Within-Class Analyses, see Vignette “Taking into
account groups of sites”). In the previous chapter, we have seen methods
that can be used to analyse a <em>K</em>-table (<em>K</em>-table
methods, see Vignette “Analysing Changes in Structures”). Here, we need
to mix these three categories of methods in order to be able to analyse
one couple of <em>K</em>-tables, or one series of pairs of ecological
tables. The next Figure sums up these three categories of methods and
presents the three strategies that can be used to mix them: BGCOIA,
STATICO, and COSTATIS. A comparison of these methods is presented in
Thioulouse 2011.</p>
<img src="Methods.png" width="600" height="600"><figcaption align="center"><p>Data structures that lead to two <em>K</em>-tables analyses.
<strong>One table</strong> methods: PCA (Principal Component Analysis),
CA (Correspondence Analysis) and MCA (Multiple Correspondence Analysis).
<strong>Two tables</strong> coupling methods: COIA (Coinertia Analysis),
CCA (Canonical Correspondence Analysis), RDA (Redundancy Analysis) and
CANCOR (Canonical Correlations Analysis). Taking into account
<strong>groups of rows</strong>: BCA (Between-Class Analysis), WCA
(Within-Class Analysis) and LDA (Linear Discriminant Analysis).
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table</strong>
methods: PTA (Partial Triadic Analysis), STATIS (Structuration des
Tableaux A Trois Indices de la Statistique), MCOA (Multiple Coinertia
Analysis) and MFA (Multiple Factor Analysis). Analysis of a series of
pairs of ecological tables: <strong>BGCOIA</strong> (Between-Group
Coinertia Analysis), <strong>STATICO</strong> (STATIS and Coinertia) and
<strong>COSTATIS</strong> (Coinertia and STATIS).</p>
</figcaption><p>A real-size example of application to the Ecology of aquatic
Heteroptera in the Medjerda watershed (Tunisia) can be found in Slimani
2017. In this Vignette, we use the <code>meau</code> data set (Pegaz
1980) that we have already seen in Vignette “Taking into account groups
of sites”.</p>
<img src="DataCubes.png" width="600" height="240"><figcaption align="center"><p>A pair of data cube, or a series of pairs of ecological tables. This
example corresponds to the <code>meau</code> data set from the
<strong>ade4</strong> package.</p>
</figcaption>
</div>
<div class="section level2">
<h2 id="bgcoia">BGCOIA<a class="anchor" aria-label="anchor" href="#bgcoia"></a>
</h2>
<p>BGCOIA (see Franquet 1995 for basic mathematical definitions) is a
Between-Group Coinertia Analysis. More precisely, it is obtained by
considering each table of the sequence as a group. The mean of the
columns in each table is computed and arranged in two new tables, with
one row corresponding to one table. There is one table for species data
means and one table for environmental variables means. A Coinertia
Analysis is then done on this couple of mean tables. In the same way as
in <em>K</em>-table analysis methods, the rows of the initial tables can
be projected into this analysis to help interpret the results.</p>
<p>The main advantage of this method is its simplicity, from both
theoretical and practical points of view. The two data cubes are reduced
to two tables by taking the means of each elementary table of the cubes,
and Coinertia Analysis is then applied to the two resulting tables.</p>
<p>In the <strong>ade4</strong> package, BGCOIA can be seen as the
Between-Class Analysis of a <code>coinertia</code> object. The result is
a <code>betcoi</code> object (<code>bgcoia2</code>).</p>
<p>The following code shows how computations can be performed in the
first theoretical framework (Coinertia Analysis of two Between-Class
Analyses):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meau</span><span class="op">)</span></span>
<span><span class="va">pca.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">env</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">pca.spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">spe</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>   </span>
<span><span class="va">bet.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bca.html">bca</a></span><span class="op">(</span><span class="va">pca.env</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">site</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">bet.spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bca.html">bca</a></span><span class="op">(</span><span class="va">pca.spe</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">site</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">bgcoia1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coinertia.html">coinertia</a></span><span class="op">(</span><span class="va">bet.env</span>, <span class="va">bet.spe</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bgcoia1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] "tab"  "cw"   "lw"   "eig"  "rank" "nf"   "l1"   "li"   "co"   "c1"  </span></span>
<span><span class="co">#&gt; [11] "lX"   "mX"   "lY"   "mY"   "aX"   "aY"   "call" "RV"</span></span></code></pre>
<p>In that case, supplementary informations are missing such as
projections of individuals and variables from initial tables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.
The following code shows how computations can be performed in the second
theoretical framework (Between-Class Analysis of a Coinertia
Analysis):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coinertia.html">coinertia</a></span><span class="op">(</span><span class="va">pca.env</span>, <span class="va">pca.spe</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">bgcoia2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bca.html">bca</a></span><span class="op">(</span><span class="va">coi</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">site</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bgcoia2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] "tab"  "cw"   "lw"   "eig"  "rank" "nf"   "l1"   "li"   "co"   "c1"  </span></span>
<span><span class="co">#&gt; [11] "lX"   "mX"   "lY"   "mY"   "aX"   "aY"   "call" "RV"   "lsY"  "lsX" </span></span>
<span><span class="co">#&gt; [21] "msX"  "msY"  "acY"  "acX"</span></span></code></pre>
<p>The next Figure shows the results of the BGCOIA on the
<code>meau</code> data set, with the factor map of Ephemeroptera
species, of environmental variables, and of sampling sites. The factor
map for sampling sites is double: there is one map for the rows of the
table of environmental variables (red labels), and one map for the rows
of the Ephemeroptera species (blue labels). Both maps are superimposed,
to make comparisons easier.</p>
<p>It is easy to see the pollution gradient (first axis, pollution on
the left) and the upstream-downstream physical gradient (second axis,
upstream is upward) on the environmental variables map and on the sites
map (red labels). This structure is very strong and can be found again
for the species on the Ephemeroptera map and on the sites map (blue
labels). See Thioulouse 2011 for further interpretations.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ar1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">bgcoia2</span><span class="op">$</span><span class="va">l1</span>, plabels.boxes.draw <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    plabels.cex <span class="op">=</span> <span class="fl">1.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ar2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">bgcoia2</span><span class="op">$</span><span class="va">c1</span>, plabels.boxes.draw <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    plabels.cex <span class="op">=</span> <span class="fl">1.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">xlim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">bgcoia2</span><span class="op">$</span><span class="va">msX</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">bgcoia2</span><span class="op">$</span><span class="va">msY</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ylim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">bgcoia2</span><span class="op">$</span><span class="va">msX</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">bgcoia2</span><span class="op">$</span><span class="va">msY</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.class.html">s.class</a></span><span class="op">(</span><span class="va">bgcoia2</span><span class="op">$</span><span class="va">msX</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">site</span>, ellipseSize <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    xlim <span class="op">=</span> <span class="va">xlim1</span>, ylim <span class="op">=</span> <span class="va">ylim1</span>, ppoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, </span>
<span>    plabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">1.5</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.class.html">s.class</a></span><span class="op">(</span><span class="va">bgcoia2</span><span class="op">$</span><span class="va">msY</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">site</span>, ellipseSize <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    xlim <span class="op">=</span> <span class="va">xlim1</span>, ylim <span class="op">=</span> <span class="va">ylim1</span>, ppoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>, plabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">1.5</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>    labels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">clt</span> <span class="op">&lt;-</span> <span class="fu">superpose</span><span class="op">(</span><span class="va">cl2</span>, <span class="va">cl1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">ADEgS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">clt</span>, <span class="va">ar1</span>, <span class="va">ar2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="Chap2Ktables_files/figure-html/unnamed-chunk-4-1.png" width="600" height="600"><figcaption align="center"><p>BGCOIA of the <code>meau</code> data set. The Ephemeroptera species
factor map (top-left) is drawn with the <code>s.arrow</code> function
and the coordinates in <code>bgcoia2$l1</code>. The environmental
variables factor map (bottom-left) is drawn with the
<code>s.arrow</code> function and the coordinates in
<code>bgcoia2$c1</code>. The sites factor map (middle graph on the
right) is drawn with the <code>s.class</code> function and the
coordinates in <code>bgcoia2$msX</code> (sites for environmental
variables, red labels) and in <code>bgcoia2$msY</code> (sites for
Ephemeroptera species, blue labels).</p>
</figcaption>
</div>
<div class="section level2">
<h2 id="statico">STATICO<a class="anchor" aria-label="anchor" href="#statico"></a>
</h2>
<p>The STATICO method was first published in 1999, as a method for the
analysis of <em>K</em> pairs of tables (Simier 1999, Thioulouse 2004).
The principle of the method is simple: the relations between the two
tables of each pair are analysed using Coinertia Analysis (see Vignette
“Description of species-environment relationships”). During this step,
the two tables are crossed, producing a cross-covariance table. In a
second step, the series of cross-covariance tables is analysed with a
Partial Triadic Analysis (see Vignette “Analysing Changes in
Structures”).</p>
<p>The particular choice of these methods (COIA and PTA) results in
constraints on the set of environmental variables, species and sites
that can be analysed by STATICO. The environmental variables must be the
same in all the environmental tables, and the list of species must be
the same in all the species tables too. Some species (but not too many)
may be absent from some species tables, as the values in the
corresponding columns can be set to zero. The sampling sites (rows of
the tables) must be the same for the two tables of one pair, but they
may be different among the series.</p>
<p>The Interstructure step of STATICO, like the Interstructure of the
STATIS method, gives optimal weights that are used to build a
Compromise. The Compromise of STATICO is a weighted mean of the
cross-covariance tables. The analysis of this Compromise gives a
graphical display of the environmental variables and of the species.
Finally, the Intrastructure step projects the rows and columns of each
table of the sequence in the analysis of the Compromise, with usual
supplementary element projection technique (Lebart 1984). This gives a
display of the environmental variables at each date, of the species at
each date, and two displays of the sampling sites at each date (one from
the point of view of environmental variables and one from the point of
view of species).</p>
<p>STATICO is a Partial Triadic Analysis on the sequence of cross
product tables, so the Compromise is also a cross product table, with
the 13 Ephemeroptera species in rows and the 10 environmental variables
in columns, in the <code>meau</code> data set. Sites have disappeared
from this table, but they can be projected as supplementary elements to
help interpret the results of the analysis. The following code shows how
computations are performed on the <code>meau</code> data set.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wit.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/withinpca.html">withinpca</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">env</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, scaling <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span></span>
<span><span class="va">pca.spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">spe</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">wit.spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wca.html">wca</a></span><span class="op">(</span><span class="va">pca.spe</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">kta.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktab.within.html">ktab.within</a></span><span class="op">(</span><span class="va">wit.env</span>, colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>,<span class="st">"S2"</span>,<span class="st">"S3"</span>,<span class="st">"S4"</span>,<span class="st">"S5"</span>,<span class="st">"S6"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">kta.spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktab.within.html">ktab.within</a></span><span class="op">(</span><span class="va">wit.spe</span>, colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>,<span class="st">"S2"</span>,<span class="st">"S3"</span>,<span class="st">"S4"</span>,<span class="st">"S5"</span>,<span class="st">"S6"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">statico.envspe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/statico.html">statico</a></span><span class="op">(</span><span class="va">kta.env</span>, <span class="va">kta.spe</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>statico.krandtest</code> function can be used to test the
statistical significance of the Coinertia Analyses on the series of
pairs of tables. This function produces a <code>krandtest</code> object
and the next Figure shows the result of the plot function on this
object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/statico.krandtest.html">statico.krandtest</a></span><span class="op">(</span><span class="va">kta.env</span>, <span class="va">kta.spe</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="Chap2Ktables_files/figure-html/unnamed-chunk-6-1.png" width="600" height="600"><figcaption align="center"><p>Graphs of the four permutation tests obtained with the
<code>statico.krandtest</code> function to test the statistical
significance of the four Coinertia Analyses.</p>
</figcaption><p>The next Figure is a compound graph that sums up the first two steps
of the STATICO method: Interstructure and Compromise. It is simply
obtained with the generic <code>plot</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">statico.envspe</span><span class="op">)</span></span></code></pre></div>
<img src="Chap2Ktables_files/figure-html/unnamed-chunk-7-1.png" width="600" height="600"><figcaption align="center"><p>Interstructure and Compromise of STATICO on the <code>meau</code>
data set.</p>
</figcaption><p>The Interstructure plot (top-left) shows that autumn and summer are
the two most important seasons for defining the Compromise, while winter
and spring are slightly less important.</p>
<p>The Compromise plots (top-right and bottom-left) are very similar to
the BGCOIA plots. They show that the first axis (horizontal) is also a
pollution gradient: clean water on the right, and pollution on the left.
The second axis (vertical) is also an upstream-downstream physical
gradient: discharge (<code>Flow</code>) and temperature
(<code>Temp</code>) increase downstream (downward on the figure).
Nitrates (<code>Nitr</code>) also increase along the whole stream
instead of having a maximum at site 2 like other pollution variables,
and this is why they are located here. The sensitivity of all
Ephemeroptera species to pollution and the specificity of some species
(<code>Bpu</code>, <code>Hla</code>, <code>Eda</code> upstream and
<code>Bsp</code>, <code>Eig</code>, <code>Ecd</code> downstream) are
also found again. The <code>Typological value</code> plot (bottom-right)
shows that autumn has the highest influence in the construction of the
Compromise, while spring has the lowest.</p>
<p>The next Figure shows the Intrastructure step for
<strong>environmental variables</strong> (top) and <strong>Ephemeroptera
species</strong> (bottom). It is drawn using the projection of the
columns of the two series of tables as supplementary elements in the
Compromise analysis (<code>statico.envspe$Tli</code> and
<code>statico.envspe$Tco</code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">statico.envspe</span><span class="op">$</span><span class="va">Tli</span>, facets <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>    labels <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, psub.cex <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>    plabels.col <span class="op">=</span> <span class="st">"red"</span>, plabels.boxes.draw <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">statico.envspe</span><span class="op">$</span><span class="va">Tco</span>, facets <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">TC</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>    labels <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">TC</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, psub.cex <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>    plabels.col <span class="op">=</span> <span class="st">"blue"</span>, plabels.boxes.draw <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pos1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sa1</span><span class="op">@</span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="va">sa2</span><span class="op">@</span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="va">pos1</span></span>
<span><span class="fu">ADEgS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sa1</span>, <span class="va">sa2</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="Chap2Ktables_files/figure-html/unnamed-chunk-8-1.png" width="800" height="400"><figcaption align="center"><p>Intrastructure of environmental variables (top) and Ephemeroptera
species (bottom) of STATICO on the <code>meau</code> data set.</p>
</figcaption><p>Autumn is clearly the season where the structures are the strongest
(arrows are much longer at this date), both for environmental variables
and for Ephemeroptera species. Conversely, spring is the season where
the structures are the weakest (arrows are all very short). This
confirms the interpretations made on the previous Figure. However,
although the structures may vary in intensity, they are preserved across
dates: the first axis is always a pollution gradient, and the second one
is always an upstream-downstream opposition.</p>
<p>The next Figure shows the Intrastructure step for the
<strong>sites</strong>. It is drawn using the projection of the rows of
the two sequences of tables as supplementary elements in the Compromise
analysis (<code>statico.envspe$supIX</code> and
<code>statico.envspe$supIY</code>). It is very similar to the graph of
sites in the BGOIA Figure, but it is split according to seasons instead
of sites. The sites of the environmental variables tables are on the
first row of graphs while the sites of Ephemeroptera species tables are
on the second row. This presentation insists on the comparison between
the four seasons, showing mainly the distortions of the
upstream-downstream gradient across seasons, as Ephemeroptera species
react to pollution increase (maximum reached in autumn) or decrease
(minimum in spring).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.traject.html">s.traject</a></span><span class="op">(</span><span class="va">statico.envspe</span><span class="op">$</span><span class="va">supIX</span>, facets <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">supTI</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>    plabels.cex <span class="op">=</span> <span class="fl">0</span>, psub.cex <span class="op">=</span> <span class="fl">0</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sla1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">statico.envspe</span><span class="op">$</span><span class="va">supIX</span>, facets <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">supTI</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>    psub.cex <span class="op">=</span> <span class="fl">1.5</span>, labels <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">supTI</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, </span>
<span>    plabels.col <span class="op">=</span> <span class="st">"red"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">st2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.traject.html">s.traject</a></span><span class="op">(</span><span class="va">statico.envspe</span><span class="op">$</span><span class="va">supIY</span>, facets <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">supTI</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>    plabels.cex <span class="op">=</span> <span class="fl">0</span>, psub.cex <span class="op">=</span> <span class="fl">0</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sla2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">statico.envspe</span><span class="op">$</span><span class="va">supIY</span>, facets <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">supTI</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>    psub.cex <span class="op">=</span> <span class="fl">1.5</span>, labels <span class="op">=</span> <span class="va">statico.envspe</span><span class="op">$</span><span class="va">supTI</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, </span>
<span>    plabels.col <span class="op">=</span> <span class="st">"blue"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pos1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">st1</span><span class="op">@</span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="va">st2</span><span class="op">@</span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="va">pos1</span></span>
<span><span class="va">sla1</span><span class="op">@</span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="va">sla2</span><span class="op">@</span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="va">pos1</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu">superpose</span><span class="op">(</span><span class="va">st1</span>, <span class="va">sla1</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu">superpose</span><span class="op">(</span><span class="va">st2</span>, <span class="va">sla2</span><span class="op">)</span></span>
<span><span class="fu">ADEgS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="Chap2Ktables_files/figure-html/unnamed-chunk-9-1.png" width="800" height="400"><figcaption align="center"><p>Intrastructure of <strong>sites</strong> for environmental variables
(top) and for Ephemeroptera species (bottom) of STATICO on the
<code>meau</code> data set.</p>
</figcaption><p>This Figure shows the differences between sites among the seasons for
environmental variables (top row). In spring, sites are lined up
vertically on the upstream-downstream gradient and only site 2 moves
slightly to the left. Structures are clearly weaker during this season
and the permutation test (see the <code>statico.krandtest</code> Figure)
is not statistically significant.</p>
<p>In summer, pollution is highest at site 2, and restoration occurs
along sites 3, 4 and 5. In autumn, pollution is maximum because stream
flow is at its minimum (pollutants concentrations are maximum). In
winter, pollution has almost disappeared, because Autrans is a summer
mountain resort, but the upstream-downstream gradient is still
disturbed.</p>
<p>The position sites for Ephemeroptera species (bottom row) shows the
same structures, because the pollution has a negative impact on species
abundance (horizontal axis) and because of the upstream-downstream
preferences of particular species (vertical axis).</p>
</div>
<div class="section level2">
<h2 id="costatis">COSTATIS<a class="anchor" aria-label="anchor" href="#costatis"></a>
</h2>
<p>COSTATIS is also based on <em>K</em>-table methods and on Coinertia.
It benefits from the advantages of both STATICO and BGCOIA. Indeed, it
has the same optimality properties of <em>K</em>-table analyses as
STATICO (<em>i.e.</em>, the maximising properties of the Compromise),
but it retains the simplicity of BGCOIA.</p>
<p>COSTATIS is simply a Coinertia Analysis of the Compromises of the two
<em>K</em>-table analyses. The first step of COSTATIS consists in
performing two Partial Triadic Analyses: one on the environmental
variables <em>K</em>-table, and one on the species <em>K</em>-table. The
second step is simply a Coinertia Analysis of the Compromises of these
two Partial Triadic Analyses. This means that the number of tables does
not have to be the same for the two series of tables, but that the
number of species, of environmental variables, and of sampling sites
must be the same for all the tables.</p>
<p>The Coinertia Analysis of the two Compromises decomposes the total
coinertia and maximises the coinertia between species and environmental
variable scores. An additional step can be implemented: like in the
STATICO method, it is possible to project the rows and columns of all
the tables of the two series as supplementary elements into the
multidimensional space of this Coinertia Analysis.</p>
<p>Each Compromise represents the “stable structure” of the
corresponding series. COSTATIS brings to light the relationships between
these two stable structures, and it discards the conflicting variations
between the whole sequences. It is therefore very easy to interpret
(like a standard Coinertia Analysis), yet it retains the optimality
properties of the Compromises of the two Partial Triadic Analyses.</p>
<p>In the <strong>ade4</strong> package, the <code>costatis</code>
function is used to compute a COSTATIS Analysis. All the outputs are
grouped in a <code>dudi</code> object (subclass
<code>coinertia</code>).</p>
<p>The call to the <code>costatis</code> function just passes the two
<em>K</em>-tables, using the same syntax as the <code>statico</code>
function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">costatis.envspe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/costatis.html">costatis</a></span><span class="op">(</span><span class="va">kta.env</span>, <span class="va">kta.spe</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>COSTATIS results are presented in the next Figure. COSTATIS is a
Coinertia Analysis, and it is therefore possible to use a permutation
test to assess the statistical significance of the relationships between
the two tables, just like in a usual Coinertia Analysis. The result of
this permutation test (function <code>costatis.randtest</code>) gave a
<em>p</em>-value of 0.005.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">costatis.envspe</span><span class="op">$</span><span class="va">c1</span> <span class="op">*</span> <span class="fl">4</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.class.html">s.class</a></span><span class="op">(</span><span class="va">costatis.envspe</span><span class="op">$</span><span class="va">supIX</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">site</span>, ellipseSize <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, plabels.col <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu">superpose</span><span class="op">(</span><span class="va">sa1</span>, <span class="va">sc1</span><span class="op">)</span></span>
<span><span class="va">sa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">costatis.envspe</span><span class="op">$</span><span class="va">l1</span> <span class="op">*</span> <span class="fl">3</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">1.5</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.class.html">s.class</a></span><span class="op">(</span><span class="va">costatis.envspe</span><span class="op">$</span><span class="va">supIY</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">site</span>, ellipseSize <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">1.5</span><span class="op">)</span>, plabels.col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu">superpose</span><span class="op">(</span><span class="va">sa2</span>, <span class="va">sc2</span><span class="op">)</span></span>
<span><span class="fu">ADEgS</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="Chap2Ktables_files/figure-html/unnamed-chunk-11-1.png" width="800" height="400"><figcaption align="center"><p>Results of the COSTATIS analysis on the <code>meau</code> data
set.</p>
</figcaption><p>The Coinertia Analysis is done on the Compromises of two
<em>K</em>-table analyses. Here, we used two Partial Triadic Analyses,
but the results of these two analyses are not presented. We show only
the plots of the Coinertia Analysis, under the form of two biplots: one
for environmental variables (left), and one for Ephemeroptera species
(right). These two biplots are at the same scale and in the same space,
so they could be superimposed on the same figure. Presenting the results
in this way underlines the fact that COSTATIS is looking for the
relationships (co-structure) between the stable structures extracted
from two series of tables.</p>
<p>The left graph shows the results for the environmental variables. The
same structure as the one detected by STATICO and BGCOIA is observed.
The first axis is the pollution gradient (pollution on the left) and the
second is the upstream-downstream opposition (downstream is upward). The
four dates for each site are projected on this plot and, like in the
BGCOIA plot, the four points corresponding to the four sampling dates of
each site are grouped to form a star. The gravity center of these four
points is labeled with the number of the site. The four points of site 2
are on the left, as pollution is higher in this site for the four dates
(except for site 3 in winter). Pollution decreases downstream along
sites 3, 4 and 5, and is the lowest at site 6.</p>
<p>The second biplot is presented at the right. It shows the
Ephemeroptera species, with the same opposition between upstream and
downstream characteristic species. In the same way as in the figure of
environmental variables, the four dates for each site are projected on
the plot and the corresponding four points are grouped to form a star.
The gravity center of these four points is labeled with the number of
the site. The position of sites corresponds to the abundance of the
species in these sites: sites 2 and 3 have the lowest number of
Ephemeroptera, so they are far on the left. Site 1 has the highest
number of species <code>Eda</code>, and sites 5 and 6 have the highest
number of species <code>Bsp</code>, <code>Brh</code> and
<code>Eig</code>.</p>
<p>The first axis common to these two biplots (<em>i.e.</em>, the first
COSTATIS axis) maximises the covariance between the coordinates of the
<code>Compromise variables'' and the</code>Compromise species’’. The
result is that it displays the relationships between the stable
structures extracted from the two data sets. On this example, this
relationship is the fact that the pollution gradient affects the
abundance of Ephemeroptera species. The second axis represents the
upstream-downstream opposition, and the relationships between ecological
preferences of Ephemeroptera species and physical variables or stream
morphology.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this Vignette, we presented the principles and some examples of
use of three methods for analysing a series of pairs of data tables (or
a pair of data cubes): BGCOIA, STATICO and COSTATIS. The next Figure
shows a comparison of the three approaches.</p>
<p>BGCOIA is a Between-Group Coinertia Analysis. It is therefore simply
computed by doing a Coinertia Analysis on the two tables of group means,
considering each table as a group (Franquet 1995).</p>
<p>In STATICO, we first use Coinertia Analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
times to compute the sequence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
cross-covariance tables, and then Partial Triadic Analysis to analyse
this new <em>K</em>-table. Symmetrically in COSTATIS, we first use two
Partial Triadic Analyses to compute the Compromises of the two
<em>K</em>-tables, and then Coinertia Analysis to analyse the
relationships between these two Compromises.</p>
<img src="3Meth.png" width="600" height="600"><figcaption align="center"><p>Comparison of the three methods. BGCOIA is a Between-Group Coinertia
Analysis, considering each table of the series as a group. STATICO is a
Partial Triadic Analysis on the series of cross-product tables obtained
by crossing the two tables of a pair at each date. COSTATIS is a
Coinertia Analysis of the Compromises computed by the Partial Triadic
Analysis of the two <em>K</em>-tables. In BGCOIA, the mean of the
variables in each table is computed and arranged in two new tables. A
Coinertia Analysis is then done on this couple of new tables. In
STATICO,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
cross-covariance tables are computed from the two <em>K</em>-tables,
resulting in a new <em>K</em>-table. A Partial Triadic Analysis is then
done on this new <em>K</em>-table. In COSTATIS, two Partial Triadic
Analyses are used to compute the Compromises of the two
<em>K</em>-tables. A Coinertia Analysis is then used to analyse the
relationships between these two Compromises.</p>
</figcaption><p>The three methods presented here uncover the same features in the
example data set. This is a small data set, but with strong structure,
and strong structures often are clear with any method. However, the
three methods used to analyse even a data set with clear structure can
have advantages and drawbacks. The advantages of these methods can be
summarised as follows:</p>
<ul>
<li><p>BGCOIA: It is the most straightforward method. It is simple to
apply and outputs are easy to interpret. It can be used to favor one
point of view (for example, space <em>vs.</em> time), by choosing the
factor of Between-Class Analysis. It can also be used in conjunction
with WGCOIA (Within-Group Coinertia Analysis, Franquet 1994) to study an
effect (time) after removing the other (space).</p></li>
<li><p>STATICO: The main advantage of this method is the optimality of
the Compromise (maximisation of the similarity with all the initial
tables). It gives a Compromise of co-structures, which means that it
displays the stable component of species-environment relationship
variations. It benefits from the three-steps computation scheme of
STATIS-like methods (Interstructure, Compromise, Intrastructure), and
graphical outputs can be very detailed.</p></li>
<li><p>COSTATIS: This method benefits from the advantages of the two
others: optimality of the Partial Triadic Analysis Compromises, ease of
use, simplicity of Coinertia Analysis graphical outputs. COSTATIS is the
Coinertia Analysis of two Compromises, so it looks for the relationships
between two stable structures. This is different from the STATICO point
of view (co-structure of two Compromises <em>vs.</em> Compromise of a
series of co-structures).</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
