<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ade4">
<title>Description of species-environment relationships â€¢ ade4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Description of species-environment relationships">
<meta property="og:description" content="ade4">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-22</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-new-to-ade-">New to ade4?</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
    <a class="dropdown-item" href="../articles/install.html">Installation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Getting started</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a>
    <a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a>
    <a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a>
    <a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a>
    <a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a>
    <a class="dropdown-item" href="../articles/ChapKtables.html">Analysing Changes in Structures</a>
    <a class="dropdown-item" href="../articles/Chap2Ktables.html">Analysing Changes in Co-structures</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/related.html">Related packages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-ressources">Ressources</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-ressources">
    <a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/ade4shiny/">ade4shiny</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a>
    <a class="dropdown-item" href="../articles/book.html">ade4 book</a>
    <a class="dropdown-item" href="../articles/papers.html">Papers</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en">
    <span class="fa fa-leaf"></span>
     
    LBBE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adeverse/ade4">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Description of species-environment relationships</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adeverse/ade4/blob/HEAD/vignettes/articles/Chap2tables.Rmd" class="external-link"><code>vignettes/articles/Chap2tables.Rmd</code></a></small>
      <div class="d-none name"><code>Chap2tables.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>This vignette shows how direct and indirect gradient analysis can be
handled in the <strong>ade4</strong> package, with a special emphasis on
three direct ordination methods: Coinertia Analysis, Redundancy Analysis
and Canonical Correspondence Analysis.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Simple methods presented in vignettes 2 (Description of environmental
variables structures) and 3 (Description of species structures) describe
environmental or species structures independently. However, an important
question in Ecology is the analysis of the relationships between these
two structures with the aim of understanding if/how the organisation of
ecological communities is linked to environmental variations. In this
chapter, we focus on the case where a number of sites are described by
environmental variables <em>and</em> species composition. This leads to
consider two tables with the same rows (<em>i.e.</em>, the sites).
Historically, ecologists have first used indirect approaches for
interpreting the structures of species assemblages (structural
information extracted by the analysis of the species data) in relation
to environmental variability. Site scores along the ordination axes,
which are composite indices of species abundances were compared <em>a
posteriori</em> to environmental variables (<em>indirect
ordination</em>, <em>indirect gradient analysis</em>). Progressively,
new techniques were developed to constrain the ordination according to
the table of explanatory environmental variables (<em>direct
ordination</em>, <em>direct gradient analysis</em>).</p>
</div>
<div class="section level2">
<h2 id="indirect-ordination">Indirect ordination<a class="anchor" aria-label="anchor" href="#indirect-ordination"></a>
</h2>
<p>The <code>doubs</code> data set has been described in vignettes 2 and
3. In indirect ordination methods, community data are first summarised
and then interpreted in the light of environmental information. For
instance, we apply a centred PCA on the species data while the
environmental table is treated by a standardised PCA. Two axes are kept
for each analysis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adeverse.github.io/ade4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">adegraphics</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">)</span></span>
<span><span class="va">pca.fish</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">pca.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">env</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>To interpret the outputs of the species ordination, correlations
between the axes kept in the two analyses can be computed:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">pca.env</span><span class="op">$</span><span class="va">li</span>, <span class="va">pca.fish</span><span class="op">$</span><span class="va">li</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            Axis1     Axis2</span></span>
<span><span class="co">#&gt; Axis1  0.5682058 0.3483176</span></span>
<span><span class="co">#&gt; Axis2 -0.4679404 0.6308694</span></span></code></pre>
<p>The two ordinations are strongly linked. The first two axes of the
fish ordination (columns) are linked to the two main environmental
gradients (first two axes of PCA of the environmental table). To
facilitate the interpretation, correlations can be computed between
original environmental variables and species ordination scores:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">env</span>, <span class="va">pca.fish</span><span class="op">$</span><span class="va">li</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;           Axis1        Axis2</span></span>
<span><span class="co">#&gt; dfs  0.81690724  0.113670362</span></span>
<span><span class="co">#&gt; alt -0.67742048  0.001438816</span></span>
<span><span class="co">#&gt; slo -0.57154952  0.093089123</span></span>
<span><span class="co">#&gt; flo  0.78476404 -0.013730306</span></span>
<span><span class="co">#&gt; pH  -0.04933278 -0.252401703</span></span>
<span><span class="co">#&gt; har  0.44764032  0.038390495</span></span>
<span><span class="co">#&gt; pho  0.11485956  0.537131173</span></span>
<span><span class="co">#&gt; nit  0.46860409  0.309248079</span></span>
<span><span class="co">#&gt; amm  0.08400315  0.557866204</span></span>
<span><span class="co">#&gt; oxy -0.40335527 -0.655908104</span></span>
<span><span class="co">#&gt; bdo  0.08547836  0.702449371</span></span></code></pre>
<p>The first axis is mainly correlated to geomorphological variables
(distance from the source, flow, altitude, slope) whereas the second
axis is more linked to chemical processes (biological demand for oxygen,
dissolved oxygen, ammonium and phosphate). Note that the computation of
these correlations is exactly equivalent to the projection, as
supplementary elements, of the standardised environmental variables on
the factorial map of the fish ordination. This projection step can be
performed by the <code>supcol</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">supcol.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/supcol.html">supcol</a></span><span class="op">(</span><span class="va">pca.fish</span>, <span class="va">pca.env</span><span class="op">$</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">supcol.env</span><span class="op">$</span><span class="va">cosup</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;           Comp1        Comp2</span></span>
<span><span class="co">#&gt; dfs  0.81690724  0.113670362</span></span>
<span><span class="co">#&gt; alt -0.67742048  0.001438816</span></span>
<span><span class="co">#&gt; slo -0.57154952  0.093089123</span></span>
<span><span class="co">#&gt; flo  0.78476404 -0.013730306</span></span>
<span><span class="co">#&gt; pH  -0.04933278 -0.252401703</span></span>
<span><span class="co">#&gt; har  0.44764032  0.038390495</span></span></code></pre>
<p>These correlations can also be depicted on a correlation circle.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">supcol.env</span><span class="op">$</span><span class="va">cosup</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chap2tables_files/figure-html/unnamed-chunk-6-1.png" width="600" height="600"></p>
<p>Correlations between environmental variables and sites scores on the
first two axes of the PCA of fish species data.</p>
<p>Symmetrically, <strong>ade4</strong> also offers the possibility to
represent supplementary sites (which have not been involved in the
computation of an analysis) using the <code>suprow</code> function. This
can be useful for prediction purposes, allowing to compute an analysis
on a number of reference sites and then using this model to evaluate the
position for new sites.</p>
<p>It is usually assumed that environmental variables influence the
distribution of species. In this context, it would be more appropriate
to use a regression model to explain the fish species composition by
environmental explanatory variables (e.g.,
<code>lm(pca.fish$li[, 1] ~ as.matrix(doubs$env))</code>). A variable
selection procedure can be used to avoid overfitting and
multicollinearity issues due to the high number (relative to the number
of statistical units, i.e., sites) of correlated explanatory
variables.</p>
<p>The main advantage of indirect ordination is its simplicity. Its main
drawback is its lack of optimality: species ordination reveals the main
patterns of community assemblage but does not guarantee that these
structures are linked to environmental gradients. If a study focuses on
species-environment relationships, two-table methods, that consider both
environmental and species tables simultaneously, should be
preferred.</p>
</div>
<div class="section level2">
<h2 id="coinertia-analysis">Coinertia Analysis<a class="anchor" aria-label="anchor" href="#coinertia-analysis"></a>
</h2>
<p>As shown above, simple multivariate analyses are useful to identify
the main environmental and species structures separately. Coinertia
Analysis (Doledec 1994, Dray 2003c) aims to reveal the main
co-structures (<em>i.e.</em>, the structures common to both data sets)
by combining these separate ordinations into a single analysis. This
two-table method is based on the computation of a crossed array
(cross-covariance matrix) that measures the relationships between the
variables of both data sets.</p>
<p>In the <strong>ade4</strong> package, the <code>coinertia</code>
function is used to compute a Coinertia Analysis. All the outputs of
this function are grouped in a <code>dudi</code> object (subclass
<code>coinertia</code>).</p>
<p>The first two arguments of the <code>coinertia</code> function are
the two <code>dudi</code> objects corresponding to the analyses of the
two data tables. The two other arguments, <code>scannf</code> and
<code>nf</code>, have the same meaning as in the other analysis
functions.</p>
<p>Species and environmental tables should be analysed separately and
then the <code>coinertia</code> function can be applied to compute the
Coinertia Analysis:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">coia.doubs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coinertia.html">coinertia</a></span><span class="op">(</span><span class="va">pca.fish</span>, <span class="va">pca.env</span>, scannf<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Coinertia analysis</span></span>
<span><span class="co">#&gt; call: coinertia(dudiX = pca.fish, dudiY = pca.env, scannf = FALSE)</span></span>
<span><span class="co">#&gt; class: coinertia dudi </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rank (rank)     : 11</span></span>
<span><span class="co">#&gt; $nf (axis saved) : 2</span></span>
<span><span class="co">#&gt; $RV (RV coeff)   : 0.4505569</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; eigenvalues: 119 13.87 0.7566 0.5278 0.2709 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   vector length mode    content                        </span></span>
<span><span class="co">#&gt; 1 $eig   11     numeric Eigenvalues                    </span></span>
<span><span class="co">#&gt; 2 $lw    11     numeric Row weigths (for pca.env cols) </span></span>
<span><span class="co">#&gt; 3 $cw    27     numeric Col weigths (for pca.fish cols)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    data.frame nrow ncol content                                           </span></span>
<span><span class="co">#&gt; 1  $tab       11   27   Crossed Table (CT): cols(pca.env) x cols(pca.fish)</span></span>
<span><span class="co">#&gt; 2  $li        11   2    CT row scores (cols of pca.env)                   </span></span>
<span><span class="co">#&gt; 3  $l1        11   2    Principal components (loadings for pca.env cols)  </span></span>
<span><span class="co">#&gt; 4  $co        27   2    CT col scores (cols of pca.fish)                  </span></span>
<span><span class="co">#&gt; 5  $c1        27   2    Principal axes (loadings for pca.fish cols)       </span></span>
<span><span class="co">#&gt; 6  $lX        30   2    Row scores (rows of pca.fish)                     </span></span>
<span><span class="co">#&gt; 7  $mX        30   2    Normed row scores (rows of pca.fish)              </span></span>
<span><span class="co">#&gt; 8  $lY        30   2    Row scores (rows of pca.env)                      </span></span>
<span><span class="co">#&gt; 9  $mY        30   2    Normed row scores (rows of pca.env)               </span></span>
<span><span class="co">#&gt; 10 $aX        2    2    Corr pca.fish axes / coinertia axes               </span></span>
<span><span class="co">#&gt; 11 $aY        2    2    Corr pca.env axes / coinertia axes                </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CT rows = cols of pca.env (11) / CT cols = cols of pca.fish (27)</span></span></code></pre>
<p>The <code>plot</code> function can be used to display the main
outputs of the analysis. The barplot of eigenvalues (bottom-left)
clearly indicates that two dimensions should be used to interpret the
main structures of fish-environment relationships.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coia.doubs</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chap2tables_files/figure-html/unnamed-chunk-8-1.png" width="600" height="600"></p>
<p>Plot of the outputs of a Coinertia Analysis. This is a composite plot
made of six graphs (see text for an explanation of the six graphs).</p>
<p>Coinertia Analysis computes coefficients for environmental variables
(<code>$l1</code>) and fish species (<code>$c1</code>) which are
represented on the two graphs at the bottom of the plot
(<strong>Y</strong> and <strong>X</strong> loadings). Hence, it is
possible to interpret the different axes and identify relationships
between variables of both data sets. The three groups (trout, grayling
and downstream) are identified and their position is linked to the
geomorphological variables on the first axis and to chemical variables
on the second axis. For instance, the three species of the trout group
(<code>Satr</code>, <code>Phph</code> and <code>Neba</code>) are present
in upstream sites (high altitude and slope, low flow, etc.) where the
oxygen concentration is high and the ammonium and phosphate
concentrations are low. These loadings are used to compute two sets of
site scores allowing to position sites by their species composition
(<code>$lX</code>) or by their environmental conditions
(<code>$lY</code>). Coinertia Analysis maximises the squared covariances
between these two sets of scores.</p>
<p>The top-right graph of the plot represents sites by normed versions
of these scores (<code>$mX</code> and <code>$mY</code>). Each site
corresponds to an arrow (the start corresponds to its species score and
the head to its environmental score). A short arrow reveals a good
agreement between the environmental conditions of a site and its species
composition while a long arrow indicates a discrepancy. For instance,
the long arrows for sites <code>1</code>, <code>8</code>,
<code>23</code>, <code>24</code> and <code>25</code> reveal that these
sites have few species and similar composition (the start of the arrows
are close and located at the opposed direction of the species arrows)
but very different environmental conditions (the head of these arrows
are spread out). Hence, these sites can be seen as outliers in the
global model of species-environment relationships identified by
Coinertia Analysis because their species composition did not correspond
to their environmental conditions. Indeed, species abundance and
richness in these sites are very low due to pollution or to the fact
that fish richness is also very low near the source of the stream.</p>
<p>Lastly, the two graphs on the left show the projection of the first
axes of the two initial simple analyses (<code>pca.fish</code> and
<code>pca.env</code>) onto the coinertia axes. These graphs provide a
convenient way to look at the relationships between the main structures
of each data set (identified by simple analyses) and the co-structures
identified by Coinertia Analysis. For fish species data, the first two
axes of the simple PCA are nearly equivalent to the coinertia axes. For
environmental data, a rotation has been performed so that a coinertia
axis mixes the structures of two PCA axes.</p>
<p>The <code>summary</code> function provides several useful results
about the analysis, especially concerning the criteria maximised:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">coia.doubs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Coinertia analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Class: coinertia dudi</span></span>
<span><span class="co">#&gt; Call: coinertia(dudiX = pca.fish, dudiY = pca.env, scannf = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total inertia: 134.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenvalues:</span></span>
<span><span class="co">#&gt;      Ax1      Ax2      Ax3      Ax4      Ax5 </span></span>
<span><span class="co">#&gt; 119.0194  13.8714   0.7566   0.5278   0.2709 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Projected inertia (%):</span></span>
<span><span class="co">#&gt;     Ax1     Ax2     Ax3     Ax4     Ax5 </span></span>
<span><span class="co">#&gt; 88.3570 10.2978  0.5617  0.3918  0.2011 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cumulative projected inertia (%):</span></span>
<span><span class="co">#&gt;     Ax1   Ax1:2   Ax1:3   Ax1:4   Ax1:5 </span></span>
<span><span class="co">#&gt;   88.36   98.65   99.22   99.61   99.81 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Only 5 dimensions (out of 11) are shown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenvalues decomposition:</span></span>
<span><span class="co">#&gt;         eig     covar      sdX      sdY      corr</span></span>
<span><span class="co">#&gt; 1 119.01942 10.909602 6.422570 2.326324 0.7301798</span></span>
<span><span class="co">#&gt; 2  13.87137  3.724429 2.863743 1.685078 0.7718017</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Inertia &amp; coinertia X (pca.fish):</span></span>
<span><span class="co">#&gt;     inertia      max     ratio</span></span>
<span><span class="co">#&gt; 1  41.24940 42.74627 0.9649824</span></span>
<span><span class="co">#&gt; 12 49.45042 50.90461 0.9714331</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Inertia &amp; coinertia Y (pca.env):</span></span>
<span><span class="co">#&gt;     inertia      max     ratio</span></span>
<span><span class="co">#&gt; 1  5.411785 6.321624 0.8560752</span></span>
<span><span class="co">#&gt; 12 8.251272 8.553220 0.9646978</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RV:</span></span>
<span><span class="co">#&gt;  0.4505569</span></span></code></pre>
<p>As for any object inheriting from the <code>dudi</code> class, the
eigenvalues and percentages of (cumulative) projected inertia are
returned. Information on the eigenvalues and their decomposition is also
returned. Eigenvalues in Coinertia Analysis are squared covariances
between linear combinations of species abundances (<code>$lX</code>) and
environmental variables (<code>$lY</code>). The table
<code>Eigenvalues decomposition</code> returns the eigenvalues
(<code>eig</code>) and their square root (<code>covar</code>). The
covariance is equal to the product of the correlation between
<code>$lX</code> and <code>$lY</code> (<code>corr</code>), the standard
deviation of the environmental score <code>$lY</code> (<code>sdY</code>)
and the standard deviation of the species score <code>$lX</code>
(<code>sdX</code>). The maximal possible values for the standard
deviations are produced by the simple analyses of the initial tables
(<code>pca.fish</code>, <code>pca.env</code>) that identify the main
structures of each data set. The two tables
<code>Inertia &amp; coinertia</code> compare the quantity of variance
captured by the Coinertia Analysis (<code>inertia</code>) to the maximum
possible value provided by the simple analysis (<code>max</code>). Hence
it is possible to ensure that an important proportion of the information
contained in each table (structures) is preserved when looking for
co-structures (<code>ratio</code>).</p>
<p>Lastly, the <code>summary</code> function returns the value of the RV
coefficient (Escoufier 1973) that measures the link between two tables.
It can been seen as an extension of the bivariate squared correlation
coefficient to the multivariate case. It varies between 0 (no
correlation) and 1 (perfect agreement) and its significance can be
tested by random permutation of the rows of both tables (function
<code>randtest</code>):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/randtest.html">randtest</a></span><span class="op">(</span><span class="va">coia.doubs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Monte-Carlo test</span></span>
<span><span class="co">#&gt; Call: randtest.coinertia(xtest = coia.doubs)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Observation: 0.4505569 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Based on 999 replicates</span></span>
<span><span class="co">#&gt; Simulated p-value: 0.001 </span></span>
<span><span class="co">#&gt; Alternative hypothesis: greater </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Std.Obs Expectation    Variance </span></span>
<span><span class="co">#&gt;  9.37509873  0.08231595  0.00154281</span></span></code></pre>
<p>In this case, the link between the composition of species assemblages
and environmental conditions is highly significant.</p>
<p>Coinertia Analysis maximises covariances and thus can handle tables
containing more variables than individuals. Its framework is very
general and flexible: the <code>coinertia</code> function takes two
<code>dudi</code> objects as arguments and thus can be used to link
tables containing quantitative variables (<code>dudi.pca</code>),
qualitative variables (<code>dudi.acm</code>), mix of both
(<code>dudi.hillsmith</code>), fuzzy variables (<code>dudi.fca</code>),
distance matrices (<code>dudi.pco</code>), etc. The only restriction is
that rows (i.e., individuals) of the two tables are identical and that
the same row weights are used in the two separate analyses. This implies
to take some precautions, especially when Correspondence Analysis (CA)
is used because this method is based on the computation of particular
row weights. In this case, CA row weights should be introduced in the
analysis of the second table:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coa.fish</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.coa.html">dudi.coa</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">pca.env2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">env</span>, row.w <span class="op">=</span> <span class="va">coa.fish</span><span class="op">$</span><span class="va">lw</span>,</span>
<span>    scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">coia.doubs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coinertia.html">coinertia</a></span><span class="op">(</span><span class="va">coa.fish</span>, <span class="va">pca.env2</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>As CA row weights have been computed using species abundance
contained in the <code>doubs$fish</code> table, the permutation
procedure should keep the association between the row weights and the
rows of the first table. This is achieved using the <code>fixed</code>
argument of the <code>randtest</code> function, thus permuting only the
rows of the second table:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/randtest.html">randtest</a></span><span class="op">(</span><span class="va">coia.doubs2</span>, fixed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Warning: non uniform weight. The results from permutations</span></span>
<span><span class="co">#&gt; are valid only if the row weights come from the fixed table.</span></span>
<span><span class="co">#&gt; The fixed table is table X : doubs$fish</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Monte-Carlo test</span></span>
<span><span class="co">#&gt; Call: randtest.coinertia(xtest = coia.doubs2, fixed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Observation: 0.636319 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Based on 999 replicates</span></span>
<span><span class="co">#&gt; Simulated p-value: 0.001 </span></span>
<span><span class="co">#&gt; Alternative hypothesis: greater </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Std.Obs  Expectation     Variance </span></span>
<span><span class="co">#&gt; 10.847914942  0.108294352  0.002369277</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="analysis-on-instrumental-variables">Analysis on instrumental variables<a class="anchor" aria-label="anchor" href="#analysis-on-instrumental-variables"></a>
</h2>
<p>In species-environment studies, it is often assumed that
environmental conditions influence species distributions. Coinertia
Analysis is based on a covariance criteria and thus does not take into
account this asymmetric relationship. Methods based on instrumental
variables (also known as constrained/canonical ordination) consider
explicitly that a table contains response variables that must be
explained by a second table of explanatory (instrumental) variables.
They allow to identify the main structures of the first table that are
explained by the variables in the second table. In
<strong>ade4</strong>, this way to go is provided by the
<code>pcaiv</code> function. Redundancy Analysis (Rao 1964,
Wollenberg1977) and Canonical Correspondence Analysis (terBraak 1986)
are two particular cases of such approach.</p>
<p>The <code>pcaivortho</code> function performs an analysis on
orthogonal instrumental variables that focuses on the structures of the
response variables that are <strong>not</strong> explained by the
instrumental variables (Rao 1964). They are equivalent to pRDA and pCCA,
<em>i.e.</em>, partial CCA and RDA.</p>
<div class="section level3">
<h3 id="redundancy-analysis">Redundancy Analysis<a class="anchor" aria-label="anchor" href="#redundancy-analysis"></a>
</h3>
<p>Redundancy Analysis (RDA) is a particular analysis on instrumental
variables corresponding to the case where the table of response
variables (i.e., species abundances) is treated by a PCA.</p>
<p>In practice, RDA is the PCA of a table containing the predicted
values of species abundances by environmental variables.</p>
<p>In <strong>ade4</strong>, the <code>pcaiv</code> function is used to
compute a RDA. All the outputs of this function are grouped in a
<code>dudi</code> object (subclass <code>pcaiv</code>).</p>
<p>The <code>pcaiv</code> function takes two main arguments: an analysis
of the response table (a <code>dudi</code> object) and a table of
explanatory variable (an object of class <code>data.frame</code>). In
<strong>ade4</strong>, the user must first use the <code>dudi.pca</code>
function to identify the main variations in species composition and then
use the <code>pcaiv</code> function to introduce environmental
variables. This two-step implementation has a pedagogical aim by forcing
users to interpret simple (unconstrained) structures before analysing
structures explained by external variables. The outputs of the
constrained and unconstrained analyses can then be compared to evaluate
the role of explanatory variables.</p>
<p>RDA is performed by applying the <code>pcaiv</code> function with the
<code>pca.fish</code> object as first argument:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rda.doubs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcaiv.html">pcaiv</a></span><span class="op">(</span><span class="va">pca.fish</span>, <span class="va">doubs</span><span class="op">$</span><span class="va">env</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>rda.doubs</code> inherits from the class
<code>dudi</code>. In <code>rda.doubs$tab</code>, the original fish
table (<code>pca.fish$tab</code>) has been replaced by the abundance
values predicted by environmental variables:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">$</span><span class="va">tab</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] -0.7110707 -0.9017974 -0.1837108 -0.2878715 -0.3884491 -0.4447357</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">pca.fish</span><span class="op">$</span><span class="va">tab</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">env</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;          1          2          3          4          5          6 </span></span>
<span><span class="co">#&gt; -0.7110707 -0.9017974 -0.1837108 -0.2878715 -0.3884491 -0.4447357</span></span></code></pre>
<p>The <code>plot</code> function displays the main outputs of the
analysis.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chap2tables_files/figure-html/unnamed-chunk-15-1.png" width="600" height="600"></p>
<p>Plot of the outputs of a Redundancy Analysis. This is a composite
plot made of six graphs (see text for an explanation of the six
graphs).</p>
<p>There are two ways to interpret RDA outputs. In the first
interpretation, the analysis computes loadings for the fish species
(<code>$c1</code>) which are represented on the bottom-right graph. The
three groups of species are identified. These loadings are then used to
compute scores (<code>$ls</code>) for the sites. These site scores are
thus linear combinations of species abundances maximising the variance
explained by environmental variables. Fitted values of these scores
predicted by environmental variables are contained in <code>$li</code>.
Sites are positioned by two sets of score: the first set is based on the
species composition (<code>$ls</code>) and the second relates to the
environmental conditions (<code>$li</code>). Both sets are plotted
simultaneously on the top-right graph of the plot. Residuals of the
global species-environment model are represented by arrows (each site is
an arrow and the start corresponds to its fitted environmental score and
the head to its composition). A short arrow reveals a good agreement
between the species composition of a site and its prediction by
environmental conditions while a long arrow indicates a discrepancy.</p>
<p>In the second interpretation, the analysis seeks loadings for
environmental variables (<code>$fa</code>) which are represented on the
top-left graph, to compute a constrained principal component (linear
combination of environmental variables stored in <code>$l1</code>). In
this example, the first constrained principal component is mainly
defined by the distance from the source (<code>dfs</code>) that
corresponds to the highest loading. The constrained principal component
maximises the sum of squared covariances with the fish species. Species
are thus represented by these covariances (<code>$co</code>).
Correlations between the constrained principal component and
environmental variables are stored in <code>$cor</code> and plotted on
the middle-left graph. The first constrained principal component is
mainly correlated to geomorphological variables (positively with
distance from the source and flow, negatively with altitude and slope).
While the first dimension is mainly built with the distance from the
source, it is strongly correlated with several other environmental
descriptors. This lack of agreement between loadings and correlations is
due to collinearity among variables (Dormann 2013) so that one variable
(distance from the source) is sufficient to explain the effect of all
geomorphological variables. The use of correlations should thus be
preferred to interpret the different dimensions. This sensitivity of
coefficients to collinearity is a major difference between RDA and
Coinertia Analysis (Dray2003c).</p>
<p>Lastly, the middle-bottom graph shows the projection of the first
axes of the initial simple analysis (<code>pca.fish</code>) onto the RDA
axes. This graph provides a convenient way to look at the relationships
between the unconstrained structures and the structures explained by
environmental variables. Here, there is a perfect agreement indicating
that the main patterns of variation in species composition are fully
explained by the environmental descriptors included in the analysis.</p>
<p>The <code>summary</code> function provides several useful results
about the analysis, especially concerning the criteria maximised:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Principal component analysis with instrumental variables</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Class: pcaiv dudi</span></span>
<span><span class="co">#&gt; Call: pcaiv(dudi = pca.fish, df = doubs$env, scannf = FALSE, nf = 2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total inertia: 50.26</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenvalues:</span></span>
<span><span class="co">#&gt;     Ax1     Ax2     Ax3     Ax4     Ax5 </span></span>
<span><span class="co">#&gt; 38.4177  5.9540  2.4162  1.3387  0.7431 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Projected inertia (%):</span></span>
<span><span class="co">#&gt;     Ax1     Ax2     Ax3     Ax4     Ax5 </span></span>
<span><span class="co">#&gt;  76.441  11.847   4.808   2.664   1.478 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cumulative projected inertia (%):</span></span>
<span><span class="co">#&gt;     Ax1   Ax1:2   Ax1:3   Ax1:4   Ax1:5 </span></span>
<span><span class="co">#&gt;   76.44   88.29   93.10   95.76   97.24 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Only 5 dimensions (out of 11) are shown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total unconstrained inertia (pca.fish): 66.08</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Inertia of pca.fish explained by doubs$env (%): 76.06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Decomposition per axis:</span></span>
<span><span class="co">#&gt;    iner inercum inerC inercumC ratio    R2 lambda</span></span>
<span><span class="co">#&gt; 1 42.75    42.7 42.59     42.6 0.996 0.902  38.42</span></span>
<span><span class="co">#&gt; 2  8.16    50.9  7.76     50.4 0.989 0.767   5.95</span></span></code></pre>
<p>As for any object inheriting from the <code>dudi</code> class, the
eigenvalues and percentages of (cumulative) projected inertia are
returned. The function returns also the total inertia (variation) of the
unconstrained analysis (<em>i.e.</em>, <code>pca.fish</code>) and the
percentage explained by the explanatory variables. In this example, 76%
of the variation in species composition is explained by the environment.
The function <code>randtest</code> is based on this quantity and allows
to evaluate its statistical significance by randomly permuting the rows
of the explanatory table:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/randtest.html">randtest</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Monte-Carlo test</span></span>
<span><span class="co">#&gt; Call: randtest.pcaiv(xtest = rda.doubs)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Observation: 0.7605909 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Based on 99 replicates</span></span>
<span><span class="co">#&gt; Simulated p-value: 0.01 </span></span>
<span><span class="co">#&gt; Alternative hypothesis: greater </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Std.Obs Expectation    Variance </span></span>
<span><span class="co">#&gt; 5.023592440 0.380845838 0.005714199</span></span></code></pre>
<p>Lastly, the <code>summary</code> function also returns information on
the eigenvalues and their decomposition. The initial analysis
(<code>pca.fish</code>) seeks linear combination of the variables with
maximal variance. These variances and their cumulative sum are reported
in the <code>iner</code> and <code>inercum</code> columns
respectively.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## iner</span></span>
<span><span class="va">pca.fish</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 42.74627</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pca.fish</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pca.fish</span><span class="op">$</span><span class="va">lw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 42.74627</span></span></code></pre>
<p>In Redundancy Analysis, eigenvalues (<code>lambda</code>) measure
amounts of variance in species composition explained by the
environmental variables. Hence, each eigenvalue corresponds to the
product of a variance (<code>inerC</code>) by a coefficient of
determination (<code>R2</code>).</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## lambda</span></span>
<span><span class="va">rda.doubs</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 38.41774</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">rda.doubs</span><span class="op">$</span><span class="va">lw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 38.41774</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## inerC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">rda.doubs</span><span class="op">$</span><span class="va">lw</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 42.59456</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## R2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">env</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.90194</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="va">rda.doubs</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.90194</span></span></code></pre>
<p>RDA (which maximises the explained variance) can thus be seen as a
PCA (which maximises the variance) with an additional constraint of
prediction by the environmental variables. As RDA considers a compromise
(product variance by coefficient of determination), the maximisation of
the variance is not optimal and we can thus measure the effect of the
environmental constraint by computing the ratio (<code>ratio</code>)
between the variance obtained in RDA and the maximal value obtained in
PCA.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rda.doubs</span><span class="op">$</span><span class="va">ls</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">rda.doubs</span><span class="op">$</span><span class="va">lw</span><span class="op">)</span> <span class="op">/</span> <span class="va">pca.fish</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.9964509</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="canonical-correspondence-analysis">Canonical Correspondence Analysis<a class="anchor" aria-label="anchor" href="#canonical-correspondence-analysis"></a>
</h3>
<p>Correspondence Analysis on Instrumental Variables (CAIV) corresponds
to the case where the species response table is treated by
Correspondence Analysis (CA). This method is known by ecologists under
the name of Canonical Correspondence Analysis (CCA). CCA is probably the
mostly widely used method for direct gradient analysis. In
<strong>ade4</strong>, it is performed using the general
<code>pcaiv</code> function applied on a CA <code>dudi</code> object
created by the <code>dudi.coa</code> function.</p>
<p>CCA is a particular analysis on instrumental variables, thus all
interpretations of the outputs described for RDA remain valid. As it is
based on CA, the principal characteristic of CCA is that it relates to
weighted-averaging principle and thus provides an estimation of niche
unimodal response to environmental gradient. We will focus on this
aspect in this chapter. As RDA, CCA is simply performed using the
<code>pcaiv</code> function:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cca.doubs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcaiv.html">pcaiv</a></span><span class="op">(</span><span class="va">coa.fish</span>, <span class="va">doubs</span><span class="op">$</span><span class="va">env</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Plot of the outputs of a Canonical Correspondence Analysis.</p>
<p>The <code>cca.doubs</code> object inherits from the <code>dudi</code>
class. As for other two-table methods, the <code>plot</code> function
displays the main outputs of the analysis.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cca.doubs</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chap2tables_files/figure-html/unnamed-chunk-22-1.png" width="600" height="600"></p>
<p>According to the niche viewpoint, CCA seeks loadings for
environmental variables (<code>cca.doubs$fa</code>) that are used to
compute a site score (<code>cca.doubs$l1</code>).</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cca.coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">cca.doubs</span><span class="op">$</span><span class="va">fa</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cca.site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">cca.doubs</span><span class="op">$</span><span class="va">l1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cca.site</span>,<span class="va">cca.coef</span><span class="op">)</span>, positions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span>,<span class="fl">0.4</span>,<span class="fl">1</span>,<span class="fl">0.3</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.7</span><span class="op">)</span>, byrow<span class="op">=</span><span class="cn">TRUE</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chap2tables_files/figure-html/unnamed-chunk-23-1.png" width="600" height="600"></p>
<p>Plot of the outputs of a Canonical Correspondence Analysis. Site
scores as linear combination of environmental variables
(<code>$l1</code>) and loadings for the environmental variables
(<code>$fa</code>).</p>
<p>Then, species score can be computed by weighted averaging. For
instance, the brown trout (<code>Satr</code>) is present in the
following sites:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">2</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      1 2 3 4 5 6 7 10 11 12 13 14 15 16 17 18 29</span></span>
<span><span class="co">#&gt; Satr 3 5 5 4 2 3 5  1  3  5  5  5  4  3  2  1  1</span></span></code></pre>
<p>Its position on the first two CCA axes can be computed using the
<code>weighted.mean</code> function:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">cca.doubs</span><span class="op">$</span><span class="va">l1</span>, <span class="fl">2</span>, <span class="va">weighted.mean</span>, w <span class="op">=</span> <span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;        RS1        RS2 </span></span>
<span><span class="co">#&gt; -1.5268643 -0.4276247</span></span></code></pre>
<p>The <code>s.distri</code> function can be used to position species on
the sites plot. On the plot, the species (brown trout,
<code>Satr</code>) is positioned by weighted averaging and segments link
the species to the sites where it is present.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cca.Satr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.distri.html">s.distri</a></span><span class="op">(</span><span class="va">cca.doubs</span><span class="op">$</span><span class="va">l1</span>, <span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span>, <span class="fl">2</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, </span>
<span>  ellipseSize<span class="op">=</span><span class="fl">0</span>, plines.lty <span class="op">=</span> <span class="fl">2</span>, plabels.cex <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/superpose.html" class="external-link">superpose</a></span><span class="op">(</span><span class="va">cca.Satr</span>,<span class="va">cca.site</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chap2tables_files/figure-html/unnamed-chunk-26-1.png" width="600" height="600"></p>
<p>Plot of the outputs of a Canonical Correspondence Analysis. Site
scores as linear combination of environmental variables
(<code>$l1</code>) and species positioned by weighted averaging (here,
only the brown trout (<code>Satr</code>) is represented).</p>
<p>The <code>getstats</code> function returns the different statistics
computed to produce the plot. Here, we obtain:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEg-class.html" class="external-link">getstats</a></span><span class="op">(</span><span class="va">cca.Satr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $means</span></span>
<span><span class="co">#&gt;            RS1        RS2</span></span>
<span><span class="co">#&gt; Satr -1.526864 -0.4276247</span></span></code></pre>
<p>Species scores are directly computed when the <code>cca.doubs</code>
object is created and stored in <code>cca.doubs$co</code>:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cca.doubs</span><span class="op">$</span><span class="va">co</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;          Comp1      Comp2</span></span>
<span><span class="co">#&gt; Satr -1.526864 -0.4276247</span></span></code></pre>
<p>Hence, a biplot can be drawn using the <code>superpose</code>
function to represent simultaneously the site (<code>$l1</code>) and the
species scores (<code>$co</code>) on the same plot.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cca.species</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">cca.doubs</span><span class="op">$</span><span class="va">co</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/superpose.html" class="external-link">superpose</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">cca.site</span>, plabels.cex <span class="op">=</span> <span class="fl">0</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="va">cca.species</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chap2tables_files/figure-html/unnamed-chunk-29-1.png" width="600" height="600"></p>
<p>Plot of the outputs of a canonical correspondence analysis.
Simultaneous representation of site and species scores.</p>
</div>
<div class="section level3">
<h3 id="related-software-and-methods">Related software and methods<a class="anchor" aria-label="anchor" href="#related-software-and-methods"></a>
</h3>
<p>Links with other methods or software are presented in this
paragraph.</p>
<div class="section level4">
<h4 id="vegan">vegan<a class="anchor" aria-label="anchor" href="#vegan"></a>
</h4>
<p>The <strong>vegan</strong> package contains the <code>rda</code> and
<code>cca</code> functions and provides many additional functionalities
for this type of analysis (significance tests, formula interface,
conditional effects, etc.). The links between outputs from
<strong>ade4</strong> and <strong>vegan</strong> packages are summarised
in the following Table in the case of Canonical Correspondence Analysis.
The same equivalences exist in the case of Redundancy Analysis but some
discrepancies are observed because <strong>vegan</strong> uses unbiased
estimates for the variance (i.e., divided by <span class="math inline">\(n-1\)</span>) while <strong>ade4</strong> divides
by <span class="math inline">\(n\)</span> to preserve some properties in
the geometric viewpoint.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Objects</th>
<th align="center">ade4</th>
<th align="center">vegan</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Eigenvalues</td>
<td align="center"><code>$eig</code></td>
<td align="center"><code>$CCA$eig</code></td>
</tr>
<tr class="even">
<td align="left">Site scores (LC)</td>
<td align="center"><code>$li</code></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Unit-variance site scores</td>
<td align="center"><code>$l1</code></td>
<td align="center"><code>$CCA$u</code></td>
</tr>
<tr class="even">
<td align="left">Site scores (WA)</td>
<td align="center"><code>$ls</code></td>
<td align="center"><code>$CCA$wa</code></td>
</tr>
<tr class="odd">
<td align="left">Unit-variance species scores</td>
<td align="center"><code>$c1</code></td>
<td align="center"><code>$CCA$v</code></td>
</tr>
<tr class="even">
<td align="left">Species scores</td>
<td align="center"><code>$co</code></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Species weights</td>
<td align="center"><code>$cw</code></td>
<td align="center"><code>$colsum</code></td>
</tr>
<tr class="even">
<td align="left">Site weights</td>
<td align="center"><code>$lw</code></td>
<td align="center"><code>$rowsum</code></td>
</tr>
<tr class="odd">
<td align="left">Correlation with environmental variables</td>
<td align="center"><code>$cor</code></td>
<td align="center"><code>$CCA$biplot</code></td>
</tr>
</tbody>
</table>
<p>Canonical Correspondence Analysis: equivalency between objects
created by the <strong>ade4</strong> and <strong>vegan</strong>
packages. In <strong>vegan</strong>, the scores for sites and species
can be obtained with the <code>scores.cca</code> function.</p>
</div>
<div class="section level4">
<h4 id="discriminant-analysis">Discriminant Analysis<a class="anchor" aria-label="anchor" href="#discriminant-analysis"></a>
</h4>
<p>Canonical Correspondence Analysis shares many similarities with
Greenâ€™s Discriminant Analysis (Green 1971, Green 1974). It can be
demonstrated that both methods are identical except in the statistical
objects considered in the analysis: they are the sites in CCA and the
individuals in Discriminant Analysis. This equivalence between both
approaches can be illustrated using <strong>ade4</strong>
functionalities. Each non-null cell of the <code>doubs$fish</code> table
is associated to a given species, a given site and is characterised by a
number of individuals:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">&gt;</span><span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">nind</span> <span class="op">&lt;-</span> <span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span></span></code></pre></div>
<p>It is then possible to inflate the data by duplicating the rows of
the original environmental table <code>doubs$env</code> so that each row
corresponds to an individual. A vector with the species names is also
created to indicate the species identity of each individual:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env.ind</span> <span class="op">&lt;-</span> <span class="va">doubs</span><span class="op">$</span><span class="va">env</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">idx</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">nind</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">species.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">idx</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">nind</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1004</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">env.ind</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1004</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">species.ind</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1004</span></span></code></pre>
<p>Discriminant Analysis is then performed on the inflated tables. The
aim of the analysis is to find a linear combination of environmental
variables that maximises the separation of species identities.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">env.ind</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dis.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discrimin.html">discrimin</a></span><span class="op">(</span><span class="va">pca.ind</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">species.ind</span><span class="op">)</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>This Discriminant Analysis is equivalent to CCA:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dis.ind</span><span class="op">$</span><span class="va">eig</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] 0.534524357 0.121838565 0.068703183 0.049167872 0.027089749 0.012940921</span></span>
<span><span class="co">#&gt;  [7] 0.009866962 0.005425199 0.003533575 0.002165512 0.001611664</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cca.doubs</span><span class="op">$</span><span class="va">eig</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] 0.534524357 0.121838565 0.068703183 0.049167872 0.027089749 0.012940921</span></span>
<span><span class="co">#&gt;  [7] 0.009866962 0.005425199 0.003533575 0.002165512 0.001611664</span></span></code></pre>
<p>In practice, this viewpoint has been developed for the analysis of
herbarium data where environmental information is gathered for
individuals and not for sites (Gimaret-Carpentier 2003, Pelissier
2003).</p>
</div>
<div class="section level4">
<h4 id="between--and-within-class-analyses">Between- and Within-Class Analyses<a class="anchor" aria-label="anchor" href="#between--and-within-class-analyses"></a>
</h4>
<p>Between- and Within-Class Analyses are presented in vignette 4
(Taking into account groups of sites). These methods can be seen as
particular cases of (orthogonal) analysis on instrumental variables
where only one explanatory categorical variable is considered:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meau</span><span class="op">)</span></span>
<span><span class="va">envpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">env</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "factor"</span></span></code></pre>
<p>Analyses performed by the <code>bca</code> (respectively
<code>wca</code>) and <code>pcaiv</code> (respectively
<code>pcaivortho</code>) functions are similar but the former produce
additional outputs adapted to the analysis of a partition of individuals
into groups.</p>
<p>The <code>bca</code> function is equivalent to the <code>pcaiv</code>
when only one categorical variable is used as explanatory:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">envbca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bca.html">bca</a></span><span class="op">(</span><span class="va">envpca</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">envpcaiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcaiv.html">pcaiv</a></span><span class="op">(</span><span class="va">envpca</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span><span class="op">)</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">envbca</span><span class="op">$</span><span class="va">eig</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1.5551200 1.0389730 0.5917648</span></span></code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">envpcaiv</span><span class="op">$</span><span class="va">eig</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1.5551200 1.0389730 0.5917648</span></span></code></pre>
<p>We have the same link between <code>wca</code> and
<code>pcaivortho</code>:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">envwca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wca.html">wca</a></span><span class="op">(</span><span class="va">envpca</span>, <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">envpcaivortho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcaivortho.html">pcaivortho</a></span><span class="op">(</span><span class="va">envpca</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span><span class="op">)</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">envwca</span><span class="op">$</span><span class="va">eig</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] 4.65054350 0.87006417 0.55651704 0.39003744 0.20546457 0.06549202</span></span>
<span><span class="co">#&gt;  [7] 0.03148325 0.02241936 0.01248411 0.00963672</span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">envpcaivortho</span><span class="op">$</span><span class="va">eig</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] 4.65054350 0.87006417 0.55651704 0.39003744 0.20546457 0.06549202</span></span>
<span><span class="co">#&gt;  [7] 0.03148325 0.02241936 0.01248411 0.00963672</span></span></code></pre>
<p>These outputs are also equivalent to the results obtained with the
<code>rda</code> function of the <strong>vegan</strong> package:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan" class="external-link">vegan</a></span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">envpca</span><span class="op">$</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/eigenvals.html" class="external-link">eigenvals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></span><span class="op">(</span><span class="va">envpca</span><span class="op">$</span><span class="va">tab</span> <span class="op">~</span> <span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span><span class="op">)</span>, <span class="st">"constrained"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      RDA1      RDA2      RDA3 </span></span>
<span><span class="co">#&gt; 1.6227340 1.0841458 0.6174937</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">envpcaiv</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">n</span><span class="op">/</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1.6227340 1.0841458 0.6174937</span></span></code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/eigenvals.html" class="external-link">eigenvals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></span><span class="op">(</span><span class="va">envpca</span><span class="op">$</span><span class="va">tab</span> <span class="op">~</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">meau</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="st">"unconstrained"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;       PC1       PC2       PC3       PC4       PC5 </span></span>
<span><span class="co">#&gt; 4.8527410 0.9078930 0.5807134 0.4069956 0.2143978</span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">envpcaivortho</span><span class="op">$</span><span class="va">eig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">*</span> <span class="va">n</span><span class="op">/</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 4.8527410 0.9078930 0.5807134 0.4069956 0.2143978</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by StÃ©phane Dray, Anne-BÃ©atrice Dufour, Jean Thioulouse, AurÃ©lie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
