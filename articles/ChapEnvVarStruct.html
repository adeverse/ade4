<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ade4">
<title>Description of environmental variables structures • ade4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Description of environmental variables structures">
<meta property="og:description" content="ade4">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-22</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-new-to-ade-">New to ade4?</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
    <a class="dropdown-item" href="../articles/install.html">Installation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Getting started</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a>
    <a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a>
    <a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a>
    <a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a>
    <a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a>
    <a class="dropdown-item" href="../articles/ChapKtables.html">Analysing Changes in Structures</a>
    <a class="dropdown-item" href="../articles/Chap2Ktables.html">Analysing Changes in Co-structures</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/related.html">Related packages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-ressources">Ressources</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-ressources">
    <a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/ade4shiny/">ade4shiny</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a>
    <a class="dropdown-item" href="../articles/book.html">ade4 book</a>
    <a class="dropdown-item" href="../articles/papers.html">Papers</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en">
    <span class="fa fa-leaf"></span>
     
    LBBE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adeverse/ade4">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Description of environmental variables structures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adeverse/ade4/blob/HEAD/vignettes/articles/ChapEnvVarStruct.Rmd" class="external-link"><code>vignettes/articles/ChapEnvVarStruct.Rmd</code></a></small>
      <div class="d-none name"><code>ChapEnvVarStruct.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>This vignette is about several simple data analysis methods that can
be used to describe the structure of environmental variables tables.
Simple here means that these methods are adapted to the analysis of only
one data table. If more information is available, for example
information on the structure of the table (e.g., groups of rows or of
columns), or if information is contained in more than one data table,
then other methods should be used.</p>
<p>The vignette is organized in three parts, corresponding to three data
analysis methods: <em>normed PCA</em> for quantitative variables,
<em>multiple correspondence analysis (MCA)</em> for qualitative
variables (<code>factors</code> in R), and the <em>Hill and Smith
analysis</em> for tables containing a mix of qualitative and
quantitative variables.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Several simple data analysis methods can be used to describe the
structure of environmental variables tables. Simple here means that
these methods are adapted to the analysis of only one data table. If
<em>more information</em> is available, for example information on the
structure of the table (e.g., groups of rows or of columns), or if
information is contained in <em>more than one</em> data table, then
other methods should be used. According to the type of measured
variables (quantitative, qualitative or both), different methods can be
considered.</p>
<p>These different approaches will be illustrated using the
<code>doubs</code> data set, from <strong>ade4</strong> (see
Verneaux1973 and <code>help("doubs", package "ade4")</code>) . The
<code>doubs$env</code> data frame contains eleven environmental
variables measured at 30 sites along the Doubs river in the Jura region
(France). The <code>doubs$fish</code> data frame contains the abundances
of 27 fish species that were found in the same sites. The
<code>doubs$xy</code> data frame contains the spatial coordinates of the
30 sites (two columns, x and y).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adeverse.github.io/ade4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">adegraphics</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "env"     "fish"    "xy"      "species"</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">env</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "dfs" "alt" "slo" "flo" "pH"  "har" "pho" "nit" "amm" "oxy" "bdo"</span></span></code></pre></div>
<p>The eleven variables are:</p>
<ol style="list-style-type: decimal">
<li>
<code>dfs</code>: distance from the source (km * 10)</li>
<li>
<code>alt</code>: altitude (m)</li>
<li>
<code>slo</code>: log(x + 1) where x is the slope (per mil *
100)</li>
<li>
<code>flo</code>: minimum average stream flow (m<span class="math inline">\(^3\)</span>/s * 100)</li>
<li>
<code>pH</code> (* 10)</li>
<li>
<code>har</code>: total hardness of water (mg/l of Calcium)</li>
<li>
<code>pho</code>: phosphates (mg/l * 100)</li>
<li>
<code>nit</code>: nitrates (mg/l * 100)</li>
<li>
<code>amm</code>: ammonia nitrogen (mg/l * 100)</li>
<li>
<code>oxy</code>: dissolved oxygen (mg/l * 10)</li>
<li>
<code>bdo</code>: biological demand for oxygen (mg/l * 10)</li>
</ol>
<p>This environmental table can be represented graphically using the
<code>table.value</code> or <code>table.image</code> function of the
<strong>adegraphics</strong> package. Here the data are represented
using the <code>table.value</code> function. As the ranges of variation
of the differental environmental variables are quite different, we
scaled the data to allow a common and meaningful graphical
representation:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="va">doubs</span><span class="op">$</span><span class="va">env</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">env</span>, <span class="fl">2</span>, <span class="va">range</span><span class="op">)</span></span>
<span><span class="co">#&gt;       dfs alt   slo  flo pH har pho nit amm oxy bdo</span></span>
<span><span class="co">#&gt; [1,]    3 172 1.099   84 77  40   1  15   0  41  13</span></span>
<span><span class="co">#&gt; [2,] 4530 934 6.176 6900 86 110 422 620 180 124 167</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table.value.html">table.value</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span>, symbol <span class="op">=</span> <span class="st">"circle"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-5-1.png" width="600" height="600"></p>
<p>As the spatial coordinates are also available, sites can be plotted
in the geographical space. The <code>s.label</code> function can be used
to draw the position of sites, with the site number as label and with
the <code>s.traject</code> to draw lines between sites.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="va">doubs</span><span class="op">$</span><span class="va">xy</span></span>
<span><span class="va">sl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">xy</span>, ppoints.cex <span class="op">=</span> <span class="fl">0</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">st1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.traject.html">s.traject</a></span><span class="op">(</span><span class="va">xy</span>, ppoints.cex <span class="op">=</span> <span class="fl">0</span>, plabels.cex <span class="op">=</span> <span class="fl">0</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/superpose.html" class="external-link">superpose</a></span><span class="op">(</span><span class="va">st1</span>, <span class="va">sl1</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-6-1.png" width="500" height="500"></p>
<p>To facilitate the interpretation of environmental data, information
of both figures can be combined by creating thematic maps for all
variables. To achieve this, we use the <code>s.value</code> function,
with multivariate data in the <code>z</code> argument. It automatically
loops over the variables and produces 11 geographical maps presented
here. By default, this function plots squares which size is proportional
to a set of values. The colour of the squares gives the sign of the
value (white for negative values, black for positive). Here, we modify
the <code>method</code>, <code>symbol</code> and
<code>ppalette.quanti</code> parameters to obtain figures with coloured
circles.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#EDF8FB"</span>, <span class="st">"#006D2C"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/s.value.html">s.value</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">doubs</span><span class="op">$</span><span class="va">env</span>, pgrid.draw <span class="op">=</span> <span class="cn">FALSE</span>, porigin.draw <span class="op">=</span> <span class="cn">FALSE</span>, plegend.drawKey <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>psub.cex <span class="op">=</span> <span class="fl">2</span>, method <span class="op">=</span> <span class="st">"color"</span>, symbol <span class="op">=</span> <span class="st">"circle"</span>, ppalette.quanti <span class="op">=</span> <span class="va">mypal</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-7-1.png" width="600" height="450"></p>
<p>The maps presented here highlights that some environmental variables
have similar spatial distributions (e.g., distance from the source
(<code>dfs</code>) and stream flow (<code>flo</code>)). The objective of
multivariate methods is to provide a summary of this environmental table
by identifying the main patterns of variation and which variables are
involved in these structures.</p>
</div>
<div class="section level2">
<h2 id="standardised-principal-components-analysis-pca">Standardised Principal Components Analysis (PCA)<a class="anchor" aria-label="anchor" href="#standardised-principal-components-analysis-pca"></a>
</h2>
<p>Principal Component Analysis (Pearson 1901; Hotelling 1933) is the
most simple and the basis of all multivariate analysis methods. It
allows to summarise the structure of a table containing quantitative
variables. Many theoretical models lead to the same computations, but
the duality diagram (Escoufier 1987) and the geometric model (LeRoux and
Rouanet 2004) are the ones used in the <strong>ade4</strong> package. In
the <strong>ade4</strong> package, the <code>dudi.pca</code> function is
used to compute a PCA, and all the outputs of this function are grouped
in a <code>dudi</code> object (subclass <code>pca</code>).</p>
<p>Two types of PCA are generally distinguished: <em>covariance
matrix</em> PCA and <em>correlation matrix</em> PCA. They can be
considered as the same method, applied after a different treatment of
the data table: centring (subtracting the mean of each variable) for
covariance matrix PCA and standardisation (subtracting the mean and
dividing by the standard deviation) for correlation matrix PCA.</p>
<p>In the case of the <code>env</code> data table, the choice between
covariance or correlation matrix PCA is easy: variables are not
expressed in the same units and have very different variances, ranging
from 1 to more than 3.106. Here, differences in variances are
meaningless and should not be considered in the analysis. Using a
correlation matrix PCA is therefore necessary to remove these
differences.</p>
<p>When all the variables are measured in the same units (homogeneous
tables), both types of PCA can be applied. PCA on covariance matrix
would give more importance to variables with high variance as they
contribute more to the total inertia and thus will have more weight in
the definition of axes. On the other hand, PCA on correlation matrix
will give an equal importance to all the variables so that only the
redundance (i.e., correlations) among variables drives the definition of
axes. To choose between the two possibilities, users must decide if the
differences between variances are (or not) a useful information that
should be taken into account in the analysis. For example, in toxicity
tables, all the values are LD50 (lethal dose 50, i.e., the concentration
that kills 50% of organisms), and the columns correspond to different
chemical compounds instead of different variables. Using a correlation
matrix PCA on these tables will probably remove important information
about the difference in toxicity between chemical compounds or between
the diversity of species. In these cases, a covariance matrix PCA
(argument scale set to FALSE) is preferable.</p>
<p>The PCA of the <code>doubs$env</code> table is computed with the
<code>dudi.pca</code> function and stored in the <code>pca1</code>
object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">env</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The <code>scale</code> argument is set to <code>TRUE</code> (the
default value), so the PCA will be computed on the standardised (centred
and normed) data table. The result is therefore a correlation matrix
PCA.</p>
<p>The <code>scannf</code> argument (“<strong>scan</strong> the
<strong>n</strong>umber of <strong>f</strong>actors”) is set to FALSE,
which means that the number of axes should not be asked to the user, but
arbitrarily set to three. This value (three) is given by the third
argument, <code>nf</code>. If <code>nf</code> is not set explicitly, it
defaults to two. When running in interactive mode, the
<code>scannf</code> argument should not be used, and its default value
(<code>TRUE</code>) will cause the function to ask the number of axes
(principal components) interactively to the user. This is the number of
axes that should be “kept” in output files, and on which loadings and
scores will be computed.</p>
<p>Many methods have been invented to try to guess the number of
principal components that should be kept after a PCA. In
<strong>ade4</strong>, users are simply asked how many components they
want. To help answer this question, <code>dudi</code> functions display
a barplot of eigenvalues in decreasing order. The user should then try
to find a discontinuity in the shape of the decrease, and choose to keep
the axes corresponding to eigenvalues placed before (on the left of)
this discontinuity.</p>
<p>For example, in the following figure, the user should keep (from left
to right) 2, 3 and 4 axes.</p>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-9-1.png" width="600" height="200"></p>
<p>Of course these examples are quite caricatural, and in real
situations, it can be much harder to choose an appropriate number of
principal components. However the principle remains that the shape of
the decrease of eigenvalues is a good indicator of the presence of
structures in the data table. Trying to keep the axes that correspond to
these potentially interesting structures is therefore a good and
easy-to-use rule. As an alternative, the procedure developed by Dray
(2008) is implemented in the <code>testdim</code> function that can be
applied on correlation matrix PCA created by the <code>dudi.pca</code>
function with <code>scale = TRUE</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testdim.html">testdim</a></span><span class="op">(</span><span class="va">pca1</span><span class="op">)</span><span class="op">$</span><span class="va">nb.cor</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>The next figure shows the barplot of <code>pca1</code> eigenvalues.
Three principal components were kept (although the <code>testdim</code>
procedure said two).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">pca1</span>, main<span class="op">=</span><span class="st">" "</span>, xlab<span class="op">=</span><span class="st">" "</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-11-1.png" width="600" height="300"></p>
<p>The correlation circle of the variables (left) and the factor map of
sites (right) on the first two principal components are shown in the
next figure.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">pca1</span><span class="op">$</span><span class="va">co</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">pca1</span><span class="op">$</span><span class="va">li</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sc1</span>, <span class="va">sl1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-12-1.png" width="600" height="300"></p>
<p>This correlation circle (<code>sc1</code> object) shows two nearly
orthogonal gradients: a geomorphological gradient opposing altitude and
slope to hardness, distance from the source and stream flow, and a
chemical gradient, opposing dissolved oxygen to phosphates, ammonium,
and biological demand for oxygen. Oxygen concentration is higher
upstream, and pollution is higher downstream, so these two gradients are
not completely orthogonal. The first principal component is an
upstream-downstream gradient, while the second component opposes
geomorphology to chemical processes.</p>
<p>The factor map on the right (<code>sl1</code> object) shows that the
sites are ordered along the first principal component, from site 1
(upstream, 300 m from the source) to site 30 (downstream, 453 km from
the source). Departures from this geomorphology gradient are explained
by the chemical gradient: sites with a high concentration of oxygen (1,
4, 7, 11, 12, 13, 14, 15) are in the lower-left part of the graph, and
sites with a high concentration of ammonium, phosphates and a high BDO
(23, 24, 25) are in the upper-right part of the graph.</p>
<p>The site coordinates can also be used to draw geographical maps of
site scores, using the <code>s.value</code> function. This next figure
shows the map of site scores on the first two principal components. The
first principal component (left) is clearly an upstream-downstream
gradient, with the exception of sites 23 to 25 (see site numbers in
previous figure). The second principal component (right) cuts this
gradient in four parts: the upper stream (sites 1 to 22) is divided in
two, according to altitude and slope, and the lower stream (sites 23 to
30) is divided according to the pollution variables (ammonium,
phosphates and BDO) which are higher in sites 23 to 26 and lower in
sites 27 to 30.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/s.value.html">s.value</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">pca1</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, pgrid.draw <span class="op">=</span> <span class="cn">FALSE</span>, porigin.draw <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>symbol <span class="op">=</span> <span class="st">"circle"</span>, col <span class="op">=</span> <span class="fu">mypal</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, ppoints.cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-13-1.png" width="600" height="300"></p>
<p>The upstream-downstream gradients and the particular characteristics
of highly polluted sites (sites 23 to 26) or of sites with high oxygen
concentration (11 to 15) appear very clearly on these maps.</p>
<p>More generally, the geographical maps of site scores and their
comparison with the collection of maps of standardised variables can be
very useful to help interpret the outputs of a PCA. Drawing these maps
is not possible when there are hundreds of variables (as it is the case
for DNA fingerprints, for example), but then, particular variables of
interest (e.g., variables with the most important relative
contributions, see Box 3.3) can be chosen and mapped.</p>
</div>
<div class="section level2">
<h2 id="multiple-correspondence-analysis-mca">Multiple Correspondence Analysis (MCA)<a class="anchor" aria-label="anchor" href="#multiple-correspondence-analysis-mca"></a>
</h2>
<p>Multiple Correspondence Analysis (MCA) is the basic method to analyse
tables of qualitative variables (see the synthesis by Tenenhaus1985)
that are stored as <code>factors</code> in <strong>R</strong>. We
illustrate MCA with the same data set, but we obtain qualitative
variables by spliting the quantitative variables into categories. Four
categories are defined automatically for each variable using the
<code>cut</code> function. This function is applied to the environmental
variables with the <code>apply</code> function, and the resulting
qualitative variables are stored in the <code>fenv</code> data
frame.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fenv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">env</span>, <span class="fl">2</span>, <span class="va">cut</span>, breaks <span class="op">=</span> <span class="fl">4</span>, labels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">fenv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fenv</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>This transformation induces a loss of information as different values
for a quantitative variable are regrouped into a single category of the
recoded qualitative variable. However, this approach can be useful when
non-linear relationships occur between variables. In this case, PCA
which is based on correlations, will only be able to extract linear
relationships wherears MCA can identify non-linear trends by reordering
the categories. When the relationships between variables are (at least
approximately) linear, the results of both methods should be
comparable.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">env</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="va">fenv</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"Quantitative dfs"</span>, xlab <span class="op">=</span> <span class="st">"Qualitative dfs"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-15-1.png" width="400" height="400"></p>
<p>MCA allows to identify associations between the categories
(<code>levels</code>) of different qualitative variables
(<code>factor</code>). The method is implemented in the
<code>dudi.acm</code> function of the <strong>ade4</strong> package. All
the outputs of this function are grouped in a <code>dudi</code> object
(subclass <code>acm</code>). Here, we applied MCA on the data frame
<code>fenv</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.acm.html">dudi.acm</a></span><span class="op">(</span><span class="va">fenv</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">acm1</span>, main <span class="op">=</span> <span class="st">" "</span>, xlab <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-16-1.png" width="600" height="300"></p>
<p>The main difference between PCA and MCA is that the columns of the
analysed table are the variables in PCA but the categories of
qualitative variables in MCA:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">pca1</span><span class="op">$</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 11</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">acm1</span><span class="op">$</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 44</span></span></code></pre></div>
<p>The categories correspond to the different columns in the disjunctive
table analysed by the MCA which means that their order is not taken into
account, just like different variables in a PCA. As a consequence, the
number of eigenvalues is also increased in MCA. Another important
difference is that MCA weights columns proportionally to the number of
individuals belonging to the categories so that all variables have the
same weights (as in PCA):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acm1</span><span class="op">$</span><span class="va">cw</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">fenv</span><span class="op">$</span><span class="va">dfs</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fenv</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fenv</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    1    2    3    4 </span></span>
<span><span class="co">#&gt; TRUE TRUE TRUE TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span><span class="va">acm1</span><span class="op">$</span><span class="va">cw</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fenv</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fenv</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1</span></span></code></pre></div>
<p>The next figure shows that, except for an inversion of the sign of
the second axis, the factor map of sites is still very similar to the
factor map obtained by the PCA. The same typology of sampling sites
along the stream is found: upper-stream sites (<code>1</code> to
<code>10</code>) with high oxygen concentration and low ammonium and BDO
are opposed to lower-stream sites (<code>26</code> to <code>30</code>),
with sites <code>23</code> to <code>25</code> having an exceptionally
high level of pollution.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">acm1</span><span class="op">$</span><span class="va">co</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">acm1</span><span class="op">$</span><span class="va">li</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sl1</span>, <span class="va">sl2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-21-1.png" width="600" height="300"></p>
<p>The graph of categories (left) is somewhat different because we now
have one point for each category of each qualitative variable (44
categories as a whole) instead of 11 points only. The interpretation is
however the same: categories corresponding to high levels of ammonium
and BDO (<code>amm.4</code>, <code>bdo.4</code>) and to low levels of
oxygen (<code>oxy.1</code>) are on the right of the graph, where highly
polluted sites are found. Conversely, categories corresponding to high
levels of oxygen (<code>oxy.4</code>), high values of slope
(<code>slo.4</code>), low values of flow (<code>flo.1</code>) and
hardness (<code>hard.1</code>, <code>hard.2</code>) are located on the
left of the graph, where upper-stream sites are found.</p>
<p>MCA allows to carry out the interpretation of factors at the level of
categories. This means that one can get a better (finer) explanation of
the meaning of factors. In the <strong>ade4</strong> package, this
property is used to draw particular graphs that show which individuals
belong to each category. Two types of graphs can be drawn, using
functions <code>score</code> and <code>plot</code>.</p>
<p>The first type of graph (using the <code>score</code> function) shows
the results of MCA for a given axis (specified by the <code>xax</code>
argument which is equal to 1 by default). The normed coordinates of all
the individuals (<code>acm1$l1</code>) are placed along the x-axis and
the categories are displayed at the mean of the coordinates of their
individuals. The vertical coordinate is given by the category score
(<code>acm1$co</code>). It is then easy to interpret the meaning of the
factor by looking at the positions of categories and individuals. For
example, on this figure, one can see that the categories of variables
hardness, phosphorus, nitrates, ammonium and BDO are ordered by
increasing values along the first MCA factor.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">acm1</span>, type <span class="op">=</span> <span class="st">"points"</span>, col <span class="op">=</span> <span class="cn">TRUE</span>, psub.cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-22-1.png" width="600" height="450"></p>
<p>Conversely, the categories of variables altitude, slope, oxygen are
ordered by decreasing values along the first MCA factor. On the vertical
axis, the intervals between labels give information of the differences
among categories (variance between categories). On the horizontal axis,
the spacing among the tick marks allows to evaluate the homogeneity of
individuals in a category (variance within categories). As the
individual scores in MCA (<code>acm1$l1</code>) maximise the mean
correlation ratio for all the qualitative variables, it is expected that
the more vertical is the regression line for a qualitative variable, the
higher is its correlation ratio value.</p>
<p>Correlation ratios are stored in <code>acm1$cr</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acm1</span><span class="op">$</span><span class="va">cr</span></span>
<span><span class="co">#&gt;            RS1        RS2</span></span>
<span><span class="co">#&gt; dfs 0.65016681 0.54171843</span></span>
<span><span class="co">#&gt; alt 0.54859870 0.46823722</span></span>
<span><span class="co">#&gt; slo 0.36285735 0.18818923</span></span>
<span><span class="co">#&gt; flo 0.52994726 0.57221033</span></span>
<span><span class="co">#&gt; pH  0.02395703 0.15608652</span></span>
<span><span class="co">#&gt; har 0.37615802 0.26756014</span></span>
<span><span class="co">#&gt; pho 0.75418361 0.33688896</span></span>
<span><span class="co">#&gt; nit 0.73983937 0.53046062</span></span>
<span><span class="co">#&gt; amm 0.71443072 0.36912488</span></span>
<span><span class="co">#&gt; oxy 0.67303617 0.07847305</span></span>
<span><span class="co">#&gt; bdo 0.65985629 0.38952981</span></span></code></pre></div>
<p>The second type of graph is shown in the next figure. It can be drawn
using the <code>plot</code> function. It is a bidimensional plot, with
two MCA axes as abscissae and ordinates (specified by the
<code>xax</code> and <code>yax</code> arguments, with default values
equal to 1 and 2 respectively). Each category of each variable is
displayed by an ellipse. The position of the center of the ellipse is
given by the means of the coordinates of the individuals
(<code>$li</code>) belonging to the category. The width and height of an
ellipse are given by the variance of the coordinates of the individuals,
and the covariance between the coordinates on the two axes gives the
slope of the ellipse. The interpretation of this figure is the same as
the previous one, but it is much more easy and detailed, as the
categories of all the variables are not superimposed.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">acm1</span>, col <span class="op">=</span> <span class="cn">TRUE</span>, psub.cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-24-1.png" width="600" height="450"></p>
</div>
<div class="section level2">
<h2 id="hill-and-smith-analysis">Hill and Smith analysis<a class="anchor" aria-label="anchor" href="#hill-and-smith-analysis"></a>
</h2>
<p>Environmental data sets with exclusively qualitative variables are
not very frequent. Some variables are easy to measure automatically on a
continuous scale, while others are intrinsically qualitative. So the
most frequent case is a table containing a mix of qualitative and
quantitative variables. In this case, one can choose between two
strategies: transforming quantitative variables to qualitative ones and
using MCA, or considering qualitative variables as quantitative ones and
using PCA.</p>
<p>The first strategy can be used when the number quantitative variables
is low. If this is not the case (most variables are quantitative with
just a few qualitative ones), the loss of information may badly
influence the results of the data analysis procedure. The second
strategy can be used when qualitative variables are in fact ordered
qualitative variables (e.g., categories <em>low</em>}, <em>medium</em>
and <em>high</em>). In this case, using PCA can be relevant (if linear
trends are expected) but it is not a viable solution when qualitative
variables contains categories that cannot be oredered (e.g.,
<code>blue</code>, <code>red</code> and <code>green</code>).</p>
<p>The Hill and Smith Analysis (HillSmith76) is a data analysis method
that is able to deal directly with a data table containing a mix of
quantitative and (ordered or unordered) qualitative variables. This
method does not modify the original characteristics of the variables,
avoiding the arbitrary choices of the two previous strategies. If all
the variables are quantitative, then the results of HSA are identical to
those of PCA. If all the variables are qualitative, then the results are
identical to those of MCA. And if there is a mix of <span class="math inline">\(p\)</span> quantitative variables and <span class="math inline">\(q\)</span> qualitative variables, then the
analysis is an optimal combination of the properties of the two
analyses.</p>
<p>The row weights of this analysis are the same as the row weights of
the PCA of the <em>p</em> quantitative variables, and are also equal to
the row weights of the MCA of the <em>q</em> qualitative variables. The
column weights are different: for quantitative variables, column weights
are equal to <em>1/(p+q)</em>, instead of 1 in a PCA. For qualitative
variables, the weights are computed as in MCA (sum of the weights of the
individuals belonging to each category, divided by <em>q</em>), except
that it is divided here by the total number of variables (<em>p+q</em>)
instead of <em>q</em>. The total sum of column weights is therefore
equal to 1, and qualitative and quantitative variables have the same
weights.</p>
<p>To illustrate HSA, we consider the Doubs data where the first six
variables are considered as qualitative and the last five as
quantitative:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">menv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fenv</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="va">env</span><span class="op">[</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The Hill and Smith Analysis is then computed on the resulting table
using the <code>dudi.hillsmith</code> function of the
<strong>ade4</strong> package. The <code>scatter</code> function can
then be used to draw the biplot, where quantitative variables appear as
simple labels, while qualitative ones appear with one label for each
category.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.hillsmith.html">dudi.hillsmith</a></span><span class="op">(</span><span class="va">menv</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/scatter.html">scatter</a></span><span class="op">(</span><span class="va">hs1</span>, posieig <span class="op">=</span> <span class="st">"bottomleft"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-26-1.png" width="600" height="600"></p>
<p>The <code>score</code> function can also be used to highlight the
properties of the method. HSA maximises the squared correlation for
quantitative variables (<em>i.e.</em>, the criteria of PCA) and the
correlation ratio for qualitative variables (<em>i.e.</em>, the criteria
of MCA). As consequence, the next figure can be interpreted as the
previous one for quantitative variables and for qualitative
variables.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">hs1</span>, col <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapEnvVarStruct_files/figure-html/unnamed-chunk-27-1.png" width="600" height="400"></p>
<p>These values are also stored in <code>hs1$cr</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs1</span><span class="op">$</span><span class="va">cr</span></span>
<span><span class="co">#&gt;            RS1         RS2</span></span>
<span><span class="co">#&gt; dfs 0.70221662 0.840069215</span></span>
<span><span class="co">#&gt; alt 0.65252421 0.741725649</span></span>
<span><span class="co">#&gt; slo 0.41025629 0.157049355</span></span>
<span><span class="co">#&gt; flo 0.63964656 0.633380517</span></span>
<span><span class="co">#&gt; pH  0.02332208 0.225874627</span></span>
<span><span class="co">#&gt; har 0.42895368 0.320769976</span></span>
<span><span class="co">#&gt; pho 0.75512094 0.046148513</span></span>
<span><span class="co">#&gt; nit 0.85903395 0.008401339</span></span>
<span><span class="co">#&gt; amm 0.70428031 0.069365094</span></span>
<span><span class="co">#&gt; oxy 0.61287111 0.202631179</span></span>
<span><span class="co">#&gt; bdo 0.63869975 0.126526651</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="other-simple-methods">Other simple methods<a class="anchor" aria-label="anchor" href="#other-simple-methods"></a>
</h2>
<p>The <strong>ade4</strong> package provides other methods for the
analysis of an environmental table, but we are not going to detail them
here. Here is the list of the functions and the corresponding methods
(see the online documentation for more information on how to use them
and examples of application):</p>
<ul>
<li>
<code>dudi.fca</code>: Fuzzy Correspondence Analysis. Fuzzy
variables are a generalisation of categorical variables, where items
have a given probability of belonging to the categories of each fuzzy
variable.</li>
<li>
<code>dudi.fpca</code>: Fuzzy PCA (see above)</li>
<li>
<code>dudi.mix</code>: Mixed type Analysis. This is an alternative
to the <code>dudi.hillsmith</code> function.</li>
</ul>
<p>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
