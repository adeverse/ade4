<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysing Changes in Structures • ade4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysing Changes in Structures">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-24</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-new-to-ade-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">New to ade4?</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
<li><a class="dropdown-item" href="../articles/install.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/get_started.html">Getting started</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a></li>
    <li><a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a></li>
    <li><a class="dropdown-item" href="../articles/ChapKtables.html">Analysing Changes in Structures</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2Ktables.html">Analysing Changes in Co-structures</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/related.html">Related packages</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-ressources" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Ressources</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-ressources">
<li><a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/ade4shiny/">ade4shiny</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
    <li><a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a></li>
    <li><a class="dropdown-item" href="../articles/book.html">ade4 book</a></li>
    <li><a class="dropdown-item" href="../articles/papers.html">Papers</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en"><span class="fa fa-leaf"></span> LBBE</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adeverse/ade4"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Analysing Changes in Structures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adeverse/ade4/blob/master/vignettes/articles/ChapKtables.Rmd" class="external-link"><code>vignettes/articles/ChapKtables.Rmd</code></a></small>
      <div class="d-none name"><code>ChapKtables.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>This vignette is a short introduction to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
family of methods. We first present some examples of ecological
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table,
the structure of the <code>ktab</code> object used in the
<strong>ade4</strong> package to store a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table,
and the functions that allow to build and manage them. We briefly
present three types of methods: STATIS, Multiple Factor Analysis, and
Multiple Coinertia Analysis. We explain the differences between these
three groups of methods, with several examples of use.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When the set of samples (rows of a data table) is split into groups,
we have seen in vignette “Taking into account groups of sites” that
several data analysis methods can take into account these groups and
model their differences (Between-Class Analysis) or remove these
differences (Within-Class Analysis). Another approach consists in
considering that the groups correspond to separate tables, with
successive tables stacked vertically (see Figure, B). This leads to what
is called the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
structure.</p>
<p>The set of columns (environmental variables or species) can also be
split into groups, and this also leads to a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
structure. One can imagine that, in this case, tables are stacked
horizontally (see Figure, A).</p>
<img src="KtabData.png" width="600" height="212"><figcaption align="center"><p>Structures of data of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table.
(A) Several sets of variables measured on the same sites. (B) A set of
variables measured for different groups of sites. (C) An example of a
data cube with the measurements of the same variables for the same sites
repeated at different dates.</p>
</figcaption><p>The aim of analysing a set of tables instead of just one table is to
find out what makes these tables different, or conversely, to find
common points among all the tables. Are all the tables structured in the
same way ? Is the samples typology and the variables/species typology
the same across all the tables, or are there some changes from one table
to another ? These questions are particularly interesting when the
series of tables is a time series, with each table corresponding to one
date (see Figure, C). But the series of tables can also correspond to
other criteria, like taxonomic groups for species, or geographical
regions for samples.</p>
</div>
<div class="section level2">
<h2 id="k-table-management-in-ade4">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
management in <strong>ade4</strong><a class="anchor" aria-label="anchor" href="#k-table-management-in-ade4"></a>
</h2>
<div class="section level3">
<h3 id="k-table-examples">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
examples<a class="anchor" aria-label="anchor" href="#k-table-examples"></a>
</h3>
<p>Here are a few examples of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
data sets taken from <strong>ade4</strong> that correspond to the
different cases presented in the previous Figure. The
<code>friday87</code> data set (Friday 1987) contains one table
(<code>friday87$fau</code>) with 91 macro-invertebrate species sampled
in 16 ponds. The 91 species are grouped in 10 taxonomic groups:
Hemiptera, Odonata, Trichoptera, Ephemeroptera, Coleoptera, Diptera,
Hydracarina, Malacostraca, Mollusca, Oligochaeta. These species data can
be considered as a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
with 10 tables (one for each taxonomic group), each table having 16 rows
and a number of columns equal to the number of species in each group
(11, 7, 13, 4, 13, 22, 4, 3, 8, 6 respectively). This data set
corresponds to the case presented in case A of the previous Figure.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">$</span><span class="va">fau</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 16 91</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">friday87</span><span class="op">$</span><span class="va">fau.blo</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;     Hemiptera       Odonata   Trichoptera Ephemeroptera    Coleoptera </span></span>
<span><span class="co">#&gt;            11             7            13             4            13 </span></span>
<span><span class="co">#&gt;       Diptera   Hydracarina  Malacostraca      Mollusca   Oligochaeta </span></span>
<span><span class="co">#&gt;            22             4             3             8             6</span></span></code></pre>
<p>The second example belongs to the field of hydrobiology. In
<strong>ade4</strong>, the data set is called <code>jv73</code>, and it
comes from the PhD thesis of J. Verneaux (Verneaux, 1973. It is a list
with six components. The physico-chemistry table
(<code>jv73$phychi</code>) has 92 rows (92 sites located along 12
rivers) and 12 variables. A factor (<code>jv73$fac.riv</code>) gives the
name of the stream on which each site is located. This data set
corresponds to the case B presented in the previous Figure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">jv73</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">jv73</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "morpho"  "phychi"  "poi"     "xy"      "contour" "fac.riv" "Spatial"</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">jv73</span><span class="op">$</span><span class="va">phychi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 92 12</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">jv73</span><span class="op">$</span><span class="va">fac.riv</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Allaine    Audeux    Clauge  Cuisance  Cusancin Dessoubre     Doubs Doulonnes </span></span>
<span><span class="co">#&gt;         8         5         6         8         4         5        16         3 </span></span>
<span><span class="co">#&gt;   Drugeon  Furieuse     Lison      Loue </span></span>
<span><span class="co">#&gt;         6         9         5        17</span></span></code></pre>
<p>The third example comes from a paper by Blondel 1988 about the
influence of vegetation successions on bird communities composition in
European forests. The <code>bf88</code> data set in the
<strong>ade4</strong> package contains the number of birds of 79 species
observed in four regions (Burgundy, Provence, Corsica, Poland) along a
gradient of six stages of vegetation succession (from 1: “open, bushy
growth less than 1 m” to 6: “closed, forest with trees higher than 20
m”). Data are arranged in a list of six data frames, corresponding to
the six ecological stages, each data frame having 79 rows (bird species)
and four columns (the four regions). This data set corresponds to a data
cube as presented in case C of the Figure, with vegetation stages
instead of dates.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bf88</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bf88</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "S1" "S2" "S3" "S4" "S5" "S6"</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bf88</span><span class="op">$</span><span class="va">S1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 79  4</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="building-and-using-a-k-table">Building and using a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table<a class="anchor" aria-label="anchor" href="#building-and-using-a-k-table"></a>
</h3>
<p>In <strong>ade4</strong>, a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
is stored in an object of class <code>ktab</code>. A <code>ktab</code>
object is a list of data frames that share the same row names and the
following seven additional components:</p>
<ul>
<li>
<code>lw</code>: row weights, common to all the tables (vector)</li>
<li>
<code>cw</code>: column weights (vector)</li>
<li>
<code>blo</code>: number of columns of each table (vector)</li>
<li>
<code>TL</code>: index for rows (data frame: table number, row
number)</li>
<li>
<code>TC</code>: index for columns (data frame: table number, column
number)</li>
<li>
<code>T4</code>: index for 4 elements of an array (data frame: table
number, 1:4), mainly for internal use</li>
<li>
<code>call</code>: function call</li>
</ul>
<p>The tables must share the same row names and row weights. This means
that one can consider the tables of a <code>ktab</code> as stacked
horizontally. If the common dimension of the tables is the columns
(tables stacked vertically), they must be transposed to have their
common dimension as rows:</p>
<p><img src="KtabOrg.png" width="400" height="400"></p>
<figcaption align="center"><p>Organisation of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
in <strong>ade4</strong>. All the tables of a <code>ktab</code> must
have the same rows (they must share the same row names and row weights),
but their columns may be different (A). This is an arbitrary choice and
it does not mean that only tables with the same individuals and
different variables can be used. Indeed, tables having the same
variables but different individuals can be transposed to fit in this
scheme (B), while tables having the same individuals and different
variables can be used `as is’ (C). Of course data cubes with the same
rows and the same columns (e.g., three-way contingency tables) can also
fit (D). Note that tables that do not have at least one dimension (rows
or columns) in common cannot be analysed in the framework of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
methods.</p>
</figcaption><p>There are five functions to build a <code>ktab</code>. They differ by
the type of objects from which they start:</p>
<ul>
<li>
<code>ktab.list.df</code>: a list of data frames with the same rows.
This function is adapted for cases A and C. It can be used for case B if
data frames are firstly transposed.</li>
<li>
<code>ktab.list.dudi</code>: a list of <code>dudi</code> objects
with the same rows. This function is adapted for cases A and C. It can
be used for case B if <code>dudi</code> objects are firstly
transposed.</li>
<li>
<code>ktab.within</code>: an object created by a <code>wca</code>
analysis. This function is adapted for cases A and C.</li>
<li>
<code>ktab.data.frame</code>: a data frame that should be splitted
by columns and a vector indicating the number of columns in each table.
This function is adapted for cases B and C. It can be used for case A if
the data frame is firstly transposed.</li>
<li>
<code>ktab.match2ktabs</code>: a pair of <code>ktab</code> objects
with the same structure.</li>
</ul>
<p>Note that the transformation of the data table (e.g., centring and
standardisation) must be performed during the creation step of the
<code>ktab</code> object and that row and column weights must also be
set at this stage.</p>
<p>Some functions (<code>ktab.list.df</code>,
<code>ktab.data.frame</code>) allow to introduce any arbitrary data
transformation and row or column weights, while others
(<code>ktab.list.dudi</code>, <code>ktab.within</code>,
<code>ktab.match2ktabs</code>) use the data transformation and row and
column weights of a previous analysis of the data set.</p>
<p>In the example presented in the next Figure, the <code>scalewt</code>
function is used to standardise the data table and the
<code>ktab.list.df</code> function creates a standardised PCA
<code>ktab</code> object, with the default uniform row and column
weights.</p>
<p>In the next Figure, the <code>ktab.within</code> function uses the
<code>dudi</code> object created by the <code>withinpca</code> function
to perform a “Bouroche transformation” where the <code>ktab</code>
object can be partially standardised (standardisation of each table
separately) or totally standardised (centring of each table separately
and global standardisation).</p>
<p>Several other functions can then be used to manage <code>ktab</code>
objects:</p>
<ul>
<li>
<code>c</code>: concatenates several <code>ktab</code> objects
sharing the same rows</li>
<li>
<code>[]</code>: selects tables, rows and/or columns in a
<code>ktab</code>
</li>
<li>
<code>is.ktab</code>: tests if its argument is a
<code>ktab</code>
</li>
<li>
<code>t</code>: transposes all the tables of a <code>ktab</code>
(tables must have the same column names and weights)</li>
<li>
<code>row.names</code>: returns or modifies the vector of row names
shared by all the tables</li>
<li>
<code>col.names</code>: returns or modifies the vector of column
names</li>
<li>
<code>tab.names</code>: returns or modifies the vector of table
names</li>
<li>
<code>ktab.util.names</code>: automatically builds unique row,
column and tab names</li>
</ul>
</div>
<div class="section level3">
<h3 id="separate-analyses-of-a-k-table">Separate analyses of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table<a class="anchor" aria-label="anchor" href="#separate-analyses-of-a-k-table"></a>
</h3>
<p>The simplest way to use a <code>ktab</code> is to do the separate
analysis of each table. This can be done automatically for all the
tables of a <code>ktab</code> using the <code>sepan</code> function. The
exact analysis that is performed depends on the data transformation and
on the row and column weights. For example, if a table of quantitative
variables is centred and standardised with uniform row and column
weights, then the separate analyses are standardised PCAs.</p>
<p>As an example, we can use again the <code>meaudret</code> data set
(Pegaz, 1980) that we have already seen in previous vignettes. We
compute the PCA of environmental variables measured in the five sampling
sites, but separately for each season with the
<code>sepan</code>function. The table of environmental variables
<code>meaudret$env</code> is first centred and standardised for each
season, using the <code>by</code> and <code>scalewt</code> functions and
the <code>meaudret$design$season</code> factor. The <code>by</code>
function returns a list of matrices that must be turned into data frames
before they can be used in the <code>ktab.list.df</code> function. The
<code>ktab</code> object <code>ktam</code> is built and the
<code>sepan</code> function is used to perform a PCA on each table. The
<code>kplot</code> function can then be used to plot the four separate
biplots (see the following Figure).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meaudret</span><span class="op">)</span></span>
<span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span><span class="va">meaudret</span><span class="op">$</span><span class="va">env</span>, <span class="va">meaudret</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span>, <span class="va">scalewt</span><span class="op">)</span></span>
<span><span class="va">ktam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktab.list.df.html">ktab.list.df</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">env</span>, <span class="va">as.data.frame</span><span class="op">)</span>,</span>
<span>    rownames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sep1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sepan.html">sepan</a></span><span class="op">(</span><span class="va">ktam</span><span class="op">)</span></span>
<span><span class="va">kp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kplot.html">kplot</a></span><span class="op">(</span><span class="va">sep1</span>, posieig <span class="op">=</span> <span class="st">"none"</span>, psub.cex <span class="op">=</span> <span class="fl">0</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.traject.html">s.traject</a></span><span class="op">(</span><span class="va">sep1</span><span class="op">$</span><span class="va">Li</span>, facets <span class="op">=</span> <span class="va">sep1</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, plabels.cex <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"red"</span>, psub.cex <span class="op">=</span> <span class="fl">2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/superpose.html" class="external-link">superpose</a></span><span class="op">(</span><span class="va">kp1</span>, <span class="va">tr1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapKtables_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="600" height="600"></p>
<figcaption align="center"><p>Plot of the four separate PCA (one for each season) of the
<code>meaudret</code> data set. Physico-chemical variables are
represented by their labels with arrows from the origin, and the five
sites (<code>S1</code> to <code>S5</code>) are linked by
upstream-downstream red arrows.</p>
</figcaption><p>We can see that the same structure is reproduced during each season,
with the first principal component representing a pollution gradient
(highly polluted sites on the left) and the second one showing the
upstream-downstream morphological gradient (Flow, Temperature).</p>
<p>The problem with this Figure is that each analysis has been computed
independently from the three others. This means that they are not at the
same scale, they cannot be superimposed or even compared. Indeed nothing
guarantees that one axis in one figure will correspond to the same
structure in another figure. Axes can be inverted, or even be completely
different.</p>
<p>We need a way to have these four figures at the same scale and in the
same space and this is the objective of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
methods.</p>
</div>
</div>
<div class="section level2">
<h2 id="strategies-of-k-table-methods">Strategies of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
methods<a class="anchor" aria-label="anchor" href="#strategies-of-k-table-methods"></a>
</h2>
<p>According to the structure of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
and the type of data, different methods can be used:</p>
<ul>
<li>
<strong>Partial Triadic Analysis</strong> is restrictred to data
cubes where all tables have the same individuals and variables</li>
<li>
<strong>Foucart COA</strong> is restrictred to three-ways
contingency tables (i.e., data cubes with counts where rows and columns
correspond to categories)</li>
<li>
<strong>STATIS on operators</strong> allows to deal with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-tables
with at least the same individuals (STATIS on WD) or at least the same
variables (STATIS on VQ)</li>
<li>
<strong>Multiple Factor Analysis</strong> is restricted to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-tables
with at least the same individuals</li>
<li>
<strong>Multiple Coinertia Analysis</strong> is originally
restricted to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-tables
with at least the same individuals but can be applied on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-tables
with at least the same variables if they have been firstly
transposed.</li>
</ul>
<p>The first two methods are also named “STATIS on tables”. Both “STATIS
on tables” and “STATIS on operators” methods share many similarities.
All these methods can be decomposed in three steps, called the
Interstructure, the Compromise and the Intrastructure (Lavit 1988, Lavit
1994). The Interstructure uses the RV coefficients to compute a matrix
of scalar products between the tables that measures their relationships.
When all the tables have both the same rows and columns, STATIS, and the
associated computation of the RV coefficient, is performed directly on
tables. Two analyses have been developed in this case: Partial Triadic
Analysis (Thioulouse 1987) and Foucart Correspondence Analysis (Foucart
1978, Pavoine 2007).</p>
<p>When the tables have only one common dimension (rows or columns), the
analysis, including the computation of RV coefficients, is performed on
Escoufier operators (Escoufier 1973). In this framework, the RV
coefficient is a multivariate generalisation of the squared correlation
coefficient that allows to measure the link between two tables with only
one common dimension (rows or columns). It is used for example in
Coinertia Analysis. The case where the rows (sites or samples) are
common to all the tables is called STATIS-WD, while the case where the
columns (variables or species) are in common is called STATIS-VQ.</p>
<p>Then, the Compromise is computed as a combination of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables, and the Intrastructure projects the elements (rows and columns)
of each table onto the analysis of the Compromise. This approach gave
rise to many generalisations (see for example Abdi 2012).</p>
</div>
<div class="section level2">
<h2 id="partial-triadic-analysis">Partial Triadic Analysis<a class="anchor" aria-label="anchor" href="#partial-triadic-analysis"></a>
</h2>
<p>The theoretical background of Triadic Analysis was established in the
PhD thesis of Jaffrenou, 1978. He showed that it was in fact equivalent
to Tucker’s Three Mode Factor Analysis (Tucker, 1966). An application of
a particular case (called “Partial Triadic Analysis”) to ecological
situations was published by Thioulouse, 1987. The extension to the
complete case (“Complete Triadic Analysis”) was then explained by
Kroonenberg 1989, in the framework of Three-mode Principal Component
Analysis (Kronenberg, 1983).</p>
<p>The main characteristic of PTA is its simplicity: computations can be
done with a simple PCA software, and interpretations are usually easy.
One drawback is the constraint on the number of samples and variables
that have to be the same for all the tables. Several recent examples of
application can be found in hydrobiology (Rolland 2009, Bertrand 2010,
Mendes 2010, Slimani 2017).</p>
<p>In the <strong>ade4</strong> package, a PTA can be computed using the
<code>pta</code> function. All the outputs are grouped in a
<code>dudi</code> object (subclass <code>pta</code>).</p>
<p>The results on the <code>meaudret</code> data set are shown in the
next Figure. The first step uses the <code>withinpca</code> function to
compute a within-class PCA, with the Bouroche “Partial” standardisation
(Bouroche, 1975). This means that, after a global centring and
standardisation, variables are standardised separately within each
table. Variables have therefore a null mean and unit variance in each
table. The <code>ktab</code> object <code>kta1</code> is then built with
the <code>ktab.within</code> function and the same column names are
given to the four tables. The <code>ktab</code> is then transposed to
have variables in columns, and the PTA is computed with the
<code>pta</code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/withinpca.html">withinpca</a></span><span class="op">(</span><span class="va">meaudret</span><span class="op">$</span><span class="va">env</span>, <span class="va">meaudret</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">season</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, scaling <span class="op">=</span> <span class="st">"partial"</span><span class="op">)</span></span>
<span><span class="va">kta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktab.within.html">ktab.within</a></span><span class="op">(</span><span class="va">wit1</span>, colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span>, <span class="st">"S5"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pta.html">pta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">kta1</span><span class="op">)</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pta1</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Plot of the PTA of the <code>meaudret</code> data set (Interstructure
and Compromise steps).</p>
</figcaption><p>The <code>plot</code> function draws the final Figure. The
Interstructure graph (top-left) shows that the winter table structure is
different from the structure of the three other seasons. The two graphs
of the Compromise (Rows = sites plot and Columns = variables plot) show
the pollution gradient on the first axis and the upstream-downstream
morphology gradient on the second. The <code>Typological value</code>
graph (bottom-right) gives the importance of each table in the
Compromise and shows that winter contributes less than the other seasons
to the Compromise structure.</p>
<p>The <code>kplot</code> function can then be used to draw the
Intrastructure graphs. This figure displays the projection of the rows
and columns of the four tables and of the principal axes and components
of the four PCA. It shows how the structure of each table (or its
principal axes) differs from the structures of the others but
interpretation is easier.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kplot.html">kplot</a></span><span class="op">(</span><span class="va">pta1</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Plot of the PTA of the <code>meaudret</code> data set (Intrastructure
step). The first column of graphs shows the projection of the principal
axes of the PCA of each table into the PTA. The second column shows the
factor map of sites. The third column shows the factor map of
physico-chemical variables. The fourth column shows the projection of
the principal components of the PCA of each table into the PTA.</p>
</figcaption><p>The next Figure is the same type of display as the figure of the
<code>sepan</code> analysis (one graph for each season), but it uses the
coordinates of the Intrastructure step of the PTA. Compared to the
<code>sepan</code> analysis Figure, the graphs of the four seasons are
now at the same scale and can be superimposed and compared. All the
points are in the same space, so the two axes have the same meaning in
all the graphs. In the present case, the interpretation is not changed,
because the structures are very strong and the four separate PCA had
already given the same picture. But in the case where structures are
weaker, or when they are more different across tables, using a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
approach could help get a better idea of the global structure, and how
it is distorted in each table.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ar1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">pta1</span><span class="op">$</span><span class="va">Tco</span> <span class="op">*</span> <span class="fl">3</span>, facets <span class="op">=</span> <span class="va">pta1</span><span class="op">$</span><span class="va">TC</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, psub.cex <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    labels <span class="op">=</span> <span class="va">pta1</span><span class="op">$</span><span class="va">TC</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.traject.html">s.traject</a></span><span class="op">(</span><span class="va">pta1</span><span class="op">$</span><span class="va">Tli</span>, facets <span class="op">=</span> <span class="va">pta1</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, plabels.cex <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    psub.cex <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">la1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">pta1</span><span class="op">$</span><span class="va">Tli</span>, facets <span class="op">=</span> <span class="va">pta1</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, psub.cex <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    labels <span class="op">=</span> <span class="va">pta1</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/superpose.html" class="external-link">superpose</a></span><span class="op">(</span><span class="va">tr1</span>, <span class="va">la1</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/superpose.html" class="external-link">superpose</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">ar1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Plot of the PTA of the <code>meaudret</code> data set (Intrastructure
step) split by season.</p>
</figcaption>
</div>
<div class="section level2">
<h2 id="foucart-coa">Foucart COA<a class="anchor" aria-label="anchor" href="#foucart-coa"></a>
</h2>
<p>The aim of Foucart COA is to coordinate the Correspondence Analyses
of a series of contingency tables crossing the same two variables
(Pavoine, 2007). Because of the properties of contingency tables,
Foucart COA is even simpler than PTA, both from a theoretical point of
view and for the implementation in <strong>ade4</strong>. Indeed, the
Compromise table is simply the mean of the frequencies of all the
contingency tables, and the <code>foucart</code> function in
<strong>ade4</strong> simply takes a list of data frames as argument
instead of a <code>ktab</code>.</p>
<p>In the <strong>ade4</strong> package, the <code>foucart</code>
function is used to compute a Foucart COA and all the outputs of this
function are grouped in a <code>foucart</code> object.</p>
<p>The <code>bf88</code> data set can be used to illustrate this
method:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fou1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foucart.html">foucart</a></span><span class="op">(</span><span class="va">bf88</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fou1</span>, psub.cex <span class="op">=</span> <span class="fl">2</span>, col.plabels.col <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    colB.plabels.col <span class="op">=</span> <span class="st">"red"</span>, rowB.plabels.optim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Plot of the Foucart COA of the <code>bf88</code> data set.</p>
</figcaption><p>This Figure is a summary of the Common structure and of the
Intrastructure of this analysis. The two graphs on the top of the figure
are the row and column graphs of the Common structure (mean of the
contingency tables). They show the list of bird species (left) and the
four regions (right).</p>
<p>The bottom two graphs show the Intrastructure, <em>i.e.</em>, the
projections of the rows and columns of the six contingency tables into
the analysis of the Common structure. They display the projection of the
79 bird species (left) and of the four regions (right) for the six
stages of vegetation succession.</p>
<p>The <code>kplot</code> function can be used to draw the next Figure.
This is also a display of the Intrastructure, but here the six stages of
vegetation succession are split in six separate graphs (S1 to S6). The
79 bird species and the four regions are displayed in each graph,
showing the changes in bird species composition and relative region
positions changes along the vegetation gradient.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kplot.html">kplot</a></span><span class="op">(</span><span class="va">fou1</span>, col.plabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="va">fou1</span><span class="op">$</span><span class="va">TC</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, row.plabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    label <span class="op">=</span> <span class="va">fou1</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, plabels.boxes.draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>    psub.cex <span class="op">=</span> <span class="fl">3</span>, pgrid.text.cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" width="600" height="400"><figcaption align="center"><p><code>kplot</code> of the Foucart COA of the <code>bf88</code> data
set.</p>
</figcaption><p>The final interpretation is made easier on the next Figure, where
only the coordinates of the four regions in the Intrastructure is kept.
Grey level polygons are used to show the between-regions variability of
bird species composition along the gradient of vegetation succession.
This variability is high in the first three stages (1-3, light grey
polygons), and low in the last three (4-6, dark grey polygons). This
corresponds to the bird species composition convergence in forest
environments.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.class.html">s.class</a></span><span class="op">(</span><span class="va">fou1</span><span class="op">$</span><span class="va">Tco</span>, <span class="va">fou1</span><span class="op">$</span><span class="va">TC</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, ppolygons.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">0</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>    chullSize <span class="op">=</span> <span class="fl">1</span>, starSize <span class="op">=</span> <span class="fl">0</span>, ellipseSize <span class="op">=</span> <span class="fl">0</span>, plabels.cex <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    plegend.drawKey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">fou1</span><span class="op">$</span><span class="va">Tco</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Interpretation of Foucart COA of the <code>bf88</code> data set.</p>
</figcaption>
</div>
<div class="section level2">
<h2 id="statis-on-operators">STATIS on operators<a class="anchor" aria-label="anchor" href="#statis-on-operators"></a>
</h2>
<p>When the tables of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
have only one dimension in common, the STATIS method uses the Escoufier
operators to compare the tables.</p>
<p>Two cases are usually considered: (i) the tables of the series have
the same columns (variables) or (ii) the same rows (individuals or
samples). If tables have different rows different columns, then none of
these methods can be used.</p>
<p>When variables are identical across all the tables, then STATIS
compares covariance matrices (VQ) and analyses similarities between
variables. This is called the “STATIS on VQ” strategy.</p>
<p>The “STATIS on WD” strategy is used when the tables have the same
rows. It compares matrices of scalar products between individuals (WD),
and analyses similarities between individuals.</p>
<p>In the <strong>ade4</strong> package, these differences are not
considered and the <code>statis</code> function can be used to analyse
both situations. The drawback is that the <code>ktab</code> object must
take this into account. In all cases, the rows of all the tables must be
identical, and the <code>ktab</code> must be prepared accordingly. If
variables are the same for all the tables and individuals differ (STATIS
on VQ), then the tables must be transposed to have the common dimension
in rows.</p>
<p>All the outputs of the <code>statis</code> function are grouped in a
<code>statis</code> object.</p>
<p>In the <code>friday87</code> data set, the <code>fau</code> data
frame containing 91 species grouped in 10 taxa, and one table of
environmental variables (<code>mil</code>) make up 11 tables with the
same rows (16 ponds). The fauna and the environmental data frames are
bound together into the <code>w1</code> data frame with the
<code>cbind.data.frame</code> function. The species are centred, and the
environmental variables are standardised. The <code>kta1</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
is then built with the <code>ktab.data.frame</code> function:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/scalewt.html">scalewt</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">$</span><span class="va">fau</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/scalewt.html">scalewt</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">$</span><span class="va">mil</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">kta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktab.data.frame.html">ktab.data.frame</a></span><span class="op">(</span><span class="va">w1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">$</span><span class="va">fau.blo</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>    tabnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">$</span><span class="va">tab.names</span>, <span class="st">"Environment"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sep1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sepan.html">sepan</a></span><span class="op">(</span><span class="va">kta1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sep1</span>, psub.cex <span class="op">=</span> <span class="fl">2</span>, paxes.draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" width="800" height="600"><figcaption align="center"><p>Eigenvalues of the separate analyses of the <code>friday87</code>
data set.</p>
</figcaption><p>This Figure shows the eigenvalues barcharts of the 11 separate
analyses (one for each table). STATIS measures the importance of a table
by the sum of the squared eigenvalues, instead of the sum of eigenvalues
as it is the case in one-table analyses. This change from the sum (mean)
to the sum of squares (variance) is equivalent to the change from
abundance to diversity.</p>
<p>The taxa that have the highest importance from this point of view are
Diptera, Trichoptera, Mollusca and Ephemeroptera (on two axes). It is
interesting to notice that this importance is not related to the
richness of taxonomic groups, but to the strength of their
structure.</p>
<p>The STATIS analysis is computed with the <code>statis</code>
function, and the results are displayed according to the three steps of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
analyses: Interstructure, Compromise and Intrastructure.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statis1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/statis.html">statis</a></span><span class="op">(</span><span class="va">kta1</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>In the Interstructure step, the matrix of RV coefficients between
operators is diagonalized, and the resulting eigenvalues can be found in
<code>statis1$RV.eig</code>. This gives the eigenvalues barchart. The
components of the first eigenvector are then used as weights in a linear
combination of initial operators. This linear combination is called the
Compromise, and the corresponding weights can be found in
<code>statis1$RV.tabw</code>.</p>
<p>The correlation circle of the Interstructure can be drawn with the
coordinates found in <code>statis1$RV.coo</code>. This figure shows the
importance (<code>Typological value</code>) of each table in the
Compromise study. Here, we can see that the structure is not very
coherent among tables, and that the environment will not be able to
explain the distribution of all taxa. The environmental variables seem
to be better related to Oligocheta than to Mollusca, Coleoptera, and
Hydracarina.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plotEig.html" class="external-link">plotEig</a></span><span class="op">(</span><span class="va">statis1</span><span class="op">$</span><span class="va">RV.eig</span>, yax <span class="op">=</span> <span class="fl">1</span>, nf <span class="op">=</span> <span class="fl">1</span>, pbackground.box <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    psub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Eigenvalues"</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span> , plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">statis1</span><span class="op">$</span><span class="va">RV.coo</span>, pbackground.box <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">cs2</span>, <span class="va">bc2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.55</span>, <span class="fl">0.45</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" width="400" height="400"><figcaption align="center"><p>STATIS analysis of the <code>friday87</code> data set: eigenvalues
barchart and correlation circle of the Interstructure.</p>
</figcaption><p>The analysis of the Compromise gives a second eigenvalues barchart
with two prominent eigenvalues. These values can be found in
<code>statis1$C.eig</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bcC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plotEig.html" class="external-link">plotEig</a></span><span class="op">(</span><span class="va">statis1</span><span class="op">$</span><span class="va">C.eig</span>, yax <span class="op">=</span> <span class="fl">2</span>, nf <span class="op">=</span> <span class="fl">2</span>, pbackground.box <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    psub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Eigenvalues"</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">slC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">statis1</span><span class="op">$</span><span class="va">C.li</span>, plabels.cex <span class="op">=</span> <span class="fl">1.5</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ccC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">statis1</span><span class="op">$</span><span class="va">C.Co</span><span class="op">[</span><span class="va">statis1</span><span class="op">$</span><span class="va">TC</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Environment"</span>, <span class="op">]</span>,</span>
<span>    pbackground.box <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">slC</span>, <span class="va">ccC</span>, <span class="va">bcC</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0</span>, <span class="fl">0.65</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-15-1.png" class="r-plt" width="800" height="400"><figcaption align="center"><p>Compromise of the STATIS analysis of the <code>friday87</code> data
set: eigenvalues barchart (middle), ponds factor map (left), and
environmental variables (right).</p>
</figcaption><p>The factor map of the Compromise for the 16 ponds (left) is drawn
using the coordinates in <code>statis1$C.li</code>. The structure
observed on this figure corresponds to a differential distribution of
several taxa in some ponds: Trichoptera, Ephemeroptera, Hydracarina,
Malacostraca, Mollusca and Oligochaeta are mostly absent from ponds on
the left (ponds R, E, J, P, Q).</p>
<p>The factor map of the Compromise for variables (species and
environmental parameters) can be drawn with the column coordinates (in
<code>statis1$C.co</code>). The Figure shows the environmental variables
(right). Pond size (area and depth) and water pH are the two main
factors that explain the variations in species distributions. Large
ponds tend to be in the top part of the graph, while ponds with high pH
and hardness tend to be on the right.</p>
<p>This structure can be seen directly in the data. The next figure
displays the distribution of the 91 species in the 16 ponds. It is drawn
with the <code>s.distri</code> function and the following code, that
builds a new <code>ktab</code> object <code>kta2</code>, containing only
the species data (excluding the environmental variables table).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kta2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ktab.data.frame.html">ktab.data.frame</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">$</span><span class="va">fau</span>, <span class="va">friday87</span><span class="op">$</span><span class="va">fau.blo</span><span class="op">)</span></span>
<span><span class="va">glc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">friday87</span><span class="op">$</span><span class="va">fau.blo</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">glc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">glc</span>, <span class="fu"><a href="../reference/s.distri.html">s.distri</a></span><span class="op">(</span><span class="va">statis1</span><span class="op">$</span><span class="va">C.li</span>, <span class="va">kta2</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          plot <span class="op">=</span> <span class="cn">FALSE</span>, storeData <span class="op">=</span> <span class="cn">TRUE</span>, starSize <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>          ellipseSize <span class="op">=</span> <span class="fl">0</span>, pellipses.axes.draw <span class="op">=</span> <span class="cn">FALSE</span>,    </span>
<span>          psub.cex <span class="op">=</span> <span class="fl">2</span>, psub.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kta2</span><span class="op">)</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          pgrid.text.cex <span class="op">=</span> <span class="fl">2</span>, plabels.cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="va">glc</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" width="800" height="600"><figcaption align="center"><p>Distribution of the abundance of the 91 species in the 16 ponds.</p>
</figcaption><p>The <code>for</code> loop operates on the 10 tables of the
<code>ktab</code> (the 10 species groups), drawing one graph for each
group. The resulting 10 graphs are collected in the <code>glc</code>
list, and plotted with the <code>ADEgS</code> function of the
<strong>adegraphics</strong> package.</p>
<p>There is one star for each species, with branches that connect the
gravity center of the species to the ponds where it is present. Species
are grouped by taxa, and it is easy to see that, for example,
Ephemeroptera are present only in ponds on the right (ponds with high
pH).</p>
<p>The factor map of the Compromise for columns can be drawn
automatically using the <code>kplot</code> function, and the
<code>plot</code> function can be used to draw the synthetic graph of a
<code>statis</code> object.</p>
<p>The <code>kplot</code> function draws a figure that has the same
organisation as the graph of species distributions, with one graph for
each species group. In each group (<em>e.g.</em>, Hemiptera), each
species is represented by an arrow with a label giving the species code.
This figure also corresponds to the plot of ponds (Compromise analysis),
and shows which species is more abundant (or which environmental
variable is higher) in each pond.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kplot.html">kplot</a></span><span class="op">(</span><span class="va">statis1</span>, plabels.cex <span class="op">=</span> <span class="fl">1.5</span>, psub.cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" width="800" height="600"><figcaption align="center"><p>Columns Compromise plot of the STATIS analysis.</p>
</figcaption><p>The generic plot of the STATIS analysis (<code>plot</code> function)
is a collection made of the Interstructure plot (top-left), the rows
(ponds) Compromise plot (top-right), the <code>Typological value</code>
plot (bottom-left), and the component projection plot (bottom-right).
The <code>Typological value</code> plot gives the importance of each
table in the analysis, and the component projection plot shows the
projection of the first principal vector of each table on the Compromise
factor map.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">statis1</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Generic plot of the <code>statis</code> analysis of the
<code>friday87</code> data set.</p>
</figcaption>
</div>
<div class="section level2">
<h2 id="multiple-factor-analysis">Multiple Factor Analysis<a class="anchor" aria-label="anchor" href="#multiple-factor-analysis"></a>
</h2>
<p>Multiple Factor Analysis (Escofier 1994) was developed by B. Escofier
and J. Pages in the early eighties (INRIA internal research reports).
The aim of MFA is to analyse <em>K</em> groups of variables measured on
the same individuals. Many variants and extensions have been defined in
other situations, like for example tables with mixed quantitative and
qualitative variables, variables arranged in a hierarchy, or dual MFA
(groups of individuals instead of groups of variables).</p>
<p>Row weights are equal to the row weights of separate tables, and
column weights are equal to the concatenated column weights of separate
tables. Each table is multiplied by a weight that decreases the
importance of large tables and increases the one of small tables.</p>
<p>In <strong>ade4</strong>, the <code>mfa</code> function is used to
compute a MFA. All the outputs of this function are grouped in a
<code>mfa</code> object.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">afm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mfa.html">mfa</a></span><span class="op">(</span><span class="va">kta1</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">afm1</span>, comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plabels.boxes.draw <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    psub.position <span class="op">=</span> <span class="st">"topright"</span><span class="op">)</span>, pgrid.text.pos <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-19-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Generic plot of the Multiple Factor Analysis of the
<code>friday87</code> data set.</p>
</figcaption><p>This Figure shows the results of MFA on the <code>friday87</code>
data set. The eigenvalues barchart is very similar to the eigenvalues
barchart of the STATIS Compromise. The rows and columns coordinates are
used to draw the top two graphs (<code>Rows</code> = Rows projection and
<code>Columns</code> = Columns projection). The lower left graph
(<code>Components (separate analyses)</code>) shows the projection of
the principal components of each table into the factor map of MFA. The
result is very similar to the same graph in the STATIS analysis. The
lower right graph (<code>Link</code>) displays the link between each
table and the Reference Structure. It shows for example that the
environmental variables table (<code>Environment</code>) has no
influence on the second component of the MFA, as opposed to the
Hemiptera table (<code>Hemiptera</code>).</p>
<p>The factor map of the rows (ponds) is displayed in the next Figure.
Although computations are completely different, it is also very similar
to the Compromise plot of STATIS.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">afm1</span><span class="op">$</span><span class="va">li</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-20-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Plot of the 16 ponds in the MFA of the <code>friday87</code> data
set.</p>
</figcaption><p>It is possible to draw a map of sites (ponds) for each table (taxa),
in the same way as in STATIS trajectories. The coordinates of the rows
of each table are in <code>afm1$lisup</code>. These coordinates can be
used to draw a simultaneous display of ponds and taxa, either with taxa
grouped by pond (first Figure), or with species split by taxa (second
Figure). The first figure underlines the coherence of species
composition within each pond, while the second one allows to compare the
distribution of species in the ponds for each taxon.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/s.class.html">s.class</a></span><span class="op">(</span><span class="va">afm1</span><span class="op">$</span><span class="va">lisup</span>, <span class="va">afm1</span><span class="op">$</span><span class="va">TL</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">afm1</span><span class="op">$</span><span class="va">tab</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-21-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Plot of the 16 ponds for the eleven taxa in the MFA of
<code>friday87</code> data.</p>
</figcaption><p>In the first Figure, the coordinates of the rows (ponds) for all the
tables (taxa) are grouped by pond. A star and an ellipse are drawn for
each pond. For example, for pond N (on the right), the 11 branches of
the star link the position of pond N for the eleven tables to their
gravity center. The ellipse is just a graphical summary of the means,
variances and the covariance of the 11 coordinates of the pond. This
figure shows that the species composition of ponds can be very
different, some ponds sheltering particular taxa.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kplot.html">kplot</a></span><span class="op">(</span><span class="va">afm1</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-22-1.png" class="r-plt" width="800" height="600"><figcaption align="center"><p>Plot of the 16 ponds for the eleven taxa in the Multiple Factor
Analysis of the <code>friday87</code> data set. The coordinates of
species are split by taxon (plus the set of environmental
variables).</p>
</figcaption><p>In the second Figure, the same coordinates (<code>afm1$lisup</code>,
black dots) are used, but they are superimposed to the coordinates of
species (<code>afm1$co</code>, arrows), and the resulting plot is split
by taxa (one graph for each taxon, plus the graph for environmental
variables). This figure can be used to compare the distribution of
species among the ponds, and it shows very clearly that some taxa prefer
particular ponds.</p>
</div>
<div class="section level2">
<h2 id="multiple-coinertia-analysis">Multiple Coinertia Analysis<a class="anchor" aria-label="anchor" href="#multiple-coinertia-analysis"></a>
</h2>
<p>One table can be seen as a cloud of variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℝ</mi><mi>n</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^n</annotation></semantics></math>,
and as a cloud of samples in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ℝ</mi><mi>p</mi></msup><annotation encoding="application/x-tex">\mathbb{R}^p</annotation></semantics></math>.
In the same way,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables can be seen as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
clouds of variables <em>in the same space</em>. This is the point of
view of MFA.</p>
<img src="Fig-KClouds.png" width="750" height="600"><figcaption align="center"><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables can be seen as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
clouds of variables in the same sample space (MFA point of view).</p>
</figcaption><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables also give
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
inertia operators and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
clouds of samples (or variables) : this is the STATIS point of view.</p>
<p>But
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables can also be seen as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
clouds of samples , and this is the point of view of Multiple Coinertia
Analysis.</p>
<p>The successive steps of MCOA can be summed up as follows:</p>
<ul>
<li>start from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables with the same rows;</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
clouds of points (samples) in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
Euclidean spaces. These points are equally weighted in all the clouds.
In each space, we look for a normed vector (axis) on which the cloud of
points is projected;</li>
<li>a unit variance reference code is defined;</li>
<li>axes and reference code optimise the weighted sum of squared
covariances between the reference code and the coordinates of each
projection. Iterate under orthogonality constraint on axes and
codes.</li>
</ul>
<img src="Fig-KClouds2.png" width="750" height="600"><figcaption align="center"><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables can be seen as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
clouds of samples in different variable spaces (MCOA point of view).</p>
</figcaption><p>MCOA is therefore, axis by axis, the inertia analysis of each table
with matched coordinates using synthesis variables (Chessel 1996). The
first coordinate is directly given by the first component of MFA.
Further ones are more precise from the point of view of the geometry of
clouds, but the optimality of the variables representation is lost.</p>
<p>In <strong>ade4</strong>, MCOA is computed using the
<code>mcoa</code> function:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcoa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcoa.html">mcoa</a></span><span class="op">(</span><span class="va">kta1</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The plot of MCOA is nearly identical to the plot of MFA, except for
an inversion of the second axis.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mcoa1</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-24-1.png" class="r-plt" width="600" height="600"><figcaption align="center"><p>Generic plot of the Multiple Coinertia Analysis of the
<code>friday87</code> data set.</p>
</figcaption><p>The <code>kplot</code> of MCOA compares the projection of the cloud
of points in each space with the synthetic typology (called
<code>Reference</code> here). This strategy can be very useful to link a
faunistic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
to an environmental variables table (Concordance Analysis).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kplot.html">kplot</a></span><span class="op">(</span><span class="va">mcoa1</span><span class="op">)</span></span></code></pre></div>
<img src="ChapKtables_files/figure-html/unnamed-chunk-25-1.png" class="r-plt" width="600" height="800"><figcaption align="center"><p><code>kplot</code> of the Multiple Coinertia Analysis of the
<code>friday87</code> data set.</p>
</figcaption>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
data analysis methods that have been broached in this chapter belong to
three families: STATIS, MFA and MCOA. When all the tables of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
have the same individuals and the same variables, the “STATIS on tables”
strategy can be used, with for example the PTA and Foucart COA methods.
When the tables have only one dimension in common, then the STATIS on WD
(same individuals) and STATIS on VQ (same variables) can be used.</p>
<p>When the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
have the same individuals, MFA provides a point of view oriented to the
interpretation of the relationships between the variables, with many
possible generalisations.</p>
<p>Lastly, MCOA is a generalisation of Coinertia Analysis. In this
example of application, it was used to analyse a -table including ten
faunistic tables and an environmental table. However, in this context,
Concordance Analysis (Lafosse 1997, Bady 2004), a generalisation of MCOA
to the analysis of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K+1</annotation></semantics></math>
tables, could be preferred as it considers explicitly the environmental
table as a reference table to ordinate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
faunistic tables. Unfortunately, this method is not yet implemented in
<strong>ade4</strong>.</p>
<p>Two other
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">K+1</annotation></semantics></math>
methods are available in <strong>ade4</strong>: Multiblock Partial Least
Square (PLS) and Multiblock PCAIV. These two regression-based methods
are able to analyse the effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
explanatory tables on a response table. They are implemented in the
<code>mbpls</code> and <code>mbpcaiv</code> functions (Dray 2019).</p>
<p>Tha last Figure shows the main
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
data analysis methods available in the <strong>ade4</strong> package.
The <code>ktab</code> class allows to handle all these methods in the
same way and using the same utility functions. The same
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
object can thus be analysed using STATIS, MFA and MCOA and the results
of the three methods can be compared easily.</p>
<img src="KtabConcl.png" width="600" height="600"><figcaption align="center"><p>The main
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-table
data analysis methods available in the <strong>ade4</strong>
package.</p>
</figcaption><p>Two methods are particularly simple and easy to use:</p>
<ul>
<li>Partial Triadic Analysis, for series of tables having the same rows
and the same columns,</li>
<li>Multiple Factor Analysis, for tables having the same rows and
different sets of variables.</li>
</ul>
<p>The use of the RV coefficient is fundamental for coupling two tables.
Its generalisation to the simultaneous analysis of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
tables is the basis of the methods that have been described in this
chapter. The analysis of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math><em>pairs of tables</em> (see vignette “Analysing Changes in
Co-structures”) is also based of this concept.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
