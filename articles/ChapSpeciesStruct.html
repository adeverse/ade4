<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ade4">
<title>Description of species structures • ade4</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Description of species structures">
<meta property="og:description" content="ade4">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-22</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-new-to-ade-">New to ade4?</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
    <a class="dropdown-item" href="../articles/install.html">Installation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Getting started</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a>
    <a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a>
    <a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/related.html">Related packages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-ressources">Ressources</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-ressources">
    <a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/Reproducible_Research/ShinyADE4/">ade4 shinyapps</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a>
    <a class="dropdown-item" href="../articles/book.html">ade4 book</a>
    <a class="dropdown-item" href="../articles/papers.html">Papers</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en">
    <span class="fa fa-leaf"></span>
     
    LBBE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sdray/ade4">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Description of species structures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sdray/ade4/blob/HEAD/vignettes/articles/ChapSpeciesStruct.Rmd" class="external-link"><code>vignettes/articles/ChapSpeciesStruct.Rmd</code></a></small>
      <div class="d-none name"><code>ChapSpeciesStruct.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>Several simple data analysis methods can be used to analyse species
data tables, i.e., tables having sites as rows and species as columns.
Like in the previous vignette, simple means that these methods are
adapted to the analysis of only one table. Three particular data
analysis methods will be studied here: Correspondence Analysis (CA),
centred Principal Component Analysis (cPCA), and Principal Coordinate
Analysis (PCoA).</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Community ecology aims to study patterns and processes underlying the
coexistence of individuals of different species (species assemblage). To
achieve this goal, field works are performed to describe several sites
by their species compositions (e.g., abundance, presence-absence). This
information is stored as a sites × species table that can be graphically
represented (Figure 1). Following the continuum theory of (Gleason1926),
a common approach (McIntosh1978) consisted in rearranging the sequence
of sites and species, both horizontally and vertically, to highlight the
main organisation of ecological communities (Figure 1). In the final
arrangement, sites (respectively species) are ordered so that the
position of a given site (respectively species) should reflect its
similarity with others.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">adegraphics</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dunedata</span><span class="op">)</span></span>
<span><span class="va">afc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.coa.html">dudi.coa</a></span><span class="op">(</span><span class="va">dunedata</span><span class="op">$</span><span class="va">veg</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table.value.html">table.value</a></span><span class="op">(</span><span class="va">dunedata</span><span class="op">$</span><span class="va">veg</span>, symbol <span class="op">=</span> <span class="st">"circle"</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table.value.html">table.value</a></span><span class="op">(</span><span class="va">dunedata</span><span class="op">$</span><span class="va">veg</span>, coordsx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">afc1</span><span class="op">$</span><span class="va">co</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>coordsy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">afc1</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, symbol <span class="op">=</span> <span class="st">"circle"</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/cbindADEg.html" class="external-link">cbindADEg</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-1-1.png" width="800" height="400"></p>
<figcaption align="center">
Fig.1 - Graphical representation of a floristic table (columns
correspond to 30 species, rows to 20 sites). The size of symbols is
proportional to species abundance. On the right, rows and columns are
reordered using Correspondence Analysis to highlight the main structure.
Data available in the dataset <code>dunedata</code> in
<strong>ade4</strong>.
</figcaption><p>In the first works, the rearrangement is performed by hand
(Curtis1951) and the result is often subjective, depending on the
experience of the ecologist. Hence, several methods have been proposed
to perform an objective ordering of sites and species. (Goodall1954)
proposed the generic term <em>ordination</em> to describe any techniques
that allow to rearrange an ecological table. He suggested that this
ordination can be performed on several dimensions and used Principal
Component Analysis (PCA) to analyse a floristic data set. PCA has been
widely used by ecologists but also strongly criticised due to its
underlying assumption of linear species responses which is inadequate in
the context of gradient analysis (Swan1970, Austin1971, Beals1973).
Based on the principle of weighted averaging, Correspondence Analysis
(CA) considers unimodal species responses. This method developed by
(Benzecri1969) has been popularised by Hill1974, Hill1973 in Ecology
using the iterative algorithm of <em>reciprocal averaging</em>. CA uses
the <span class="math inline">\(\chi^2\)</span> distance in a symmetric
manner for sites and species. If the study mainly aims to characterise
the variations of diversity among sites (i.e., <span class="math inline">\(\beta\)</span> diversity), other types of distance
can be envisaged. In this case, the analysis focuses on the similarities
between sites and Principal Coordinate Analysis (PCoA) can be applied to
summarise the information in few dimensions.</p>
<p>This vignette shows how the choice of a data analysis method should
be driven by the type of data (count tables, presence-absence, abundance
indices, etc.) but also by the objectives of the study. Indeed, each
method has its own mathematical properties, and these properties relate
to an underlying ecological model that must be adapted to the objectives
of the study.</p>
</div>
<div class="section level2">
<h2 id="correspondence-analysis-ca">Correspondence Analysis (CA)<a class="anchor" aria-label="anchor" href="#correspondence-analysis-ca"></a>
</h2>
<p>Correspondence analysis (CA) is designed to analyse two-way
contingency tables. These tables contain counts of individuals belonging
to categories of two categorical variables. In <strong>R</strong>, the
<code>table</code> function allows to build such table by crossing two
<code>factor</code> objects. For instance, the frequency distribution of
70 species (from the <code>carniherbi49</code> data set of
<strong>ade4</strong>) according to their order and diet is obtained
by:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">ade4</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">carniherbi49</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">carniherbi49</span><span class="op">$</span><span class="va">taxo</span><span class="op">$</span><span class="va">ord</span>, <span class="va">carniherbi49</span><span class="op">$</span><span class="va">tab2</span><span class="op">$</span><span class="va">clade</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 </span></span>
<span><span class="co">##                  Carnivore Herbivore</span></span>
<span><span class="co">##   Artiodactyla           0        24</span></span>
<span><span class="co">##   Carnivora             19         0</span></span>
<span><span class="co">##   Perissodactyla         0         6</span></span></code></pre>
<p>By definition, a contingency table contains only positive values and
its rows and columns play the same role as they both correspond to
categories. It is possible to compute marginal (i.e., by row and column)
and grand totals:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Artiodactyla      Carnivora Perissodactyla </span></span>
<span><span class="co">##             24             19              6</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Carnivore Herbivore </span></span>
<span><span class="co">##        19        30</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 49</span></span></code></pre>
<p>The association between the two categorical variables can be
evaluated by a <span class="math inline">\(\chi^2\)</span> test. The
statistics of this test measures the deviation between observed counts
and those expected under the hypothesis of independence between the two
variables. Here, we used a randomisation version of the test:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">tab</span>, simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test with simulated p-value (based on 2000</span></span>
<span><span class="co">##  replicates)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  tab</span></span>
<span><span class="co">## X-squared = 49, df = NA, p-value = 0.0004998</span></span></code></pre>
<p>A sites <span class="math inline">\(\times\)</span> species table is
not a contingency table <em>sensu stricto</em> as the sampling unit is
the site. However, it can be treated as a contingency table by
considering that individuals have been sampled and two categorical
variables (namely the species and the site) have been measured. This
would correspond to sample a number of individuals so that the list of
species is simply the result of the exploration of the biological
diversity of the environment, and the list of sites is simply the result
of the exploration of the spatial extent of the study area.</p>
<p>We considered the <code>doubs</code> data set (see the vignette on
Environmental variables structures). In this data set, the
<code>doubs$fish</code> data frame contains the number of fish of 27
species that were found in the 30 sites along the Doubs river. In this
case, summing values by row, columns or both makes sense as it produces
the number of fishes sampled in each site, the number of fishes for each
species and the total number of fishes:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">)</span></span>
<span><span class="va">fish</span> <span class="op">&lt;-</span> <span class="va">doubs</span><span class="op">$</span><span class="va">fish</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">fish</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 </span></span>
<span><span class="co">##  3 12 16 21 34 21 16  0 14 14 11 18 19 28 33 40 44 42 46 56 62 72  4 15 11 43 </span></span>
<span><span class="co">## 27 28 29 30 </span></span>
<span><span class="co">## 63 70 87 89</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">fish</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Cogo Satr Phph Neba Thth Teso Chna Chto Lele Lece Baba Spbi Gogo Eslu Pefl Rham </span></span>
<span><span class="co">##   15   57   68   73   15   19   18   26   43   56   43   27   55   40   36   33 </span></span>
<span><span class="co">## Legi Scer Cyca Titi Abbr Icme Acce Ruru Blbj Alal Anan </span></span>
<span><span class="co">##   29   21   25   45   26   18   38   63   31   57   27</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fish</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1004</span></span></code></pre>
<p>Several books were dedicated to CA, see for example (Nishisato1980)
and (Greenacre1984). In <strong>ade4</strong>, CA is computed with the
<code>dudi.coa</code> function. The first argument of this function is
the data frame containing species counts. Additional arguments
<code>scannf</code> and <code>nf</code> work as in the
<code>dudi.pca</code> function to choose the number of axes on which
scores and loadings are computed (see Section <span class="math inline">\(\ref{examplePCA}\)</span>). All the outputs of
this function are grouped in a <code>dudi</code> object (subclass
<code>coa</code>).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.coa.html">dudi.coa</a></span><span class="op">(</span><span class="va">fish</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Correspondence Analysis allows to summarise the structure of a
contingency table by identifying associations between categories of both
variables (sites and species). The initial data transformation for a CA
is different from the transformation used for a PCA (centring and
standardisation). In CA, counts are first transformed into frequencies.
These frequencies are then turned into relative frequencies, dividing
them by marginal frequencies, and they are finally centred. This
transformation means that CA is based on relative composition (for both
species and sites) so that quantitative differences are removed contary
to PCA that works on abundance values. This difference is illustrated
with a simulated data set where the abundance of 3 species are generated
for sites using a Gaussian response model. Curves for species 1 and
species 2 differ only by their maximum abundance whereas curves for
species 2 and 3 differ only for the niche position.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fgauss</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="va">mu</span>, <span class="va">t</span>, <span class="va">h</span><span class="op">)</span> <span class="va">h</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">t</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sp1</span> <span class="op">&lt;-</span> <span class="fu">fgauss</span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">10</span>, t <span class="op">=</span> <span class="fl">5</span>, h <span class="op">=</span> <span class="fl">35</span><span class="op">)</span></span>
<span><span class="va">sp2</span> <span class="op">&lt;-</span> <span class="fu">fgauss</span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">10</span>, t <span class="op">=</span> <span class="fl">5</span>, h <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">sp3</span> <span class="op">&lt;-</span> <span class="fu">fgauss</span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">13</span>, t <span class="op">=</span> <span class="fl">5</span>, h <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">sp1</span>, <span class="va">sp2</span>, <span class="va">sp3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>PCA and CA are applied on this simulated data set and distances among
species are then computed on data transformed by these two methods.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dist.dudi.html">dist.dudi</a></span><span class="op">(</span><span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">sim</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, amongrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dcoa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dist.dudi.html">dist.dudi</a></span><span class="op">(</span><span class="fu"><a href="../reference/dudi.coa.html">dudi.coa</a></span><span class="op">(</span><span class="va">sim</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, amongrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/s1d.curves.html" class="external-link">s1d.curves</a></span><span class="op">(</span><span class="va">sim</span>, p1d.hori <span class="op">=</span> <span class="cn">FALSE</span>, paxes.draw <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    plines.col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, ppoints.col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, xlab <span class="op">=</span> <span class="st">"sites"</span>, </span>
<span>    ylab <span class="op">=</span> <span class="st">"abundance"</span>, key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">"inside"</span>, </span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/table.image.html" class="external-link">table.image</a></span><span class="op">(</span><span class="va">dpca</span>, axis.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>    xlab <span class="op">=</span> <span class="st">"PCA"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/table.image.html" class="external-link">table.image</a></span><span class="op">(</span><span class="va">dcoa</span>, axis.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>    xlab <span class="op">=</span> <span class="st">"CA"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-12-1.png" width="600" height="300"></p>
<figcaption align="center">
Fig.2 - Simulation of the response curves of 3 species for 20 sites. On
the right, distances among species are computed in the case of PCA or CA
and represented by heatmaps. Black cells correspond to high distances,
white cells to low distances.
</figcaption><p>In PCA, species 2 and 3 are the closest as their absolute abundances
in sites are similar (Figure 2). In CA, the values themselves have no
influence, it is the shape of the profiles that matters. Hence, species
1 and 2 are the closest as they have the same niche positions. Hence, CA
should be used only when the study should focus on relative composition
and not consider difference in abundance. This is the case in gradient
analysis where species should be ordered by their niche positions on an
environmental or a latent gradient.</p>
<p>The same rationale holds for sites. We consider 3 sites of the
simulated data set:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim3</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p>When PCA is applied, absolute abundances are considered and site 1 is
thus more similar to site 20 than to site 10:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dist.dudi.html">dist.dudi</a></span><span class="op">(</span><span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">sim3</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            1        10</span></span>
<span><span class="co">## 10 29.949958          </span></span>
<span><span class="co">## 20  3.741657 31.575307</span></span></code></pre>
<p>On the other hand, site 1 is much more similar to site 10 than to
site 20 when CA is applied:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dist.dudi.html">dist.dudi</a></span><span class="op">(</span><span class="fu"><a href="../reference/dudi.coa.html">dudi.coa</a></span><span class="op">(</span><span class="va">sim3</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            1        10</span></span>
<span><span class="co">## 10 0.1331590          </span></span>
<span><span class="co">## 20 0.7897253 0.6575916</span></span></code></pre>
<p>These patterns are due to the fact that CA works on relative
compositions and the high proportion of species 1 in sites 1 and 10
(around 70% of the individuals) explains the high level of similarity
between these two sites:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="va">sim3</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          sp1       sp2       sp3</span></span>
<span><span class="co">## 1  0.7000000 0.2000000 0.1000000</span></span>
<span><span class="co">## 10 0.6603774 0.1886792 0.1509434</span></span>
<span><span class="co">## 20 0.5000000 0.1000000 0.4000000</span></span></code></pre>
<p>These differences between PCA and CA are due to different
parametrisation for data transformation (<code>$tab</code>), sites
(<code>$lw</code>) and species weights (<code>$cw</code>) which imply
different ways to compute distances among sites: CA uses the <span class="math inline">\(\chi^2\)</span> distance whereas PCA is based on
Euclidean distance.</p>
<p>Lastly, note that CA is a symmetric method, while PCA is
intrinsically asymmetric. In PCA, rows and columns play a very different
role: columns are variables and rows are observations. The PCA of a
table and the PCA of the transpose of this table give very different
results . Conversely, rows and columns have the same role in CA, and the
CA of the transpose of a table gives exactly the same results as the CA
of the table itself. This means that, , CA should be used on tables
where rows and columns play the same role.</p>
<p>Figure 3 shows the first two axes factor maps of CA applied on the
<code>doubs$fish</code> data set. Fish species (left) and sampling sites
(right) positions are drawn with the <code>s.label</code> function.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">coa1</span><span class="op">$</span><span class="va">co</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">coa1</span><span class="op">$</span><span class="va">li</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sl1</span>, <span class="va">sl2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-17-1.png" width="800" height="400"></p>
<figcaption align="center">
Fig.3 - Correspondence Analysis of the Doubs fish species data table.
Left: fish species factor map, right: sampling sites factor map.
</figcaption><p>The fish species factor map (Figure 3, left) shows very clearly that
three zones can be distinguished along the stream. The first one is the
trout zone (lower left corner), where the most frequent species are
brown trout (<code>Satr</code>), minnow (<code>Phph</code>) and stone
loach (<code>Neba</code>). The second one is the grayling zone (upper
left corner), where grayling (<code>Thth</code>), blageon
(<code>Teso</code>) and european bullhead (<code>Cogo</code>) are also
present, while the first three species are decreasing. The last one (on
the right of the figure) is the downstream zone, where all other species
are present.</p>
<p>The sites factor map shows (Figure 3, right) the sites that belong to
the three zones. The trout zone extends from site <code>1</code> to site
<code>10</code> (with the exception of site <code>8</code>), the
grayling zone goes from site <code>11</code> to site <code>18</code>,
and all other sites belong to the downstream zone. This typology is in
good agreement with what is known about the biology of these species in
this region (Verneaux1973) and with the Huet zonation.</p>
<p>There is however a problem with the results of this CA: the high
pollution peak that was detected at sites <code>23</code> to
<code>26</code> by the PCA of water physico-chemical parameters does not
seem to have any effect on fish species distribution. This is strange,
as many fish species are very sensitive to water pollution.</p>
<p>And indeed, looking at the raw fish counts (Figure 4) shows that the
effect of this pollution on fish numbers is obvious.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table.value.html">table.value</a></span><span class="op">(</span><span class="va">fish</span>, ppoints.cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-18-1.png" width="600" height="600"></p>
<figcaption align="center">
Fig.4 - Number of fish of the 27 species (columns) found in the 30 sites
(rows) of the <code>doubs</code> data set. The area of black squares is
proportional to the number of fishes.
</figcaption><p>Figure 4 was drawn using the <code>table.value</code> function. This
function plots the whole data table, with black squares proportional to
the number of fishes (27 species in columns and 30 sites in row). The
trout zone and the grayling zone are clearly visible on the left of the
figure, but the downstream zone is obviously cut in two parts, just
after site <code>22</code>. At site <code>23</code>, all species show a
dramatic decrease, with only three species still present:
<code>Lece</code> (chub), <code>Ruru</code> (roach) and
<code>Alal</code> (bleak). This effect of pollution persists along sites
<code>24</code> to <code>26</code>. Fish numbers increase downstream, as
the stream restoration process takes place and pollution slowly
disappears. As CA considers relative and not absolute abundances, the
decrease of abundances due to pollution can not be identified with this
method.</p>
<p>Biplot can be produced for CA using the <code>biplot</code> or
<code>scatter</code> functions. In <strong>ade4</strong>, three types of
biplots can be produced using the argument <code>method</code>
(Oksanen1987). If <code>method = 2</code>, species are positioned by a
unit-variance score (<code>$c1</code>) and sites by weighted averaging
(<code>$li</code>). If <code>method = 3</code>, sites are positioned by
a unit-variance score (<code>$l1</code>) and species by weighted
averaging (<code>$co</code>). Figure 5 illustrates this representation.
By default, (<code>method = 1</code>) corresponds to a compromise
between these two representations (<code>$li</code> and
<code>$co</code>).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scatter.html">scatter</a></span><span class="op">(</span><span class="va">coa1</span>, method <span class="op">=</span> <span class="fl">3</span>, posieig <span class="op">=</span> <span class="st">"none"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.value.html">s.value</a></span><span class="op">(</span><span class="va">coa1</span><span class="op">$</span><span class="va">l1</span>, <span class="va">fish</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, plegend.drawKey <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    symbol <span class="op">=</span> <span class="st">"circle"</span>, centerpar <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.distri.html">s.distri</a></span><span class="op">(</span><span class="va">coa1</span><span class="op">$</span><span class="va">l1</span>, <span class="va">fish</span><span class="op">[</span>, <span class="fl">5</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    ellipseSize <span class="op">=</span> <span class="fl">0</span>, ppoints.cex <span class="op">=</span> <span class="fl">0</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/cbindADEg.html" class="external-link">cbindADEg</a></span><span class="op">(</span><span class="va">sc1</span>, <span class="va">sv1</span> <span class="op">+</span> <span class="va">sd1</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-19-1.png" width="800" height="400"></p>
<figcaption align="center">
Fig.5 - CA of Doubs fish data table. Left: CA biplot
(<code>method = 3</code>) where sites are positioned by a unit-variance
score (<code>$l1</code>) and species by weighted averaging
(<code>$co</code>). Right: principles of weighted averaging illustrated
for the grayling (<code>Thth</code>). Sites are represented using the
<code>s.value</code> function with symbols proportional to the abundance
of grayling. The positions are given by <code>$l1</code>. Then, the
function <code>s.distri</code> is used to position the grayling by
weighted averaging. The species is represented by a star linking the
species to all the sites where it occurs.
</figcaption>
</div>
<div class="section level2">
<h2 id="centred-pca-cpca">Centred PCA (cPCA)<a class="anchor" aria-label="anchor" href="#centred-pca-cpca"></a>
</h2>
<p>CA outputs do not show the effect of the pollution peak on fishes and
the loss of almost all species. This is because CA works on profiles,
and therefore removes quantitative differences between sites and between
species. CA compares the shape of the profiles, which means that sites
(or species) with different fish numbers but with the same profile shape
will seem identical. Pollution, by killing almost all the fishes
indistinctly has no influence on the shape of the profiles, since all
the species are affected in the same way.</p>
<p>If a quantitative effect must be evidenced, then a PCA should be used
instead. However, as explained in vignette Environmental variables
structures, the difference of variance between species should not be
removed, which means that a covariance matrix PCA (also called “centred
PCA”) should be preferred to a correlation matrix PCA.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">fish</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">cpca</span><span class="op">$</span><span class="va">co</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">cpca</span><span class="op">$</span><span class="va">li</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sl1</span>, <span class="va">sl2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-20-1.png" width="800" height="400"></p>
<figcaption align="center">
Fig.6 - Centred PCA of Doubs fish data table. Left: fish species factor
map, right: sites factor map.
</figcaption><p>Figure 6 shows the results of a covariance matrix PCA on the fish
count table. The species factor map shows that the three zones (trout,
grayling and downstream) are still detected and ordered on the first
principal component from left to right. On the sites factor map,
downstream sites are on the right, with the exception of sites
<code>23</code>, <code>24</code> and <code>25</code>, which are on the
left, near sites <code>1</code> and <code>8</code>. What is the common
point between sites <code>1</code>, <code>8</code>, and <code>23</code>,
<code>24</code>, <code>25</code> ? It is simply a very low number of
fishes, or even the absence of any fish in site <code>8</code> (see
Figure 7).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Sites"</span>, ylab <span class="op">=</span> <span class="st">"Fish number"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-21-1.png" width="400" height="400"></p>
<figcaption align="center">
Fig.7 - Total number of fishes in the 30 sites of the
<code>doubs$env</code> data set.
</figcaption>
</div>
<div class="section level2">
<h2 id="standardised-and-non-centred-pca">Standardised and non-centred PCA<a class="anchor" aria-label="anchor" href="#standardised-and-non-centred-pca"></a>
</h2>
<p>The choice of centring and standardisation in PCA is very important,
and the corresponding analyses can give very different results.
Restricting the choice to the usual dichotomy “same units <span class="math inline">\(\Rightarrow\)</span> covariance matrix PCA” and
“different units <span class="math inline">\(\Rightarrow\)</span>
correlation matrix PCA” can be inadequate. There are other types of
centring and standardisation: non-centred PCA, de-centred PCA,
block-standardised PCA, etc., that can prove very useful.</p>
<p>Figures 8 and 9 show the differences between a correlation matrix PCA
(also called “standardised PCA”) and a non-centred PCA (ncPCA) on the
Doubs fish counts table.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">fish</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">co</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">pca</span><span class="op">$</span><span class="va">li</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sc1</span>, <span class="va">sl1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-22-1.png" width="800" height="400"></p>
<figcaption align="center">
Fig.8 - Normed PCA of Doubs fish data table. Left: fish species
correlation circle, right: sites factor map.
</figcaption><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ncpca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">fish</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">ncpca</span><span class="op">$</span><span class="va">co</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">ncpca</span><span class="op">$</span><span class="va">li</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/ADEgS.html" class="external-link">ADEgS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sl1</span>, <span class="va">sl2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-23-1.png" width="800" height="400"></p>
<figcaption align="center">
Fig.9 - Non-centred PCA of Doubs fish data table. Left: fish species
factor map, right: sites factor map.
</figcaption><p>The sites factor map of the normed PCA (Figure 8, right) is very
similar to the sites factor map of the centred PCA. But the correlation
circle of the normed PCA shows that the standardisation has almost
completely removed the distinction between the trout zone and the
grayling zone. All the species have been rescaled to unit variance, and
some important information about species distribution has been lost. In
this analysis, all the species have equal importance. In centred PCA, on
the other hand, species with high variations of abundance (and thus high
variance) would have more importance than species with low variation of
abundances.</p>
<p>Conversely, the non-centred PCA (ncPCA) keeps the distinction between
the two zones, and puts the empty site (<code>8</code>) at the origin
(0, 0) on Figure 9 (just like CA). In centred PCA, the origin
corresponds to the average composition of the study area.</p>
<p>This example illustrates the fact that the choice of a data analysis
method should not be based only on the type of data. The usual shortcuts
“quantitative variables <span class="math inline">\(\Rightarrow\)</span>
PCA” and “count tables <span class="math inline">\(\Rightarrow\)</span>
CA” may lead to very bad results. PCA and CA are very different methods
that should be used with caution. The choice must be based on the
adequacy of the mathematical properties of the method with the aims of
the study.</p>
</div>
<div class="section level2">
<h2 id="principal-coordinate-analysis-pcoa">Principal Coordinate Analysis (PCoA)<a class="anchor" aria-label="anchor" href="#principal-coordinate-analysis-pcoa"></a>
</h2>
<p>Different multivariate methods induce different ways to compute
distances among sites (Euclidean distance for PCA, <span class="math inline">\(\chi^2\)</span> distance for CA. Many distance
measures have been defined in particular situations (genetic data,
presence-abscence, etc.), with special properties well adapted to these
situations. See Chapter 7 of (legendre98) for a detailed analysis and
comparison of the ways to measure resemblance between sites (or species)
in Ecology. It is therefore desirable to be able to introduce these
particular distance measures in multivariate data analysis methods.
Principal Coordinate Analysis takes distance matrix as input and returns
coordinates for individuals in a low dimensional space that best
preserve the original distances.</p>
<p>The advantage of PCoA over PCA or CA is that it allows to choose a
particular distance measure between sites (or species). A drawback is
that it focuses either on individuals or variables, not both. Hence,
only one viewpoint (cloud) of the duality diagram theory is
considered.</p>
<p>Principal Coordinate Analysis can be useful in two different
situations:</p>
<ul>
<li>when the rectangular (individuals <span class="math inline">\(\times\)</span> variables) data table is not
available for some reason, for example when the experimental design
implies a direct measure of distances instead of measuring parameters on
sampling units,</li>
<li>when the rectangular measures table is available but a particular
distance, more appropriate to the data set must be used.</li>
</ul>
<p>The goal of the analysis is to give Euclidean representations (factor
maps) that display individuals, starting from a matrix of Euclidean
distances between these individuals. The use of the
<code>dudi.pco</code> function should thus be restricted to Euclidean
distance matrices. This can be tested using the <code>is.euclid</code>
function. If a non-Euclidean distance matrix is used, PCoA will return
negative eigenvalues because the method is not able to return a
configuration of individuals that strictly preserve the distances. An
alternative is to approximate the distance matrix by a Euclidean one
with a simple transformation (see <code>cailliez</code> or
<code>lingoes</code> functions).</p>
<p>A very useful characteristic of the <code>dudi.pco</code> function is
that it allows to introduce distance matrices into the duality diagram
framework by returning an object of class <code>dudi</code>. This means
that a <code>dudi</code> of class <code>pco</code> can, for example, be
coupled with another data table with a Coinertia Analysis. This can be
used to analyse the relationships between a distance matrix and a table
of environmental variables, like in db-RDA . An example of application
in the field of microbiology and using Coinertia Analysis instead of
Redundancy Analysis is given by (Jarraud2002).</p>
<p>All the outputs of the <code>dudi.pco</code> function are grouped in
a <code>dudi</code> object (subclass <code>pco</code>).</p>
<p>The first argument to the <code>dudi.pco</code> function must be an
object of class <code>dist</code> containing a Euclidean distance
matrix. Other arguments are similar to arguments of the other
<code>dudi</code> functions, except the <code>full</code> and
<code>tol</code> arguments. <code>full = TRUE</code> means that all
dimensions should be kept in returned objects. <code>tol</code>, the
tolerence threshold, is used to test whether the distance matrix is
Euclidean: an eigenvalue is considered positive if it is larger than
<code>-tol * lambda1</code> where <code>lambda1</code> is the largest
eigenvalue.</p>
<p>We used PCoA on the <code>doubs$fish</code> data set. The first step
consists in computing a distance matrix between the rows of the data
frame (sites). The <code>dist.binary</code> function computes the
Jaccard index (<span class="math inline">\(s\)</span>) between sites
after presence/absence transformation. The distances are then computed
as <span class="math inline">\(\sqrt{1-s}\)</span>. The
<code>dudi.pco</code> function is then used to perform the PCoA:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfishJ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dist.binary.html">dist.binary</a></span><span class="op">(</span><span class="va">fish</span>, method <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">pcoJ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dudi.pco.html">dudi.pco</a></span><span class="op">(</span><span class="va">dfishJ</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Duality diagramm</span></span>
<span><span class="co">## class: pco dudi</span></span>
<span><span class="co">## $call: dudi.pco(d = dfishJ, scannf = FALSE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nf: 2 axis-components saved</span></span>
<span><span class="co">## $rank: 26</span></span>
<span><span class="co">## eigen values: 0.1023 0.03547 0.03034 0.02503 0.02042 ...</span></span>
<span><span class="co">##   vector length mode    content       </span></span>
<span><span class="co">## 1 $cw    26     numeric column weights</span></span>
<span><span class="co">## 2 $lw    30     numeric row weights   </span></span>
<span><span class="co">## 3 $eig   26     numeric eigen values  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   data.frame nrow ncol content             </span></span>
<span><span class="co">## 1 $tab       30   26   modified array      </span></span>
<span><span class="co">## 2 $li        30   2    row coordinates     </span></span>
<span><span class="co">## 3 $l1        30   2    row normed scores   </span></span>
<span><span class="co">## 4 $co        26   2    column coordinates  </span></span>
<span><span class="co">## 5 $c1        26   2    column normed scores</span></span>
<span><span class="co">## other elements: NULL</span></span></code></pre>
<p>Other packages contain useful functions to compute ecological
(di)similarity indices, distance measures and standardising
tranformations, like <strong>vegan</strong> (<code>vegdist</code> and
<code>decostand</code> functions), and <strong>labdsv</strong>
(<code>dsvdis</code> function).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/s.label.html">s.label</a></span><span class="op">(</span><span class="va">pcoJ</span><span class="op">$</span><span class="va">li</span>, plabels.optim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ChapSpeciesStruct_files/figure-html/unnamed-chunk-25-1.png" width="600" height="600"></p>
<figcaption align="center">
Fig.10 - Principal Coordinate Analysis of the Doubs fish species data
table.
</figcaption><p>Figure 10 shows the same upstream-downstream ordination of sites as
with previous analyses, and the same exceptional position of sites
<code>23</code>, <code>24</code> and <code>25</code> (absence of fish
due to pollution, see Figure 6), near site <code>8</code> (zero fish
between the trout zone and the grayling zone) and site <code>1</code>
(near the source, with only 3 trouts).</p>
</div>
<div class="section level2">
<h2 id="other-simple-methods">Other simple methods<a class="anchor" aria-label="anchor" href="#other-simple-methods"></a>
</h2>
<p>The <strong>ade4</strong> package provides other methods for the
analysis of one species table, but we are not going to detail them here.
Here is the list of the functions and the corresponding methods (see the
online documentation for more information on how to use them and
examples of application):</p>
<ul>
<li>
<code>dudi.dec</code>: Decentred Correspondence Analysis. This
analysis can be used when a particular column profile is available. This
profile will be used as a reference in a Correspondence Analysis type
analysis.</li>
<li>
<code>dudi.nsc</code>: Non-Symmetric Correspondence Analysis. This
analysis is a Correspondence Analysis with <em>uniform column
weights</em> (but keeping usual CA <em>row weights</em>).</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
