<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Dagnelie multinormality test — dagnelie.test • ade4</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dagnelie multinormality test — dagnelie.test"><meta name="description" content="Compute Dagnelie test of multivariate normality on a data table of n objects (rows) and p variables (columns), with n &amp;gt; (p+1)."><meta property="og:description" content="Compute Dagnelie test of multivariate normality on a data table of n objects (rows) and p variables (columns), with n &amp;gt; (p+1)."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-24</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-new-to-ade-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">New to ade4?</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-"><li><a class="dropdown-item" href="../articles/install.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/get_started.html">Getting started</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a></li>
    <li><a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a></li>
    <li><a class="dropdown-item" href="../articles/ChapKtables.html">Analysing Changes in Structures</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2Ktables.html">Analysing Changes in Co-structures</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/related.html">Related packages</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-ressources" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Ressources</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-ressources"><li><a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/ade4shiny/">ade4shiny</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
    <li><a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a></li>
    <li><a class="dropdown-item" href="../articles/book.html">ade4 book</a></li>
    <li><a class="dropdown-item" href="../articles/papers.html">Papers</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en"><span class="fa fa-leaf"></span> LBBE</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adeverse/ade4"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Dagnelie multinormality test</h1>

      <div class="d-none name"><code>dagnelie.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute Dagnelie test of multivariate normality on a data table of n objects (rows) and p variables (columns), with n &gt; (p+1).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Multivariate data table (<code>matrix</code> or <code>data.frame</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following results:</p>
<dl><dt>Shapiro.Wilk</dt>
<dd><p>W statistic and p-value</p></dd>

<dt>dim</dt>
<dd><p>dimensions of the data matrix, n and p</p></dd>

<dt>rank</dt>
<dd><p>the rank of the covariance matrix</p></dd>

<dt>D</dt>
<dd><p>Vector containing the Mahalanobis distances of the objects to the multivariate centroid</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Dagnelie's goodness-of-fit test of multivariate normality is applicable to
 multivariate data. Mahalanobis generalized distances are computed between each object and the multivariate centroid of all objects. Dagnelie’s approach is that, for multinormal data, the generalized distances should be normally distributed. The function computes a Shapiro-Wilk test of normality of the Mahalanobis distances; this is our improvement of Dagnelie’s method.
The null hypothesis (H0) is that the data are multinormal, a situation where the Mahalanobis distances should be normally distributed. In that case, the test should not reject H0, subject to type I error at the selected significance level. <br></p>
<p>Numerical simulations by D. Borcard have shown that the test had correct levels of type I error for values of n between 3p and 8p, where n is the number of objects and p is the number of variables in the data
 matrix (simulations with 1 &lt;= p &lt;= 100). Outside that range of n values, the results were too liberal, meaning that the test rejected too often the null hypothesis of normality. For p = 2, the simulations showed the test to be valid for 6 &lt;= n &lt;= 13 and too liberal outside that range. If H0 is not rejected in a situation where the test is too liberal, the result is trustworthy.<br></p>
<p>Calculation of the Mahalanobis distances requires that n &gt; p+1 (actually, n &gt; rank+1). With fewer objects (n), all points are at equal Mahalanobis distances from the centroid in the resulting space, which has <code>min(rank,(n-1))</code> dimensions. For data matrices that happen to be collinear, the function uses <code>ginv</code> for inversion.<br></p>
<p>This test is not meant to be used with univariate data; in simulations, the type I error rate was higher than the 5% significance level for all values of n. Function <code>shapiro.test</code> should be used in that situation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dagnelie, P. 1975. L'analyse statistique a plusieurs variables.
 Les Presses agronomiques de Gembloux, Gembloux, Belgium.<br></p>
<p>Legendre, P. and L. Legendre. 2012. Numerical ecology, 3rd English
 edition. Elsevier Science BV, Amsterdam, The Netherlands.<br></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Daniel Borcard and Pierre Legendre</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 1: 2 variables, n = 100</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, p = 2, n &gt; 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.94868, p-value = 0.0006795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n   p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 1.63094440 1.89093073 1.06850561 1.55115932 0.96826146 1.08346893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7] 0.74003259 2.27601624 0.04195293 1.04875933 0.65721995 1.51316594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [13] 0.91305561 1.49248994 0.57821443 0.91353832 0.41234663 1.66408208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19] 0.47762322 2.93966877 1.50027325 0.99574548 0.41006601 0.97900343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 1.28677979 0.59719570 1.51469150 0.31240733 1.65567229 1.14803089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31] 1.02926755 0.61370659 1.11565346 0.84169126 0.83081718 1.23505409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37] 2.03192676 0.76242361 0.23924818 2.86470781 1.21862318 1.41409564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43] 1.49384225 1.19496876 1.25188150 1.03742055 0.62553642 0.78882719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 1.10304776 2.62766719 2.66738032 1.03989712 0.85004838 1.43878817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55] 2.02944870 0.84375116 2.48180198 1.48587103 1.12255560 1.37337122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61] 1.00506255 0.65390383 1.64042829 0.24514406 0.91401161 0.58476659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [67] 1.36224518 0.99437370 1.31317830 1.30541453 0.52895610 0.56239780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 1.10371289 0.58610533 1.96544357 1.66611633 1.31847687 0.63450296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [79] 1.25309790 0.22189027 2.60280494 1.78737146 2.29351027 2.51691062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85] 1.37110660 0.79639661 2.34090968 1.16782217 2.21888472 1.16477198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] 1.70143554 1.44390375 0.48918958 0.75870102 0.84143827 1.45918507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 0.79702599 3.24858384 1.21958452 0.37648040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 2: 10 variables, n = 50</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.9548, p-value = 0.0539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n  p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 2.982941 2.499717 2.324695 3.239122 4.080598 4.233473 3.503733 3.223963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 3.947625 2.086792 2.705997 2.418646 2.480147 2.395558 3.529252 2.939068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 1.977943 3.258038 2.141438 4.367838 3.749765 3.213342 2.815072 3.408722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 2.291271 3.675192 3.646739 2.296899 3.933074 2.920086 2.512797 2.896804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] 2.671421 3.418794 2.007475 3.497908 2.725308 2.280538 3.711928 3.621082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] 3.930047 4.042625 3.783851 3.057676 4.086071 2.946090 2.888217 1.987689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] 2.377746 2.019824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 3: 10 variables, n = 100</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.98641, p-value = 0.399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n   p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100  10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 3.358540 3.081322 3.747632 2.657183 2.970503 3.499478 3.770273 3.817320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9] 3.155442 3.117439 2.331254 3.588218 2.694866 3.500442 1.458891 2.826820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [17] 2.183989 3.015159 2.345796 3.532315 3.341591 2.851331 3.239158 3.096472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 3.250550 3.963005 2.926613 2.471130 3.245057 2.721967 2.950153 2.691303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [33] 4.240487 2.092875 2.622773 2.378713 3.129056 2.381641 3.722073 3.813385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] 3.383902 2.473297 3.718014 3.296913 3.581499 4.723389 3.032238 2.925233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 3.455788 3.402161 2.581082 2.422973 4.901725 2.286821 3.146711 2.414125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 2.889677 2.636652 3.711871 3.022434 3.150879 2.431359 2.624719 4.112568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [65] 3.733789 2.832707 3.826711 3.328434 4.165288 4.394543 2.441709 2.463219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 2.911228 2.943938 2.467351 3.531863 2.578056 4.373624 3.499025 2.806816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] 1.925170 2.551102 2.394488 1.962291 3.032202 3.005993 3.387403 2.794250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [89] 2.102035 3.437318 3.824340 3.799565 4.156528 2.737391 3.216511 2.469742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97] 2.725538 2.305617 2.431617 3.366925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> <span class="co"># Plot a histogram of the Mahalanobis distances</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dagnelie.test-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Example 4: 10 lognormal random variables, n = 50</span></span></span>
<span class="r-in"><span> <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span> <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dagnelie.test</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Test too liberal, n &gt; 8*p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Shapiro.Wilk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 0.79025, p-value = 5.265e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n  p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.1738462 3.7762757 1.3270182 6.5825578 1.1315532 1.2543027 1.1163972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 2.3734394 1.2666631 2.4916495 1.9324971 1.1581411 6.6388390 1.7328371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 1.6771756 1.1771640 2.5688386 1.3966760 2.6512138 4.1826632 6.8873022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] 1.3540875 1.1516766 1.0468957 1.1869017 3.0068398 1.1720626 4.2801618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] 0.9876805 6.1115159 1.0666022 1.1929179 1.3389546 1.6058780 0.8515767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36] 4.1690810 1.1017821 3.2679705 1.2536251 1.1208294 6.1252940 1.1553250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] 5.3577986 3.8429473 1.1894511 2.7191506 6.3416120 2.1903492 2.1776401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [50] 4.6354175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> <span class="co"># Plot a histogram of the Mahalanobis distances</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">D</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dagnelie.test-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

