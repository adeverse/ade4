<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="neig creates objects of class neig with : 
    a list of edges
    a binary square matrix
    a list of vectors of neighbours
    an integer (linear and circular graphs)
    a data frame of polygons (area)
scores.neig returns the eigenvectors of neighbouring,
orthonormalized scores (null average, unit variance 1/n and null covariances) of maximal autocorrelation.
nb2neig returns an object of class neig using an object of class nb in the library 'spdep'
neig2nb returns an object of class nb using an object of class neig
neig2mat returns the incidence matrix between edges (1 = neighbour ; 0 = no neighbour)
neig.util.GtoL and neig.util.LtoG are utilities."><title>Neighbourhood Graphs — neig • ade4</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Neighbourhood Graphs — neig"><meta property="og:description" content="neig creates objects of class neig with : 
    a list of edges
    a binary square matrix
    a list of vectors of neighbours
    an integer (linear and circular graphs)
    a data frame of polygons (area)
scores.neig returns the eigenvectors of neighbouring,
orthonormalized scores (null average, unit variance 1/n and null covariances) of maximal autocorrelation.
nb2neig returns an object of class neig using an object of class nb in the library 'spdep'
neig2nb returns an object of class nb using an object of class neig
neig2mat returns the incidence matrix between edges (1 = neighbour ; 0 = no neighbour)
neig.util.GtoL and neig.util.LtoG are utilities."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-22</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-new-to-ade-">New to ade4?</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
    <a class="dropdown-item" href="../articles/install.html">Installation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Getting started</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a>
    <a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a>
    <a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a>
    <a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a>
    <a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/related.html">Related packages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-ressources">Ressources</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-ressources">
    <a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/Reproducible_Research/ShinyADE4/">ade4 shinyapps</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a>
    <a class="dropdown-item" href="../articles/book.html">ade4 book</a>
    <a class="dropdown-item" href="../articles/papers.html">Papers</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en">
    <span class="fa fa-leaf"></span>
     
    LBBE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sdray/ade4">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Neighbourhood Graphs</h1>
      
      <div class="d-none name"><code>neig.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>neig</code> creates objects of class <code>neig</code> with : <br>
    a list of edges<br>
    a binary square matrix<br>
    a list of vectors of neighbours<br>
    an integer (linear and circular graphs)<br>
    a data frame of polygons (area)<br></p>
<p>scores.neig returns the eigenvectors of neighbouring,<br>
orthonormalized scores (null average, unit variance 1/n and null covariances) of maximal autocorrelation.<br></p>
<p>nb2neig returns an object of class <code>neig</code> using an object of class <code>nb</code> in the library 'spdep'</p>
<p>neig2nb returns an object of class <code>nb</code> using an object of class <code>neig</code></p>
<p>neig2mat returns the incidence matrix between edges (1 = neighbour ; 0 = no neighbour)</p>
<p>neig.util.GtoL and neig.util.LtoG are utilities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">neig</span><span class="op">(</span>list <span class="op">=</span> <span class="cn">NULL</span>, mat01 <span class="op">=</span> <span class="cn">NULL</span>, edges <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    n.line <span class="op">=</span> <span class="cn">NULL</span>, n.circle <span class="op">=</span> <span class="cn">NULL</span>, area <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scores.neig</span>  <span class="op">(</span><span class="va">obj</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for neig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for neig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">nb2neig</span> <span class="op">(</span><span class="va">nb</span><span class="op">)</span></span>
<span><span class="fu">neig2nb</span> <span class="op">(</span><span class="va">neig</span><span class="op">)</span></span>
<span><span class="fu">neig2mat</span> <span class="op">(</span><span class="va">neig</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>list</dt>
<dd><p>a list which each component gives the number of neighbours</p></dd>

<dt>mat01</dt>
<dd><p>a symmetric square matrix of 0-1 values</p></dd>

<dt>edges</dt>
<dd><p>a matrix of 2 columns with integer values giving a list of edges</p></dd>

<dt>n.line</dt>
<dd><p>the number of points for a linear plot</p></dd>

<dt>n.circle</dt>
<dd><p>the number of points for a circular plot</p></dd>

<dt>area</dt>
<dd><p>a data frame containing a polygon set (see <a href="area.plot.html">area.plot</a>)</p></dd>

<dt>nb</dt>
<dd><p>an object of class 'nb'</p></dd>

<dt>neig, x, obj, object</dt>
<dd><p>an object of class 'neig'</p></dd>

<dt>...</dt>
<dd><p>further arguments passed to or from other methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Thioulouse, J., D. Chessel, and S. Champely. 1995. 
Multivariate analysis of spatial patterns: a unified approach to local and global structures.
<em>Environmental and Ecological Statistics</em>, <b>2</b>, 1--14.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Daniel Chessel</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="adegraphicsLoaded.html">adegraphicsLoaded</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"deldir"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">provi</span> <span class="op">&lt;-</span> <span class="fu">deldir</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/deldir/man/deldir.html" class="external-link">deldir</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">provi.neig</span> <span class="op">&lt;-</span> <span class="fu">neig</span><span class="op">(</span>edges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">provi</span><span class="op">$</span><span class="va">delsgs</span><span class="op">[</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span>, neig <span class="op">=</span> <span class="va">provi.neig</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>      addax <span class="op">=</span> <span class="cn">FALSE</span>, clab <span class="op">=</span> <span class="fl">0</span>, cnei <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">provi.neig</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span><span class="op">[</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span><span class="op">[</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">#hist(dist, nclass = 50)</span></span></span>
<span class="r-in"><span>    <span class="va">mafragh.neig</span> <span class="op">&lt;-</span> <span class="fu">neig</span><span class="op">(</span>edges <span class="op">=</span> <span class="va">provi.neig</span><span class="op">[</span><span class="va">dist</span> <span class="op">&lt;</span> <span class="fl">50</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span>, neig <span class="op">=</span> <span class="va">mafragh.neig</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>      addax <span class="op">=</span> <span class="cn">FALSE</span>, clab <span class="op">=</span> <span class="fl">0</span>, cnei <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">irishdata</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">irish.neig</span> <span class="op">&lt;-</span> <span class="fu">neig</span><span class="op">(</span>area <span class="op">=</span> <span class="va">irishdata</span><span class="op">$</span><span class="va">area</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">irish.neig</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">irish.neig</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">irishdata</span><span class="op">$</span><span class="va">xy</span>, neig <span class="op">=</span> <span class="va">irish.neig</span>, cneig <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>      area <span class="op">=</span> <span class="va">irishdata</span><span class="op">$</span><span class="va">area</span>, clab <span class="op">=</span> <span class="fl">0.8</span>, inc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">irish.scores</span> <span class="op">&lt;-</span> <span class="fu">scores.neig</span><span class="op">(</span><span class="va">irish.neig</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="s.value.html">s.value</a></span><span class="op">(</span><span class="va">irishdata</span><span class="op">$</span><span class="va">xy</span>, <span class="va">irish.scores</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>, grid <span class="op">=</span> <span class="cn">FALSE</span>, addax <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        neig <span class="op">=</span> <span class="va">irish.neig</span>, csi <span class="op">=</span> <span class="fl">2</span>, cleg <span class="op">=</span> <span class="fl">0</span>, sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Eigenvector "</span>,<span class="va">i</span><span class="op">)</span>, csub <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">a.neig</span> <span class="op">&lt;-</span> <span class="fu">neig</span><span class="op">(</span>n.circle <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">a.scores</span> <span class="op">&lt;-</span> <span class="fu">scores.neig</span><span class="op">(</span><span class="va">a.neig</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="s.value.html">s.value</a></span><span class="op">(</span><span class="va">xy</span>, <span class="va">a.scores</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, neig <span class="op">=</span> <span class="va">a.neig</span>, csi <span class="op">=</span> <span class="fl">3</span>, cleg <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">a.neig</span> <span class="op">&lt;-</span> <span class="fu">neig</span><span class="op">(</span>n.line <span class="op">=</span> <span class="fl">28</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">a.scores</span> <span class="op">&lt;-</span> <span class="fu">scores.neig</span><span class="op">(</span><span class="va">a.neig</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">2.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">27</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">a.scores</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"spdep"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">maf.rel</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/graphneigh.html" class="external-link">relativeneigh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">maf.rel</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/graphneigh.html" class="external-link">graph2nb</a></span><span class="op">(</span><span class="va">maf.rel</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span>, neig <span class="op">=</span> <span class="fu">neig</span><span class="op">(</span>list <span class="op">=</span> <span class="va">maf.rel</span><span class="op">)</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>      clab <span class="op">=</span> <span class="fl">0</span>, addax <span class="op">=</span> <span class="cn">FALSE</span>, cne <span class="op">=</span> <span class="fl">1</span>, cpo <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">50</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x.gab</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/graphneigh.html" class="external-link">gabrielneigh</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x.gab</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/graphneigh.html" class="external-link">graph2nb</a></span><span class="op">(</span><span class="va">x.gab</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>, neig <span class="op">=</span> <span class="fu">neig</span><span class="op">(</span>list <span class="op">=</span> <span class="va">x.gab</span><span class="op">)</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>      clab <span class="op">=</span> <span class="fl">0</span>, addax <span class="op">=</span> <span class="cn">FALSE</span>, cne <span class="op">=</span> <span class="fl">1</span>, cpo <span class="op">=</span> <span class="fl">2</span>, sub <span class="op">=</span> <span class="st">"relative"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x.rel</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/graphneigh.html" class="external-link">relativeneigh</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x.rel</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/graphneigh.html" class="external-link">graph2nb</a></span><span class="op">(</span><span class="va">x.rel</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>, neig <span class="op">=</span> <span class="fu">neig</span><span class="op">(</span>list <span class="op">=</span> <span class="va">x.rel</span><span class="op">)</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>      clab <span class="op">=</span> <span class="fl">0</span>, addax <span class="op">=</span> <span class="cn">FALSE</span>, cne <span class="op">=</span> <span class="fl">1</span>, cpo <span class="op">=</span> <span class="fl">2</span>, sub <span class="op">=</span> <span class="st">"Gabriel"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">k1</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html" class="external-link">knn2nb</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>, neig <span class="op">=</span> <span class="fu">neig</span><span class="op">(</span>list <span class="op">=</span> <span class="va">k1</span><span class="op">)</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>      clab <span class="op">=</span> <span class="fl">0</span>, addax <span class="op">=</span> <span class="cn">FALSE</span>, cne <span class="op">=</span> <span class="fl">1</span>, cpo <span class="op">=</span> <span class="fl">2</span>, sub <span class="op">=</span> <span class="st">"k nearest neighbours"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="va">all.linked</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nbdists.html" class="external-link">nbdists</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">w</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/dnearneigh.html" class="external-link">dnearneigh</a></span><span class="op">(</span><span class="va">w</span>, <span class="fl">0</span>, <span class="va">all.linked</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>, neig <span class="op">=</span> <span class="fu">neig</span><span class="op">(</span>list <span class="op">=</span> <span class="va">z</span><span class="op">)</span>, inc <span class="op">=</span> <span class="cn">FALSE</span>, clab <span class="op">=</span> <span class="fl">0</span>, </span></span>
<span class="r-in"><span>      addax <span class="op">=</span> <span class="cn">FALSE</span>, cne <span class="op">=</span> <span class="fl">1</span>, cpo <span class="op">=</span> <span class="fl">2</span>, sub <span class="op">=</span> <span class="st">"Neighbourhood contiguity by distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="neig-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neigbourhood undirected graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vertices: 25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees: 5 5 4 4 1 5 3 6 5 5 5 4 4 2 3 7 3 7 7 3 8 4 6 4 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Edges (pairs of vertices): 57 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S01 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S02 ..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S03 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S04 ....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S05 .....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S06 ..1...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S07 ..11...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S08 1.......</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S09 1........</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S10 1......11.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S11 .1..1......</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S12 ..11..1.....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S13 .1........1..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S14 ..............</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S15 .....1.........</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S16 .1.....1.....1..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S17 .1...........1.1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S18 .....1.1.1.....1..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S19 .....1....1.1.1..1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S20 ..........1...1...1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S21 ..11.1..11.1.....1...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S22 ...1....1...........1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S23 .1.....1....1..1.11....</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S24 1.......1............1..</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S25 1......1.......1.......1.</span>
<span class="r-plt img"><img src="neig-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="neig-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="neig-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="neig-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="neig-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="neig-7.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

