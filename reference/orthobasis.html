<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Orthonormal basis for orthonormal transform — orthobasis • ade4</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Orthonormal basis for orthonormal transform — orthobasis"><meta name="description" content="These functions returns object of class 'orthobasis' that
contains data frame defining an orthonormal basis.
orthobasic.neig returns the eigen vectors of the matrix N-M where M is the symmetric n by n matrix of the between-sites neighbouring graph and N is the diagonal matrix of neighbour numbers.
orthobasis.line returns the analytical solution for the linear neighbouring graph.
orthobasic.circ returns the analytical solution for the circular neighbouring graph.
orthobsic.mat returns the eigen vectors of the general link matrix M.
orthobasis.haar returns wavelet haar basis."><meta property="og:description" content="These functions returns object of class 'orthobasis' that
contains data frame defining an orthonormal basis.
orthobasic.neig returns the eigen vectors of the matrix N-M where M is the symmetric n by n matrix of the between-sites neighbouring graph and N is the diagonal matrix of neighbour numbers.
orthobasis.line returns the analytical solution for the linear neighbouring graph.
orthobasic.circ returns the analytical solution for the circular neighbouring graph.
orthobsic.mat returns the eigen vectors of the general link matrix M.
orthobasis.haar returns wavelet haar basis."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-23</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-new-to-ade-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">New to ade4?</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-"><li><a class="dropdown-item" href="../articles/install.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/get_started.html">Getting started</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a></li>
    <li><a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a></li>
    <li><a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a></li>
    <li><a class="dropdown-item" href="../articles/ChapKtables.html">Analysing Changes in Structures</a></li>
    <li><a class="dropdown-item" href="../articles/Chap2Ktables.html">Analysing Changes in Co-structures</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/related.html">Related packages</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-ressources" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Ressources</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-ressources"><li><a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/ade4shiny/">ade4shiny</a></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
    <li><a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a></li>
    <li><a class="dropdown-item" href="../articles/book.html">ade4 book</a></li>
    <li><a class="dropdown-item" href="../articles/papers.html">Papers</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en"><span class="fa fa-leaf"></span> LBBE</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adeverse/ade4"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Orthonormal basis for orthonormal transform</h1>

      <div class="d-none name"><code>orthobasis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions returns object of class <code>'orthobasis'</code> that
contains data frame defining an orthonormal basis.</p>
<p><code>orthobasic.neig</code> returns the eigen vectors of the matrix N-M where M is the symmetric <em>n</em> by <em>n</em> matrix of the between-sites neighbouring graph and N is the diagonal matrix of neighbour numbers. <br><code>orthobasis.line</code> returns the analytical solution for the linear neighbouring graph. <br><code>orthobasic.circ</code> returns the analytical solution for the circular neighbouring graph. <br><code>orthobsic.mat</code> returns the eigen vectors of the general link matrix M. <br><code>orthobasis.haar</code> returns wavelet haar basis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orthobasis.neig</span><span class="op">(</span><span class="va">neig</span><span class="op">)</span></span>
<span><span class="fu">orthobasis.line</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="fu">orthobasis.circ</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="fu">orthobasis.mat</span><span class="op">(</span><span class="va">mat</span>, cnw<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">orthobasis.haar</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'orthobasis'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">...</span>, nr <span class="op">=</span> <span class="fl">6</span>, nc <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'orthobasis'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'orthobasis'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">is.orthobasis</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-neig">neig<a class="anchor" aria-label="anchor" href="#arg-neig"></a></dt>
<dd><p>is an object of class <code>neig</code></p></dd>

  <dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>is an integer that defines length of vectors</p></dd>

  <dt id="arg-mat">mat<a class="anchor" aria-label="anchor" href="#arg-mat"></a></dt>
<dd><p>is a <em>n</em> by <em>n</em> phylogenetic or spatial link matrix</p></dd>

  <dt id="arg-cnw">cnw<a class="anchor" aria-label="anchor" href="#arg-cnw"></a></dt>
<dd><p>if TRUE, the matrix of the neighbouring graph is modified to give Constant Neighbouring Weights</p></dd>

  <dt id="arg-x-object">x, object<a class="anchor" aria-label="anchor" href="#arg-x-object"></a></dt>
<dd><p>is an object of class <code>orthobasis</code></p></dd>

  <dt id="arg-nr-nc">nr, nc<a class="anchor" aria-label="anchor" href="#arg-nr-nc"></a></dt>
<dd><p>the number of rows and columns to be printed</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>: further arguments passed to or from other methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>All the functions return an object of class <code>orthobasis</code> containing a data frame.
This data frame defines an orthonormal basis with various attributes: <br></p>
<dl><dt>names</dt>
<dd><p>names of the vectors</p></dd>

  <dt>row.names</dt>
<dd><p>row names of the data frame</p></dd>

  <dt>class</dt>
<dd><p>class</p></dd>

  <dt>values</dt>
<dd><p>optional associated eigenvalues</p></dd>

  <dt>weights</dt>
<dd><p>weights for the rows</p></dd>

  <dt>call</dt>
<dd><p>: call</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Misiti, M., Misiti, Y., Oppenheim, G. and Poggi, J.M. (1993) Analyse de signaux classiques par décomposition en ondelettes.
<em>Revue de Statistique Appliquée</em>, <b>41</b>, 5–32.</p>
<p>Cornillon, P.A. (1998) <em>Prise en compte de proximités en analyse factorielle et comparative</em>.
Thèse, Ecole Nationale Supérieure Agronomique, Montpellier.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sébastien Ollier <a href="mailto:sebastien.ollier@u-psud.fr">sebastien.ollier@u-psud.fr</a> <br>
Daniel Chessel</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>the function <code>orthobasis.haar</code> uses function <code><a href="https://rdrr.io/pkg/waveslim/man/wavelet.filter.html" class="external-link">wavelet.filter</a></code> from package waveslim.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gridrowcol.html">gridrowcol</a></code> that defines an orthobasis for square grid,
<code><a href="phylog.html">phylog</a></code> that defines an orthobasis for phylogenetic tree,
<code><a href="https://rdrr.io/pkg/adephylo/man/orthogram.html" class="external-link">orthogram</a></code> and <code><a href="mld.html">mld</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a 2D spatial orthobasis</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="gridrowcol.html">gridrowcol</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="adegraphicsLoaded.html">adegraphicsLoaded</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.value.html">s.value</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">xy</span>, <span class="va">w</span><span class="op">$</span><span class="va">orthobasis</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, pleg.drawKey <span class="op">=</span> <span class="cn">FALSE</span>, pgri.text.cex <span class="op">=</span> <span class="fl">0</span>, </span></span>
<span class="r-in"><span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, porigin.include <span class="op">=</span> <span class="cn">FALSE</span>, paxes.draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">s1d.barchart</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">orthobasis</span>, <span class="st">"values"</span><span class="op">)</span>, p1d.horizontal <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">orthobasis</span>, <span class="st">"values"</span><span class="op">)</span><span class="op">)</span>, plabels.cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.value.html">s.value</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">xy</span>, <span class="va">w</span><span class="op">$</span><span class="va">orthobasis</span><span class="op">[</span>, <span class="va">k</span><span class="op">]</span>, cleg <span class="op">=</span> <span class="fl">0</span>, csi <span class="op">=</span> <span class="fl">2</span>, incl <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>      addax <span class="op">=</span> <span class="cn">FALSE</span>, sub <span class="op">=</span> <span class="va">k</span>, csub <span class="op">=</span> <span class="fl">4</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, cgri <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">orthobasis</span>, <span class="st">"values"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="orthobasis-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="orthobasis-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Haar 1D orthobasis</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">orthobasis.haar</span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span>, <span class="va">k</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"S"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>     yaxt <span class="op">=</span> <span class="st">"n"</span>, xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4.5</span>, <span class="fl">4.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span>, <span class="va">k</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a 1D orthobasis</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">orthobasis.line</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">33</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="orthobasis-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">32</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span>, <span class="va">k</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>     yaxt <span class="op">=</span> <span class="st">"n"</span>, xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span>, <span class="va">k</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="orthobasis-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="adegraphicsLoaded.html">adegraphicsLoaded</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">s1d.barchart</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span>, <span class="st">"values"</span><span class="op">)</span>, p1d.horizontal <span class="op">=</span> <span class="cn">FALSE</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span>, <span class="st">"values"</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    plab.cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span>, <span class="st">"values"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="orthobasis-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">orthobasis.circ</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">26</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#par(mfrow = c(5, 5))</span></span></span>
<span class="r-in"><span><span class="co">#par(mar = c(0.1, 0.1, 0.1, 0.1))</span></span></span>
<span class="r-in"><span><span class="co"># for (k in 1:25) </span></span></span>
<span class="r-in"><span><span class="co">#    dotcircle(w[, k], xlim = c(-1.5, 1.5), cleg = 0)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#barplot(attr(w, "values"))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># a spatial orthobasis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">orthobasis.neig</span><span class="op">(</span><span class="fu"><a href="neig.html">neig2nb</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">nb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="adegraphicsLoaded.html">adegraphicsLoaded</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.value.html">s.value</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span>, <span class="va">w</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, plegend.drawKey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">s1d.barchart</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span>, <span class="st">"values"</span><span class="op">)</span>, p1d.horizontal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="s.value.html">s.value</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">xy</span>, <span class="va">w</span><span class="op">[</span>, <span class="va">k</span><span class="op">]</span>, cleg <span class="op">=</span> <span class="fl">0</span>, sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>, csub <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">w</span>, <span class="st">"values"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a phylogenetic orthobasis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">njplot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="newick2phylog.html">newick2phylog</a></span><span class="op">(</span><span class="va">njplot</span><span class="op">$</span><span class="va">tre</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wA</span> <span class="op">&lt;-</span> <span class="va">phy</span><span class="op">$</span><span class="va">Ascores</span></span></span>
<span class="r-in"><span><span class="va">wW</span> <span class="op">&lt;-</span> <span class="va">phy</span><span class="op">$</span><span class="va">Wscores</span></span></span>
<span class="r-in"><span><span class="fu"><a href="table.phylog.html">table.phylog</a></span><span class="op">(</span>phylog <span class="op">=</span> <span class="va">phy</span>, <span class="va">wA</span>, clabel.row <span class="op">=</span> <span class="fl">0</span>, clabel.col  <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="table.phylog.html">table.phylog</a></span><span class="op">(</span>phylog <span class="op">=</span> <span class="va">phy</span>, <span class="va">wW</span>, clabel.row <span class="op">=</span> <span class="fl">0</span>, clabel.col  <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

