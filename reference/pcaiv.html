<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="performs a principal component analysis with respect to instrumental variables."><title>Principal component analysis with respect to instrumental variables — pcaiv • ade4</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Principal component analysis with respect to instrumental variables — pcaiv"><meta property="og:description" content="performs a principal component analysis with respect to instrumental variables."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ade4</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7-22</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-new-to-ade-">New to ade4?</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-new-to-ade-">
    <a class="dropdown-item" href="../articles/install.html">Installation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Getting started</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="external-link dropdown-item" href="https://cran.r-project.org/web/packages/adegraphics/vignettes/adegraphics.html">Graphical representation of multivariate data</a>
    <a class="dropdown-item" href="../articles/ChapEnvVarStruct.html">Environmental variables structures</a>
    <a class="dropdown-item" href="../articles/ChapSpeciesStruct.html">Species structures</a>
    <a class="dropdown-item" href="../articles/ChapBetGr.html">Taking into account groups of sites</a>
    <a class="dropdown-item" href="../articles/Chap2tables.html">Description of species-environment relationships</a>
    <a class="dropdown-item" href="../articles/ChapKtables.html">Analysing Changes in Structures</a>
    <a class="dropdown-item" href="../articles/Chap2Ktables.html">Analysing Changes in Co-structures</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/related.html">Related packages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-ressources">Ressources</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-ressources">
    <a class="external-link dropdown-item" href="https://lbbe-shiny.univ-lyon1.fr/ade4shiny/">ade4shiny</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <a class="external-link dropdown-item" href="https://listes.univ-lyon1.fr/sympa/info/adelist">adelist</a>
    <a class="dropdown-item" href="../articles/book.html">ade4 book</a>
    <a class="dropdown-item" href="../articles/papers.html">Papers</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://lbbe-web.univ-lyon1.fr/en">
    <span class="fa fa-leaf"></span>
     
    LBBE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adeverse/ade4">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Principal component analysis with respect to instrumental variables</h1>
      
      <div class="d-none name"><code>pcaiv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>performs a principal component analysis with respect to instrumental variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pcaiv</span><span class="op">(</span><span class="va">dudi</span>, <span class="va">df</span>, scannf <span class="op">=</span> <span class="cn">TRUE</span>, nf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># S3 method for pcaiv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, xax <span class="op">=</span> <span class="fl">1</span>, yax <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span> </span>
<span><span class="co"># S3 method for pcaiv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for pcaiv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dudi</dt>
<dd><p>a duality diagram, object of class <code>dudi</code></p></dd>

  <dt>df</dt>
<dd><p>a data frame with the same rows</p></dd>

  <dt>scannf</dt>
<dd><p>a logical value indicating whether the eigenvalues bar plot should be displayed</p></dd>

  <dt>nf</dt>
<dd><p>if scannf FALSE, an integer indicating the number of kept axes</p></dd>

  </dl><p><br></p>
<dl><dt>x, object</dt>
<dd><p>an object of class <code>pcaiv</code></p></dd>

  <dt>xax</dt>
<dd><p>the column number for the x-axis</p></dd>

  <dt>yax</dt>
<dd><p>the column number for the y-axis</p></dd>

  <dt>...</dt>
<dd><p>further arguments passed to or from other methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>returns an object of class <code>pcaiv</code>, sub-class of class <code>dudi</code></p>
<dl><dt>tab</dt>
<dd><p>a data frame with the modified array (projected variables)</p></dd>

  <dt>cw</dt>
<dd><p>a numeric vector with the column weigths (from <code>dudi</code>)</p></dd>

  <dt>lw</dt>
<dd><p>a numeric vector with the row weigths (from <code>dudi</code>)</p></dd>

  <dt>eig</dt>
<dd><p>a vector with the all eigenvalues</p></dd>

  <dt>rank</dt>
<dd><p>an integer indicating the rank of the studied matrix</p></dd>

  <dt>nf</dt>
<dd><p>an integer indicating the number of kept axes</p></dd>

  <dt>c1</dt>
<dd><p>a data frame with the Pseudo Principal Axes (PPA)</p></dd>

  <dt>li</dt>
<dd><p>a data frame <code>dudi$ls</code> with the predicted values by X</p></dd>

  <dt>co</dt>
<dd><p>a data frame with the inner products between the CPC and Y</p></dd>

  <dt>l1</dt>
<dd><p>data frame with the Constraint Principal Components (CPC)</p></dd>

  <dt>call</dt>
<dd><p>the matched call</p></dd>

  <dt>X</dt>
<dd><p>a data frame with the explanatory variables</p></dd>

  <dt>Y</dt>
<dd><p>a data frame with the dependant variables</p></dd>

  <dt>ls</dt>
<dd><p>a data frame with the projections of lines of <code>dudi$tab</code> on PPA</p></dd>

  <dt>param</dt>
<dd><p>a table containing information about contributions of the analyses : absolute (1) and cumulative (2) contributions of the decomposition of inertia of the dudi object, absolute (3) and cumulative (4) variances of the projections, the ration (5) between the cumulative variances of the projections (4) and the cumulative contributions (2), the square coefficient of correlation (6) and the eigenvalues of the pcaiv (7)</p></dd>

  <dt>as</dt>
<dd><p>a data frame with the Principal axes of <code>dudi$tab</code> on PPA</p></dd>

  <dt>fa</dt>
<dd><p>a data frame with the loadings (Constraint Principal Components as linear combinations of X</p></dd>

  <dt>cor</dt>
<dd><p>a data frame with the correlations between the CPC and X</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rao, C. R. (1964) The use and interpretation of principal component analysis in applied research. <em>Sankhya</em>, <b>A 26</b>, 329--359.<br><br>
Obadia, J. (1978) L'analyse en composantes explicatives. <em>Revue de Statistique Appliquee</em>, <b>24</b>, 5--28.<br><br>
Lebreton, J. D., Sabatier, R., Banco G. and  Bacou A. M. (1991) 
Principal component and correspondence analyses with respect to instrumental variables : 
an overview of their role in studies of structure-activity and species- environment relationships. 
In J. Devillers and W. Karcher, editors. <em>Applied Multivariate Analysis in SAR and Environmental Studies</em>, 
Kluwer Academic Publishers, 85--114.</p>
<p>Ter Braak, C. J. F. (1986) Canonical correspondence analysis : a new eigenvector technique for multivariate direct gradient analysis. <em>Ecology</em>, <b>67</b>, 1167--1179.<br><br>
Ter Braak, C. J. F. (1987) The analysis of vegetation-environment relationships by canonical correspondence analysis. <em>Vegetatio</em>, <b>69</b>, 69--77.<br><br>
Chessel, D., Lebreton J. D. and Yoccoz N. (1987) Propriétés de l'analyse canonique des correspondances. Une utilisation en hydrobiologie. <em>Revue de Statistique Appliquée</em>, <b>35</b>, 55--72.<br><br></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Daniel Chessel <br>
Anne-Béatrice Dufour <a href="mailto:anne-beatrice.dufour@univ-lyon1.fr">anne-beatrice.dufour@univ-lyon1.fr</a><br>
Stéphane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example for the pcaiv</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rhone</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pca1</span> <span class="op">&lt;-</span> <span class="fu"><a href="dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">rhone</span><span class="op">$</span><span class="va">tab</span>, scan <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iv1</span> <span class="op">&lt;-</span> <span class="fu">pcaiv</span><span class="op">(</span><span class="va">pca1</span>, <span class="va">rhone</span><span class="op">$</span><span class="va">disch</span>, scan <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">iv1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Principal component analysis with instrumental variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class: pcaiv dudi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: pcaiv(dudi = pca1, df = rhone$disch, scannf = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total inertia: 7.543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Ax1     Ax2     Ax3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.7031  3.5381  0.3015 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected inertia (%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Ax1     Ax2     Ax3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  49.095  46.907   3.998 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative projected inertia (%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Ax1   Ax1:2   Ax1:3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    49.1    96.0   100.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total unconstrained inertia (pca1): 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia of pca1 explained by rhone$disch (%): 50.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decomposition per axis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   iner inercum inerC inercumC ratio    R2 lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 6.27    6.27  5.52     5.52 0.879 0.671   3.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 4.14   10.42  4.74    10.25 0.984 0.747   3.54</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">iv1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in s.arrow(dfxy = na.omit(iv1$fa), xax = 1, yax = 2, plot = FALSE,     storeData = TRUE, pos = -3, psub = list(text = "X loadings"),     plabels = list(cex = 1.25)):</span> non convenient selection for dfxy (can not be converted to dataframe)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example for the caiv</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rpjdl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">millog</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rpjdl</span><span class="op">$</span><span class="va">mil</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="dudi.coa.html">dudi.coa</a></span><span class="op">(</span><span class="va">rpjdl</span><span class="op">$</span><span class="va">fau</span>, scann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">caiv1</span> <span class="op">&lt;-</span> <span class="fu">pcaiv</span><span class="op">(</span><span class="va">coa1</span>, <span class="va">millog</span>, scan <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="adegraphicsLoaded.html">adegraphicsLoaded</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># analysis with c1 - as - li -ls</span></span></span>
<span class="r-in"><span>  <span class="co"># projections of inertia axes on PCAIV axes</span></span></span>
<span class="r-in"><span>  <span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">as</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Species positions</span></span></span>
<span class="r-in"><span>  <span class="va">g31</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">c1</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, plab.cex <span class="op">=</span> <span class="fl">0.5</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Sites positions at the weighted mean of present species</span></span></span>
<span class="r-in"><span>  <span class="va">g32</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">ls</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, plab.cex <span class="op">=</span> <span class="fl">0</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">G3</span> <span class="op">&lt;-</span> <span class="fu">superpose</span><span class="op">(</span><span class="va">g31</span>, <span class="va">g32</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Prediction of the positions by regression on environmental variables</span></span></span>
<span class="r-in"><span>  <span class="va">G4</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.match.html">s.match</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">ls</span>, <span class="va">caiv1</span><span class="op">$</span><span class="va">li</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, plab.cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># analysis with fa - l1 - co -cor</span></span></span>
<span class="r-in"><span>  <span class="co"># canonical weights giving unit variance combinations</span></span></span>
<span class="r-in"><span>  <span class="va">G5</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">fa</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># sites position by environmental variables combinations</span></span></span>
<span class="r-in"><span>  <span class="co"># position of species by averaging</span></span></span>
<span class="r-in"><span>  <span class="va">g61</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">l1</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, plab.cex <span class="op">=</span> <span class="fl">0</span>, ppoi.cex <span class="op">=</span> <span class="fl">1.5</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">g62</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">co</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">G6</span> <span class="op">&lt;-</span> <span class="fu">superpose</span><span class="op">(</span><span class="va">g61</span>, <span class="va">g62</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">G7</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.distri.html">s.distri</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">l1</span>, <span class="va">rpjdl</span><span class="op">$</span><span class="va">fau</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, ellipseSize <span class="op">=</span> <span class="fl">0</span>, starSize <span class="op">=</span> <span class="fl">0.33</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># coherence between weights and correlations</span></span></span>
<span class="r-in"><span>  <span class="va">g81</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">cor</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">g82</span> <span class="op">&lt;-</span> <span class="fu"><a href="s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">fa</span>, xax <span class="op">=</span> <span class="fl">2</span>, yax <span class="op">=</span> <span class="fl">1</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">G8</span> <span class="op">&lt;-</span> <span class="fu">cbindADEg</span><span class="op">(</span><span class="va">g81</span>, <span class="va">g82</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># analysis with c1 - as - li -ls</span></span></span>
<span class="r-in"><span>  <span class="co"># projections of inertia axes on PCAIV axes</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">as</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Species positions</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">c1</span>, <span class="fl">2</span>, <span class="fl">1</span>, clab <span class="op">=</span> <span class="fl">0.5</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Sites positions at the weighted mean of present species</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">ls</span>, <span class="fl">2</span>, <span class="fl">1</span>, clab <span class="op">=</span> <span class="fl">0</span>, cpoi <span class="op">=</span> <span class="fl">1</span>, add.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Prediction of the positions by regression on environmental variables</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.match.html">s.match</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">ls</span>, <span class="va">caiv1</span><span class="op">$</span><span class="va">li</span>, <span class="fl">2</span>, <span class="fl">1</span>, clab <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># analysis with fa - l1 - co -cor</span></span></span>
<span class="r-in"><span>  <span class="co"># canonical weights giving unit variance combinations</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">fa</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># sites position by environmental variables combinations</span></span></span>
<span class="r-in"><span>  <span class="co"># position of species by averaging</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">l1</span>, <span class="fl">2</span>, <span class="fl">1</span>, clab <span class="op">=</span> <span class="fl">0</span>, cpoi <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">co</span>, <span class="fl">2</span>, <span class="fl">1</span>, add.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.distri.html">s.distri</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">l1</span>, <span class="va">rpjdl</span><span class="op">$</span><span class="va">fau</span>, <span class="fl">2</span>, <span class="fl">1</span>, cell <span class="op">=</span> <span class="fl">0</span>, csta <span class="op">=</span> <span class="fl">0.33</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.label.html">s.label</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">co</span>, <span class="fl">2</span>, <span class="fl">1</span>, clab <span class="op">=</span> <span class="fl">0.75</span>, add.plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># coherence between weights and correlations</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">cor</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="s.arrow.html">s.arrow</a></span><span class="op">(</span><span class="va">caiv1</span><span class="op">$</span><span class="va">fa</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in s.arrow(dfxy = na.omit(caiv1$fa), xax = 1, yax = 2, plot = FALSE,     storeData = TRUE, pos = -3, psub = list(text = "X loadings"),     plabels = list(cex = 1.25)):</span> non convenient selection for dfxy (can not be converted to dataframe)</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stéphane Dray, Anne-Béatrice Dufour, Jean Thioulouse, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

